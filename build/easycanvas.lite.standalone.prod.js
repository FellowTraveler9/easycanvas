!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(16)},function(t,e){"use strict";t.exports={funcOrValue:function(t,e){if("function"==typeof t){var n=t.call(e);return n&&void 0!==n.$$value?n.$$value:n}return t},execFuncs:function(t,e,n){"function"==typeof t?t.apply(e,n):Array.prototype.isPrototypeOf(t)&&t.forEach(function(t){t&&t.apply(e)})},getMinFromArray:function(t){var e=t[0];return t.forEach(function(t){e>t&&(e=t)}),e},getCharFromKey:function(t){return t.key||String.fromCharCode(t.keyCode)},noop:function(){},firstValuable:function(t,e){return void 0===t?e:t},assign:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}}},function(t,e){"use strict";t.exports={xywh:["sx","sy","sw","sh","tx","ty","tw","th"],txywh:["tx","ty","tw","th"],sxywh:["sx","sy","sw","sh"],devFlag:"__EASYCANVAS_DEVTOOL__"}},function(t,e){"use strict";var n=function(t,e,n,r,o){var a=o||1;return a>t-n?t-n>-a?a>e-r?e-r>-a?5:8:2:a>e-r?e-r>-a?4:7:1:a>e-r?e-r>-a?6:9:3},r={1:{x:-1,y:1},2:{x:0,y:1},3:{x:1,y:1},4:{x:-1,y:0},5:{x:0,y:0},6:{x:1,y:0},7:{x:-1,y:-1},8:{x:0,y:-1},9:{x:1,y:-1}};t.exports={num:n,xy:function(){var t=n.apply(this,arguments);return JSON.parse(JSON.stringify(r[t]||{}))},NUM2XAY:function(t){return JSON.parse(JSON.stringify(r[t]))},pointInRect:function(t,e,n,r,o,a){return!(n>t||t>r||o>e||e>a)},getDistanceSq:function(t,e,n,r){return(t-n)*(t-n)+(e-r)*(e-r)},enoughNear:function(t,e,n,r,o){return o*o>=(t-n)*(t-n)+(e-r)*(e-r)}}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1),a=(r(o),n(3)),s=(r(a),!1),i=function(t,e){t.drag.draggingFlag=e,s=e},l=function(t,e,n,r){return t?t.call(e,n):!!r&&"drag"};t.exports={bind:function(t){var e={x:0,y:0};t.drag.draggingFlag=!1;var n=t.events.mousedown||t.events.touchstart;t.events.touchstart=t.events.mousedown=function(r){if(t.drag.dragable){i(t,!0);e.x=r.canvasX,e.y=r.canvasY}return l(n,t,r,t.drag.dragable)}.bind(t);var r=t.events.hold||t.events.mousemove;t.events.touchmove=t.events.mousemove=function(n){var o=t.drag.draggingFlag&&t.drag.dragable;return o&&(this.style.tx+=n.canvasX-e.x,this.style.ty+=n.canvasY-e.y,e.x=n.canvasX,e.y=n.canvasY),l(r,t,n,o)}.bind(t);var o=t.events.mouseup||t.events.touchend;t.events.touchend=t.events.mouseup=function(e){var n=t.drag.draggingFlag&&t.drag.dragable;return t.drag.draggingFlag&&t.drag.dragable&&i(t,!1),l(o,t,e,n)};var a=t.events.mouseout;t.events.mouseout=function(e){var n=t.drag.draggingFlag&&t.drag.dragable;return i(t,!1),l(a,t,e,n)};var s=t.events.click;t.events.click=function(e){var n=t.drag.dragable;if(n){return!s||s.call(t,e)}return l(s,t,e,n)}}}},function(t,e){"use strict";var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};t.exports=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1),a=r(o),s=n(2),i=r(s),l=n(10),c=r(l),u=n(9),f=r(u),h=n(11),d=r(h),p=n(8),v=r(p),g=n(4),y=r(g),x=function(t){t.$id||(t.$id=Math.random().toString(36).substr(2)),t.content=t.content||{},t.style=t.style||{},t.style.zIndex=t.style.zIndex||0,t.style.mirrX=t.style.mirrX||0,t.style.opacity=void 0===t.style.opacity?1:t.style.opacity,t.style.locate=t.style.locate||"center",t.style.scale=t.style.scale||1;var e=a.default.funcOrValue(t.content.img);if(void 0===e&&(e={width:0,height:0}),i.default.xywh.forEach(function(e){t.style[e]=t.style[e]||0}),t.inherit=t.inherit||["tx","ty","scale"],t.drag=t.drag||{},t.events=t.events||{},t.events.eIndex=t.events.eIndex||0,t.events.through=!!t.events.through,t.scroll=t.scroll||{},t.scroll.scrollX=t.scroll.scrollX||0,t.scroll.scrollY=t.scroll.scrollY||0,t.hooks=t.hooks||{},t.name=t.name,!t.name&&t.content.img&&t.content.img.src){var n=t.content.img.src.match(/.*\/([^\/]*)$/);n&&n[1]&&(t.name=n[1])}return t.name=t.name||"Unnamed Easycanvas Object",t.children=t.children||[],t.children.forEach(function(e){e.$canvas=t.$canvas,e.$parent=t,e=new m(e)}),t.$cache={},t.$scroll={speedX:0,speedY:0},t},m=function(t){var e=x(t);for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this[n]=e[n]);return this};m.prototype.add=function(t){return this.children=this.children||[],t.$canvas=this.$canvas,t.$parent=this,t.$id||(t=new m(t)),y.default.bind(t),t.children.forEach(function(e,n){t.children[n]=new m(e),t.children[n].$canvas=t.$canvas,t.children[n].$parent=t}),this.children.push(t),t},m.prototype.remove=function(t){return t?(this.$canvas.remove(t),void a.default.execFuncs(t.hooks.removed,t)):(this.$parent?this.$parent.remove(this):this.$canvas.remove(this),void a.default.execFuncs(this.hooks.removed,this))},m.prototype.on=c.default,m.prototype.off=f.default,m.prototype.trigger=d.default,m.prototype.broadcast=v.default,t.exports=m},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1),a=r(o),s=n(5),i=r(s),l={},c=!1,u=[],f={stop:function(){c=!1},tick:function(){(0,i.default)(f.looper)},looper:function(){u.forEach(function(t,e){if(Math.abs(t.$scroll.speedX)>1?t.$scroll.speedX*=t.scroll.smooth||.8:t.$scroll.speedX=0,Math.abs(t.$scroll.speedY)>1?t.$scroll.speedY*=t.scroll.smooth||.8:t.$scroll.speedY=0,Math.abs(t.$scroll.speedX)<=1&&Math.abs(t.$scroll.speedY)<=1)return void u.splice(e,1);t.scroll.scrollY-=t.$scroll.speedY,t.scroll.scrollX-=t.$scroll.speedX;var n=a.default.funcOrValue(t.scroll.minScrollX,t),r=a.default.funcOrValue(t.scroll.maxScrollX,t),o=a.default.funcOrValue(t.scroll.minScrollY,t),s=a.default.funcOrValue(t.scroll.maxScrollY,t);!isNaN(o)&&o>t.scroll.scrollY?t.scroll.scrollY=o:!isNaN(s)&&t.scroll.scrollY>s&&(t.scroll.scrollY=s),!isNaN(n)&&n>t.scroll.scrollX?t.scroll.scrollX=n:!isNaN(r)&&t.scroll.scrollX>r&&(t.scroll.scrollX=r)}),f.tick()},touch:function(t,e){if(!t.scroll.scrollable)return!1;if(c){u.indexOf(t)===-1&&u.push(t);var n=Math.abs(e.canvasX-l.x),r=Math.abs(e.canvasY-l.y),o=+new Date-c;return c=+new Date,o/=10,n/o>1&&o>1&&(t.$scroll.speedX+=(e.canvasX-l.x)/o),r/o>1&&o>1&&(t.$scroll.speedY+=(e.canvasY-l.y)/o),l.x=e.canvasX,l.y=e.canvasY,!0}c=+new Date,l.x=e.canvasX,l.y=e.canvasY},wheel:function(t,e){u.indexOf(t)===-1&&u.push(t),t.$scroll.speedX=e.wheelDeltaX,t.$scroll.speedY=e.wheelDeltaY}};t.exports=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1);r(o);t.exports=function(){var t=Array.prototype.slice.call(arguments),e=t.shift();this.hooks[e]&&this.hooks[e].apply(this,t),t.unshift(e),this.children&&this.children.forEach(function(e){e.broadcast.apply(e,t)}),this.paintList&&this.paintList.forEach(function(e){e.broadcast.apply(e,t)})}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1);r(o);t.exports=function(t,e){this.hooks[t]&&(this.hooks[t]!==e&&e?Array.prototype.isPrototypeOf(this.hooks[t])&&(this.hooks[t][this.hooks[t].indexOf(e)]=void 0):delete this.hooks[t])}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1);r(o);t.exports=function(t,e){this.hooks[t]?Array.prototype.isPrototypeOf(this.hooks[t])?this.hooks[t].push(e):this.hooks[t]=[this.hooks[t],e]:this.hooks[t]=e}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1);r(o);t.exports=function(){var t=Array.prototype.slice.call(arguments),e=t.shift();this.hooks[e]&&this.hooks[e].apply(this,t)}},function(t,e){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r={},o=[],a="processing",s=0,i=function t(e,i,l){var c=l||{};if("object"===(void 0===e?"undefined":n(e))){var u=e;return c.callbackArgs=c.callbackArgs||[],void t(u.shift(),function(e){c.callbackArgs.push(e),u.length>1?t(u,i,c):t(u[0],function(t){c.callbackArgs.push(t),i(c.callbackArgs)},c)},l)}var f=e;if(c.alphaColor&&(f+=alphaColor),r[f]&&r[f]!==a)return setTimeout(function(){i&&i(r[f])}),r[f];var h=new Image;return c.block?(h.src=e,s++):0===s?h.src=e:o.push({imgObj:h,src:e}),r[f]=a,h.onload=function(){if(c.block&&(s--,0===s&&(o.forEach(function(t){t.imgObj.src=t.src}),o.splice(0))),c.cache){var t=document.createElement("canvas"),e=t.getContext("2d");if(t.width=h.width,t.height=h.height,e.drawImage(h,0,0),c.alphaColor){for(var n=e.getImageData(0,0,h.width,h.height),a=0;n.data.length>a;a+=4){var l=n.data[a]+n.data[a+1]+n.data[a+2],u=1;u>n.data[a]&&u>n.data[a+1]&&u>n.data[a+2]&&(n.data[a+3]=parseInt(l/255))}e.putImageData(n,0,0)}h=t}r[f]=h,i&&i(h)},h.onerror=function(){r[f]=h},h};t.exports=i},function(t,e){"use strict";t.exports=function(t){var e=t.width,n=t.height,r=document.createElement("canvas");r.width=e,r.height=n;var o=r.getContext("2d");o.scale(1,-1),o.translate(0,-n),o.drawImage(t,0,0);var a=o.getImageData(0,0,e,n);return{canvas:o,img:a}}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=(Object.assign||function(t){for(var e=1;arguments.length>e;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},n(2));r(o)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(6),a=r(o);t.exports={sprite:a.default}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(37),a=r(o),s=n(5),i=r(s),l=n(13),c=r(l),u=n(1),f=r(u),h=n(41),d=r(h),p=n(12),v=r(p),g=n(3),y=r(g),x=n(40),m=r(x),$=n(39),w=r($),b=n(15),T=r(b),k=n(14),O=(r(k),{painter:a.default,imgLoader:v.default,sequenceDiagram:m.default,multlineText:w.default,posCompare:y.default,transition:d.default,tick:i.default,utils:f.default,mirror:c.default,class:T.default,$version:"0.2.0"});window.Easycanvas=O,t.exports=O},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(21),a=r(o),s=n(19),i=r(s),l=n(23),c=r(l),u=n(18),f=r(u),h=n(4),d=r(h),p=n(22),v=r(p),g=n(36),y=(r(g),n(1)),x=(r(y),{$paint:i.default,$eventHandler:f.default,$write:c.default,$perPaint:a.default,$bindDrag:d.default,$rAFer:v.default});t.exports=x},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1),a=r(o),s=n(2),i=(r(s),n(3)),l=r(i),c=n(7),u=r(c),f=function(t){return t.sort(function(t,e){return a.default.funcOrValue(t.events.eIndex,t)<a.default.funcOrValue(e.events.eIndex,e)?1:-1})},h=function(t,e){if(a.default.funcOrValue(t.style.visible,t)===!1)return!1;if(t.$cache){var n=t.$cache.tx,r=t.$cache.ty,o=t.$cache.tw,s=t.$cache.th;return void 0!==n&&l.default.pointInRect(e.canvasX,e.canvasY,n,n+o,r,r+s)}},d=function t(e,n,r){if(e&&e.length)for(var o=0;e.length>o;o++){var s=e[o];s.children.length&&t(f(s.children.filter(function(t){return a.default.funcOrValue(t.events.eIndex,t)>=0})),n,r),h(s,n)&&r.push(s),s.children.length&&t(f(s.children.filter(function(t){return a.default.funcOrValue(t.events.eIndex,t)<0})),n,r)}};t.exports=function(t){!t.layerX&&t.touches&&t.touches[0]&&(t.layerX=t.targetTouches[0].pageX-t.currentTarget.offsetLeft,t.layerY=t.targetTouches[0].pageY-t.currentTarget.offsetTop),!t.layerX&&t.changedTouches&&t.changedTouches[0]&&(t.layerX=t.changedTouches[0].pageX-t.currentTarget.offsetLeft,t.layerY=t.changedTouches[0].pageY-t.currentTarget.offsetTop);var e=parseInt(this.$dom.style.width)/this.contextWidth,n=parseInt(this.$dom.style.height)/this.contextHeight;e=e||1,n=n||1;var r={type:t.type,canvasX:t.layerX/e,canvasY:t.layerY/n,event:t},o=this,a=[];d(f(o.paintList),r,a);o.eHoldingFlag||"mousedown"!==t.type&&"touchstart"!==t.type?!o.eHoldingFlag||"mouseup"!==t.type&&"touchend"!==t.type?!o.eHoldingFlag||"mousemove"!==t.type&&"touchmove"!==t.type||(o.eHoldingFlag=t):(o.eHoldingFlag=!1,u.default.stop()):o.eHoldingFlag=t;for(var s=0;a.length>s;s++){if(("mousemove"===t.type||"touchmove"===t.type)&&o.eLastMouseHover&&o.eLastMouseHover!==a[s]&&a.indexOf(o.eLastMouseHover)===-1){var i=o.eLastMouseHover.events.mouseout||o.eLastMouseHover.events.touchout;i&&i.call(o.eLastMouseHover,r)}if("mousewheel"===r.type)u.default.wheel(a[s],t);else if(o.eHoldingFlag&&"touchmove"===t.type&&u.default.touch(a[s],r))return;if(a[s].events){var l=a[s].events[t.type];if(l){o.eLastMouseHover=a[s];var c=l.call(a[s],r);if(c===!0)return o.eHoldingFlag=!1,c;if("drag"===c)return o.eHoldingFlag=!1,c}if(a[s].through===!1)return}}if(!a.length&&o.eLastMouseHover){var h=o.eLastMouseHover.events.mouseout;h&&h.call(o.eLastMouseHover,r),o.eLastMouseHover=null}var p=o.events[t.type];if(p&&p(r))return o.eHoldingFlag=!1,!0}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1),a=(r(o),n(3)),s=r(a),i=function(t,e){var n=this,r=!1,o=t.props,a=t.settings;if("img"===t.type&&(200>n.$paintList.length||o[7]*o[8]>4e4))for(var i=e+1,l=n.$paintList.length;l>i;i++){var c=n.$paintList[i];if("img"===c.type&&"*"===c.imgType&&1===c.settings.globalAlpha&&!c.settings.rotate){var u=c.props;if(s.default.pointInRect(o[5],o[6],u[5],u[5]+u[7],u[6],u[6]+u[8])&&s.default.pointInRect(o[5]+o[7],o[6]+o[8],u[5],u[5]+u[7],u[6],u[6]+u[8]))return void(r=!0)}}var f=!1;1===a.globalAlpha||isNaN(a.globalAlpha)||(f||(n.$paintContext.save(),f=!0),n.$paintContext.globalAlpha=a.globalAlpha),a.translate&&(f||(n.$paintContext.save(),f=!0),n.$paintContext.translate(a.translate[0]||0,a.translate[1]||0)),a.rotate&&(f||(n.$paintContext.save(),f=!0),n.$paintContext.translate(a.translateBeforeRotate[0]||0,a.translateBeforeRotate[1]||0),n.$paintContext.rotate(a.rotate||0),n.$paintContext.translate(a.translateAfterRotate[0]||0,a.translateAfterRotate[1]||0)),a.scale&&(f||(n.$paintContext.save(),f=!0),n.$paintContext.scale(a.scale[0]||1,a.scale[1]||1)),a.transform&&(f||(n.$paintContext.save(),f=!0),n.$paintContext.transform(1,a.transform.fh,a.transform.fv,1,a.transform.fx,a.transform.fy)),"img"===t.type?n.$paintContext.drawImage(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8]):"text"===t.type&&o.content&&n.$write.call(n,o),f&&n.$paintContext.restore()};t.exports=function(){var t=this;t.$paintList.forEach(i.bind(t))}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1),a=r(o),s=n(2);r(s);t.exports=function(t,e){var n={};for(var r in t.content)n[r]=a.default.funcOrValue(t.content[r],t);for(var o in t.style)n[o]=a.default.funcOrValue(t.style[o],t);if(n.img=t.content.img,n.img&&"sequence-diagram"===n.img.type){var s=n.img.config,i=n.img.index,l=void 0,c=void 0;l=0>s.w?n.img.img.width/(0-s.w):s.w>0?s.w:n.img.img.width,c=0>s.h?n.img.img.height/(0-s.h):s.h>0?s.h:n.img.img.height;var u=parseInt(n.img.img.width/l),f=parseInt(n.img.img.height/c);s.h&&(n.sx=i%u*l,n.sy=parseInt(i/u)%f*c),!s.loop&&i>0&&0===n.sx&&0===n.sy&&(n.img.img={}),n.img.lastTickTime=n.img.lastTickTime||0,e.$nextTickTime-n.img.lastTickTime<a.default.funcOrValue(s.interval,t)||(s.lastTickTime=e.$nextTickTime,n.img.index++,n.img.lastTickTime=e.$nextTickTime),n.sw=l||n.sw,n.sh=c||n.sh,n.tw=n.tw||l,n.th=n.th||c,n.img=n.img.img}return t.$tmp=n,n}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1),a=r(o),s=n(38),i=(r(s),n(2)),l=r(i),c=n(20),u=r(c);t.exports=function(t,e){if(a.default.funcOrValue(t.style.visible,t)===!1)return void a.default.execFuncs(t.hooks.ticked,t);var n=this,r={},o=(0,u.default)(t,n),s=o.text,i=o.img;t.$parent&&(t.inherit.forEach(function(e){l.default.xywh.indexOf(e)<0&&["rotate"].indexOf(e)<0?["opacity","scale"].indexOf(e)<0||(o[e]=a.default.firstValuable(o[e],1),isNaN(t.$parent.$cache[e])||(o[e]*=t.$parent.$cache[e])):(o[e]=o[e]||0,o[e]+=a.default.funcOrValue(t.$parent.style[e]||0,t.$parent)||0)}),o.ty-=t.$parent.scroll.scrollY,o.tx-=t.$parent.scroll.scrollX);var c=a.default.funcOrValue(t.children,t),f=i?i.$width||i.width||0:0,h=i?i.$height||i.height||0:0;if(i&&!i.$width&&(i.$width=f,i.$height=h),o.tw=o.tw||o.sw||f,o.th=o.th||o.sh||h,o.sw=o.sw||f,o.sh=o.sh||h,"center"===o.locate?(o.tx=o.tx-.5*o.tw,o.ty=o.ty-.5*o.th):"rd"===o.locate&&(o.tx=o.tx-1*o.tw,o.ty=o.ty-1*o.th),(o.fh||o.fv)&&(r.transform={fh:o.fh,fv:o.fv,fx:(o.ty+o.th/2)*o.fv*-1+o.fx,fy:(o.tx+o.tw/2)*o.fh*-1+o.fy}),o.rotate){var d=void 0!==o.rx?o.rx:o.tx+.5*o.tw,p=void 0!==o.ry?o.ry:o.ty+.5*o.th;r.translateBeforeRotate=[d,p],r.rotate=-o.rotate*Math.PI/180,r.rotate=+r.rotate.toFixed(4),r.translateAfterRotate=[-d,-p]}if(1!==o.scale&&(o.tx-=.5*(o.scale-1)*o.tw,o.ty-=.5*(o.scale-1)*o.th,o.tw*=o.scale,o.th*=o.scale),o.mirrX?(r.translate=[n.contextWidth,0],r.scale=[-1,1],o.tx=n.contextWidth-o.tx-o.tw,o.mirrY&&(r.translate=[n.contextWidth,n.contextHeight],r.scale=[-1,-1],o.ty=n.contextHeight-o.ty-o.th)):o.mirrY&&(r.translate=[0,n.contextHeight],r.scale=[1,-1],o.ty=n.contextHeight-o.ty-o.th),!o.rotate&&!s){if(0>o.sx&&o.sw){var v=-o.sx/o.sw;o.tx+=o.tw*v,o.sx=0}if(0>o.sy&&o.sh){var g=-o.sy/o.sh;o.ty+=o.th*g,o.sy=0}if(f&&o.sx+o.sw>f){var y=(o.sx+o.sw-f)/o.sw;o.sw-=o.sw*y,o.tw-=o.tw*y}if(h&&o.sy+o.sh>h){var x=(o.sy+o.sh-h)/o.sh;o.sh-=o.sh*x,o.th-=o.th*x}if(0>o.tx&&o.tw){var m=-o.tx/o.tw;o.sx+=o.sw*m,o.sw-=o.sw*m,o.tw=o.tw+o.tx,o.tx=0}if(0>o.ty&&o.th){var $=-o.ty/o.th;o.sy+=o.sh*$,o.sh-=o.sh*$,o.th=o.th+o.ty,o.ty=0}if(o.tx+o.tw>n.contextWidth&&o.tw){var w=(o.tx+o.tw-n.contextWidth)/o.tw;o.tw-=o.tw*w,o.sw-=o.sw*w}if(o.ty+o.th>n.contextHeight&&o.th){var b=(o.ty+o.th-n.contextHeight)/o.th;o.th-=o.th*b,o.sh-=o.sh*b}}l.default.xywh.forEach(void 0!==t.$cache.tx?function(e){Math.abs(t.$cache[e]-o[e])>1&&(o[e]=parseInt(o[e]))}:function(t){o[t]=parseInt(o[t])});for(var T in o)t.$cache[T]=o[T];if(delete t.$cache.textBottom,i&&void 0===t.$cache.imgType&&(t.$cache.imgType=i.src?"png"===i.src.substr(-3)?"png":"*":"canvas"),c&&c.filter(function(t){return 0>t.style.zIndex}).sort(function(t,e){return t.style.zIndex===e.style.zIndex?0:t.style.zIndex>e.style.zIndex?1:-1}).forEach(function(t,e){n.$perPaint.call(n,t,e)}),r.globalAlpha=void 0!==o.opacity?o.opacity:1,i&&f&&0!==o.opacity&&o.sw&&o.sh&&n.contextWidth>o.tx&&n.contextHeight>o.ty&&n.$paintList.push({$id:t.$id,type:"img",settings:r,imgType:t.$cache.imgType,props:[i,o.sx,o.sy,o.sw,o.sh,o.tx,o.ty,o.tw,o.th]}),s){var k=o.tx,O=o.ty,_=t.style.align,F=a.default.funcOrValue(t.style.font,t)||"14px Arial",M=parseInt(F),H=t.style.lineHeight||M;if("center"===_?k+=o.tw/2:"right"===_&&(k+=o.tw),O+="top"===t.style.textVerticalAlign?M+(H-M)/2:"bottom"===t.style.textVerticalAlign?o.th-(H-M)/2:o.th/2+M/2,"string"==typeof s)n.$paintList.push({$id:t.$id,type:"text",settings:r,props:{tx:k,ty:O,content:s,align:_||"left",font:F,color:t.style.color||"white",type:t.style.textType||"fillText"}});else if("multline-text"===s.type){var X=s.text.split(/\t|\n/),Y=function(t){var e=/[^\u4e00-\u9fa5]/;return!e.test(t)},I=[];X.forEach(function(t,e){t=String.prototype.trim.apply(t),s.config.start&&(t=t.replace(s.config.start,""));for(var n=0,r=o.tw;t.length&&t.length>n;)r>0||(r=o.tw,I.push(t.substr(0,n)),t=t.substr(n),n=0),n++,r-=M*(Y(t[n])?1.05:.6);(t||e)&&I.push(t)}),I.forEach(function(e){n.$paintList.push({$id:t.$id,type:"text",settings:r,props:{tx:k,ty:O,content:e,align:_||"left",font:F,color:t.style.color||"white",type:t.style.textType||"fillText"}}),O+=H||M}),t.$cache.textBottom=O}}c&&c.filter(function(t){return!(0>t.style.zIndex)}).sort(function(t,e){return t.style.zIndex===e.style.zIndex?0:t.style.zIndex>e.style.zIndex?1:-1}).forEach(function(t,e){n.$perPaint.call(n,t,e)}),a.default.execFuncs(t.hooks.ticked,t)}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(5),a=r(o);t.exports=function(t){var e=(new Date).getTime();this.$nextTickTime=e,1e3>e-this.fpsCalculateTime||(this.fpsCalculateTime=e,this.fpsHandler&&this.fpsHandler.call(this,this.fps),this.lastFps=this.fps,this.fps=0),(0,a.default)(function(n){if(this.$rafTime=n,this.$rAFer(t),this.maxFps>0&&60>this.maxFps){if(1e3/this.maxFps>=e-this.$lastPaintTime)return;this.$lastPaintTime=e-(e-this.$lastPaintTime)%(1e3/this.maxFps)}t()}.bind(this))}},function(t,e){"use strict";t.exports=function(t){this.$paintContext.font=t.font,this.$paintContext.strokeStyle=t.color,this.$paintContext.fillStyle=t.color,this.$paintContext.textAlign=t.align,this.$paintContext[t.type||"fillText"](t.content,parseInt(t.tx),parseInt(t.ty))}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(25),a=r(o),s=n(32),i=r(s),l=n(35),c=r(l),u=n(28),f=r(u),h=n(26),d=r(h),p=n(29),v=r(p),g=n(10),y=r(g),x=n(9),m=r(x),$=n(11),w=r($),b=n(8),T=r(b),k=n(27),O=r(k),_=n(30),F=r(_),M=n(33),H=r(M),X=n(34),Y=r(X),I={start:c.default,paint:f.default,add:a.default,remove:i.default,register:F.default,clear:d.default,setFpsHandler:H.default,setMaxFps:Y.default,pause:v.default,on:y.default,off:m.default,trigger:w.default,broadcast:T.default,nextTick:O.default};t.exports=I},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1),a=(r(o),n(6)),s=r(a),i=n(4),l=r(i),c=function(t){if(t){var e=this,n=t;return n.$canvas=e,n.$id||(n=new s.default(n)),l.default.bind(n),n.children.forEach(function(t,r){n.children[r]=new s.default(t),n.children[r].$canvas=e,n.children[r].$parent=n}),e.paintList.push(n),n}};t.exports=c},function(t,e){"use strict";t.exports=function(){this.paintList=[]}},function(t,e){"use strict";t.exports=function(t){var e=function e(){t.apply(this,arguments),this.off("nextTick",e)};this.on("nextTick",e.bind(this))}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1),a=r(o);t.exports=function(){if(!this.$pausing&&!document.hidden){var t=this;a.default.execFuncs(t.hooks.ticked,t,[t.$rafTime]),t.$paintContext.clearRect(0,0,this.contextWidth,this.contextHeight),t.$freezing||(t.$paintList=[],this.paintList.sort(function(t,e){var n=a.default.funcOrValue(t.style.zIndex,t),r=a.default.funcOrValue(e.style.zIndex,e);return n===r?0:n>r?1:-1}).forEach(function(e,n){t.$perPaint(e,n)})),t.$paint(),this.fps++,t.hooks.nextTick&&(a.default.execFuncs(t.hooks.nextTick,t,[t.$rafTime]),delete t.hooks.nextTick)}}},function(t,e){"use strict";t.exports=function(t){this.$pausing=void 0===t||t}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(31),a=r(o),s=n(7),i=r(s);t.exports=function(t,e){var n=this;for(var r in a.default)this[r]=a.default[r];var o=e||{};this.$dom=t,this.$paintContext=t.getContext("2d"),this.width=this.contextWidth=o.width||t.width,this.height=this.contextHeight=o.height||t.height,this.events=o.events||{},this.hooks=o.hooks||{};var s=["contextmenu","mousewheel","click","dblclick","mousedown","mouseup","mousemove","touchstart","touchend","touchmove"];s.forEach(function(e){t.addEventListener(e,n.$eventHandler.bind(n))}),i.default.tick(),setInterval(function(){if(n.eHoldingFlag){var t=n.eHoldingFlag;n.$eventHandler.call(n,{layerX:t.layerX,layerY:t.layerY,screenX:t.screenX||t.layerX,screenY:t.screenY||t.layerY,type:"hold"})}},40)}},function(t,e,n){"use strict";var r={$dom:null,$paintContext:null,$nextTickTime:0,$lastPaintTime:0,$pausing:!1,$freezing:!1,fps:0,lastFps:0,fpsCalculateTime:0,fpsHandler:null,contextWidth:0,contextHeight:0,events:{click:null},paintList:[],eHoldingFlag:!1,eLastMouseHover:null,maxFps:-1,scroll:{scrollable:!1,scrollY:0,minScrollY:void 0,maxScrollY:void 0},$flags:{dragging:!1}};t.exports=r},function(t,e,n){"use strict";t.exports=function(t,e){t.style.visible=!1,t.removing=!0,setTimeout(function(){t.$parent?t.$parent.children=t.$parent.children.filter(function(t){return t.removing!==!0}):this.paintList=this.paintList.filter(function(t){return t.removing!==!0})}.bind(this)),e&&this.paintList.splice(this.paintList.indexOf(t),1)}},function(t,e){"use strict";t.exports=function(t){this.fpsHandler=t}},function(t,e){"use strict";t.exports=function(t){this.maxFps=t||-1}},function(t,e){"use strict";t.exports=function(){this.fpsCalculateTime=(new Date).getTime(),this.$rAFer(this.paint.bind(this))}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1),a=r(o),s=n(2),i=r(s);t.exports=function(){var t,e,n,r}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(24),a=r(o),s=n(17),i=r(s),l=function(){};for(var c in i.default)Object.prototype.hasOwnProperty.call(i.default,c)&&(l.prototype[c]=i.default[c]);for(var u in a.default)Object.prototype.hasOwnProperty.call(a.default,u)&&(l.prototype[u]=a.default[u]);t.exports=l},function(t,e){"use strict";function n(t,e){if(t&&t.match(/^data:/))return void(e&&e(t));if(o[t])return void(o[t]!==r?e(o[t]):setTimeout(function(){n(t,e)},100));o[t]=r;var a=new XMLHttpRequest;a.onload=function(){var n=new FileReader;n.onloadend=function(){o[t]=n.result,e&&e(n.result)},n.readAsDataURL(a.response)},a.open("GET",t),a.responseType="blob",a.send()}var r="processing",o={};t.exports=n},function(t,e){"use strict";t.exports=function(t,e){return{type:"multline-text",text:t,config:e}}},function(t,e){"use strict";t.exports=function(t,e){return{type:"sequence-diagram",index:0,img:t,config:e}}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=n(1),s=r(a),i=[],l=3.141593,c=function(t){return t/1e3*60},u={linear:function(t,e,n){var r=i.length;i.push(t);var o=!1,a=function(){var a=i[r];return a>=t&&e>a||a>e&&t>=a?(i[r]+=(e-t)/c(n),{$$value:a,$$over:!1}):(o&&(i[r]=t),{$$value:e,$$over:!0,$$loop:function(){i[r]=t}})};return a.loop=function(){return o=!0,a},a},pendulum:function(t,e,n,r){var o=r||{};o.start=s.default.firstValuable(o.start,-l),o.end=s.default.firstValuable(o.end,l),o.cycle=s.default.firstValuable(o.cycle,2*l);var a=i.length;i.push(o.start);var u=!1,f=!1,h=function(){var r=Math.cos(i[a])+1;return i[a]+=l/c(n),i[a]>o.end&&(u?i[a]-=o.cycle:i[a]=o.end),{$$value:s.default.funcOrValue(t)+(s.default.funcOrValue(e)-s.default.funcOrValue(t))*r/2,$$over:!f&&i[a]>=o.end,$$loop:function(){i[a]=-l}}};return h.loop=function(){return u=!0,h},h.stay=function(){return f=!0,h},h},halfPendulum:function(t,e,n){return u.pendulum(t,e,n,{start:-l,end:0,cycle:l})},oneByOne:function(t){var e=t,n=!1,r=function(){for(var t=0;e.length>t;t++){var r=e[t]();if("object"===(void 0===r?"undefined":o(r))){if(!r.$$over)return r.$$value}else if(r!==!1)return r}if(n){for(var a=void 0,s=0;e.length>s;s++){var i=e[s]();i&&i.$$loop&&(i.$$loop(),a=a||e[s]())}return a}};return r.loop=function(){return n=!0,r},r}};t.exports=u}])});