!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return t[r].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(16)},function(t,e){"use strict";t.exports={funcOrValue:function(t,e){if("function"==typeof t){var n=t.call(e);return n&&void 0!==n.$$value?n.$$value:n}return t},execFuncs:function(t,e,n){"function"==typeof t?t.apply(e,n):Array.prototype.isPrototypeOf(t)&&t.forEach(function(t){t&&t.apply(e)})},getMinFromArray:function(t){var e=t[0];return t.forEach(function(t){e>t&&(e=t)}),e},getCharFromKey:function(t){return t.key||String.fromCharCode(t.keyCode)},noop:function(){},firstValuable:function(t,e){return void 0===t?e:t},assign:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}}},function(t,e){"use strict";t.exports={xywh:["sx","sy","sw","sh","tx","ty","tw","th"],txywh:["tx","ty","tw","th"],sxywh:["sx","sy","sw","sh"],devFlag:"__EASYCANVAS_DEVTOOL__"}},function(t,e){"use strict";var n=function(t,e,n,r,a){var o=a||1;return o>t-n?t-n>-o?o>e-r?e-r>-o?5:8:2:o>e-r?e-r>-o?4:7:1:o>e-r?e-r>-o?6:9:3},r={1:{x:-1,y:1},2:{x:0,y:1},3:{x:1,y:1},4:{x:-1,y:0},5:{x:0,y:0},6:{x:1,y:0},7:{x:-1,y:-1},8:{x:0,y:-1},9:{x:1,y:-1}};t.exports={num:n,xy:function(){var t=n.apply(this,arguments);return JSON.parse(JSON.stringify(r[t]||{}))},NUM2XAY:function(t){return JSON.parse(JSON.stringify(r[t]))},pointInRect:function(t,e,n,r,a,o){return!(n>t||t>r||a>e||e>o)},getDistanceSq:function(t,e,n,r){return(t-n)*(t-n)+(e-r)*(e-r)},enoughNear:function(t,e,n,r,a){return a*a>=(t-n)*(t-n)+(e-r)*(e-r)}}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1),o=(r(a),n(3)),i=(r(o),!1),s=function(t,e){t.drag.draggingFlag=e,i=e},l=function(t,e,n,r){return t?t.call(e,n):!!r&&"drag"};t.exports={bind:function(t){var e={x:0,y:0};t.drag.draggingFlag=!1;var n=t.events.mousedown||t.events.touchstart;t.events.touchstart=t.events.mousedown=function(r){if(t.drag.dragable){s(t,!0);e.x=r.canvasX,e.y=r.canvasY}return l(n,t,r,t.drag.dragable)}.bind(t);var r=t.events.hold||t.events.mousemove;t.events.touchmove=t.events.mousemove=function(n){var a=t.drag.draggingFlag&&t.drag.dragable;return a&&(this.style.tx+=n.canvasX-e.x,this.style.ty+=n.canvasY-e.y,e.x=n.canvasX,e.y=n.canvasY),l(r,t,n,a)}.bind(t);var a=t.events.mouseup||t.events.touchend;t.events.touchend=t.events.mouseup=function(e){var n=t.drag.draggingFlag&&t.drag.dragable;return t.drag.draggingFlag&&t.drag.dragable&&s(t,!1),l(a,t,e,n)};var o=t.events.mouseout;t.events.mouseout=function(e){var n=t.drag.draggingFlag&&t.drag.dragable;return s(t,!1),l(o,t,e,n)};var i=t.events.click;t.events.click=function(e){var n=t.drag.dragable;if(n){return!i||i.call(t,e)}return l(i,t,e,n)}}}},,function(t,e){"use strict";var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};t.exports=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1),o=r(a),i=n(2),s=r(i),l=n(11),c=r(l),u=n(10),f=r(u),h=n(12),d=r(h),p=n(9),v=r(p),g=n(4),y=r(g),x=function(t){t.$id||(t.$id=Math.random().toString(36).substr(2)),t.content=t.content||{},t.style=t.style||{},t.style.zIndex=t.style.zIndex||0,t.style.mirrX=t.style.mirrX||0,t.style.opacity=void 0===t.style.opacity?1:t.style.opacity,t.style.locate=t.style.locate||"center",t.style.scale=t.style.scale||1;var e=o.default.funcOrValue(t.content.img);if(void 0===e&&(e={width:0,height:0}),s.default.xywh.forEach(function(e){t.style[e]=t.style[e]||0}),t.inherit=t.inherit||["tx","ty","scale"],t.drag=t.drag||{},t.events=t.events||{},t.events.eIndex=t.events.eIndex||0,t.events.through=!!t.events.through,t.scroll=t.scroll||{},t.scroll.scrollX=t.scroll.scrollX||0,t.scroll.scrollY=t.scroll.scrollY||0,t.hooks=t.hooks||{},t.name=t.name,!t.name&&t.content.img&&t.content.img.src){var n=t.content.img.src.match(/.*\/([^\/]*)$/);n&&n[1]&&(t.name=n[1])}return t.name=t.name||"Unnamed Easycanvas Object",t.children=t.children||[],t.children.forEach(function(e){e.$canvas=t.$canvas,e.$parent=t,e=new m(e)}),t.$cache={},t.$scroll={speedX:0,speedY:0},t},m=function(t){var e=x(t);for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this[n]=e[n]);return this};m.prototype.add=function(t){return this.children=this.children||[],t.$canvas=this.$canvas,t.$parent=this,t.$id||(t=new m(t)),y.default.bind(t),t.children.forEach(function(e,n){t.children[n]=new m(e),t.children[n].$canvas=t.$canvas,t.children[n].$parent=t}),this.children.push(t),t},m.prototype.remove=function(t){return t?(this.$canvas.remove(t),void o.default.execFuncs(t.hooks.removed,t)):(this.$parent?this.$parent.remove(this):this.$canvas.remove(this),void o.default.execFuncs(this.hooks.removed,this))},m.prototype.on=c.default,m.prototype.off=f.default,m.prototype.trigger=d.default,m.prototype.broadcast=v.default,t.exports=m},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1),o=r(a),i=n(6),s=r(i),l={},c=!1,u=[],f={stop:function(){c=!1},tick:function(){(0,s.default)(f.looper)},looper:function(){u.forEach(function(t,e){if(Math.abs(t.$scroll.speedX)>1?t.$scroll.speedX*=t.scroll.smooth||.8:t.$scroll.speedX=0,Math.abs(t.$scroll.speedY)>1?t.$scroll.speedY*=t.scroll.smooth||.8:t.$scroll.speedY=0,Math.abs(t.$scroll.speedX)<=1&&Math.abs(t.$scroll.speedY)<=1)return void u.splice(e,1);t.scroll.scrollY-=t.$scroll.speedY,t.scroll.scrollX-=t.$scroll.speedX;var n=o.default.funcOrValue(t.scroll.minScrollX,t),r=o.default.funcOrValue(t.scroll.maxScrollX,t),a=o.default.funcOrValue(t.scroll.minScrollY,t),i=o.default.funcOrValue(t.scroll.maxScrollY,t);!isNaN(a)&&a>t.scroll.scrollY?t.scroll.scrollY=a:!isNaN(i)&&t.scroll.scrollY>i&&(t.scroll.scrollY=i),!isNaN(n)&&n>t.scroll.scrollX?t.scroll.scrollX=n:!isNaN(r)&&t.scroll.scrollX>r&&(t.scroll.scrollX=r)}),f.tick()},touch:function(t,e){if(!t.scroll.scrollable)return!1;if(c){u.indexOf(t)===-1&&u.push(t);var n=Math.abs(e.canvasX-l.x),r=Math.abs(e.canvasY-l.y),a=+new Date-c;return c=+new Date,a/=10,n/a>1&&a>1&&(t.$scroll.speedX+=(e.canvasX-l.x)/a),r/a>1&&a>1&&(t.$scroll.speedY+=(e.canvasY-l.y)/a),l.x=e.canvasX,l.y=e.canvasY,!0}c=+new Date,l.x=e.canvasX,l.y=e.canvasY},wheel:function(t,e){u.indexOf(t)===-1&&u.push(t),t.$scroll.speedX=e.wheelDeltaX,t.$scroll.speedY=e.wheelDeltaY}};t.exports=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1);r(a);t.exports=function(){var t=Array.prototype.slice.call(arguments),e=t.shift();this.hooks[e]&&this.hooks[e].apply(this,t),t.unshift(e),this.children&&this.children.forEach(function(e){e.broadcast.apply(e,t)}),this.paintList&&this.paintList.forEach(function(e){e.broadcast.apply(e,t)})}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1);r(a);t.exports=function(t,e){this.hooks[t]&&(this.hooks[t]!==e&&e?Array.prototype.isPrototypeOf(this.hooks[t])&&(this.hooks[t][this.hooks[t].indexOf(e)]=void 0):delete this.hooks[t])}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1);r(a);t.exports=function(t,e){this.hooks[t]?Array.prototype.isPrototypeOf(this.hooks[t])?this.hooks[t].push(e):this.hooks[t]=[this.hooks[t],e]:this.hooks[t]=e}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1);r(a);t.exports=function(){var t=Array.prototype.slice.call(arguments),e=t.shift();this.hooks[e]&&this.hooks[e].apply(this,t)}},function(t,e){"use strict";function n(t,e){if(t&&t.match(/^data:/))return void(e&&e(t));if(a[t])return void(a[t]!==r?e(a[t]):setTimeout(function(){n(t,e)},100));a[t]=r;var o=new XMLHttpRequest;o.onload=function(){var n=new FileReader;n.onloadend=function(){a[t]=n.result,e&&e(n.result)},n.readAsDataURL(o.response)},o.open("GET",t),o.responseType="blob",o.send()}var r="processing",a={};t.exports=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=(Object.assign||function(t){for(var e=1;arguments.length>e;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},n(2));r(a)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(7),o=r(a);t.exports={sprite:o.default}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(40),o=r(a),i=n(6),s=r(i),l=n(47),c=r(l),u=n(1),f=r(u),h=n(49),d=r(h),p=n(46),v=r(p),g=n(3),y=r(g),x=n(48),m=r(x),$=n(15),w=r($),b=n(14),T=(r(b),{painter:o.default,imgLoader:v.default,multlineText:m.default,posCompare:y.default,transition:d.default,tick:s.default,utils:f.default,mirror:c.default,class:w.default,$version:"0.2.0"});window.Easycanvas=T,t.exports=T},,,,,function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(25),o=r(a),i=n(23),s=r(i),l=n(22),c=r(l),u=n(4),f=r(u),h=n(26),d=r(h),p=n(39),v=(r(p),n(1)),g=(r(v),{$paint:s.default,$eventHandler:c.default,$perPaint:o.default,$bindDrag:f.default,$rAFer:d.default});t.exports=g},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1),o=r(a),i=n(2),s=(r(i),n(3)),l=r(s),c=n(8),u=r(c),f=function(t){return t.sort(function(t,e){return o.default.funcOrValue(t.events.eIndex,t)<o.default.funcOrValue(e.events.eIndex,e)?1:-1})},h=function t(e){return!(e.$parent&&!t(e.$parent))&&o.default.funcOrValue(e.style.visible,e)!==!1},d=function(t,e){if(h(t)===!1)return!1;if(t.$cache){var n=t.$cache.tx,r=t.$cache.ty,a=t.$cache.tw,o=t.$cache.th;return void 0!==n&&l.default.pointInRect(e.canvasX,e.canvasY,n,n+a,r,r+o)}},p=function t(e,n,r){if(e&&e.length)for(var a=0;e.length>a;a++){var i=e[a];i.children.length&&t(f(i.children.filter(function(t){return o.default.funcOrValue(t.events.eIndex,t)>=0})),n,r),d(i,n)&&r.push(i),i.children.length&&t(f(i.children.filter(function(t){return o.default.funcOrValue(t.events.eIndex,t)<0})),n,r)}};t.exports=function(t){!t.layerX&&t.touches&&t.touches[0]&&(t.layerX=t.targetTouches[0].pageX-t.currentTarget.offsetLeft,t.layerY=t.targetTouches[0].pageY-t.currentTarget.offsetTop),!t.layerX&&t.changedTouches&&t.changedTouches[0]&&(t.layerX=t.changedTouches[0].pageX-t.currentTarget.offsetLeft,t.layerY=t.changedTouches[0].pageY-t.currentTarget.offsetTop);var e=parseInt(this.$dom.style.width)/this.contextWidth,n=parseInt(this.$dom.style.height)/this.contextHeight;e=e||1,n=n||1;var r={type:t.type,canvasX:t.layerX/e,canvasY:t.layerY/n,event:t},a=this,o=[];p(f(a.paintList),r,o);a.eHoldingFlag||"mousedown"!==t.type&&"touchstart"!==t.type?!a.eHoldingFlag||"mouseup"!==t.type&&"touchend"!==t.type?!a.eHoldingFlag||"mousemove"!==t.type&&"touchmove"!==t.type||(a.eHoldingFlag=t):(a.eHoldingFlag=!1,u.default.stop()):a.eHoldingFlag=t;for(var i=0;o.length>i;i++){if(("mousemove"===t.type||"touchmove"===t.type)&&a.eLastMouseHover&&a.eLastMouseHover!==o[i]&&o.indexOf(a.eLastMouseHover)===-1){var s=a.eLastMouseHover.events.mouseout||a.eLastMouseHover.events.touchout;s&&s.call(a.eLastMouseHover,r)}if("mousewheel"===r.type)u.default.wheel(o[i],t);else if(a.eHoldingFlag&&"touchmove"===t.type&&u.default.touch(o[i],r))return;if(o[i].events){var l=o[i].events[t.type];if(l){a.eLastMouseHover=o[i];var c=l.call(o[i],r);if(c===!0)return a.eHoldingFlag=!1,c;if("drag"===c)return a.eHoldingFlag=!1,c}if(o[i].through===!1)return}}if(!o.length&&a.eLastMouseHover){var h=a.eLastMouseHover.events.mouseout;h&&h.call(a.eLastMouseHover,r),a.eLastMouseHover=null}var d=a.events[t.type];if(d&&d(r))return a.eHoldingFlag=!1,!0}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1),o=(r(a),n(3)),i=r(o),s=function(t,e,n,r,a,o,i,s,l,c,u,f,h){var d=t.$gl;d.bindTexture(d.TEXTURE_2D,e);var p=d.matrix;p=m4.translate(p,l,c,0),h.rotate&&(p=m4.translate(p,-l+h.translateBeforeRotate[0]||0,-c+h.translateBeforeRotate[1]||0,0),p=m4.zRotate(p,h.rotate),p=m4.translate(p,l+h.translateAfterRotate[0]||0,c+h.translateAfterRotate[1]||0,0)),p=m4.scale(p,u,f,1),d.uniformMatrix4fv(d.matrixLocation,!1,p);var v=m4.translation(a/n,o/r,0);v=m4.scale(v,i/n,s/r,1),d.uniformMatrix4fv(d.textureMatrixLocation,!1,v),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0)},l=function(t,e){var n=this,r=t.props,a=t.settings,o=!1;if("img"===t.type&&(200>n.$paintList.length||r[7]*r[8]>4e4))for(var l=e+1,c=n.$paintList.length;c>l;l++){var u=n.$paintList[l];if("img"===u.type&&"*"===u.imgType&&1===u.settings.globalAlpha&&!u.settings.rotate){var f=u.props;if(i.default.pointInRect(r[5],r[6],f[5],f[5]+f[7],f[6],f[6]+f[8])&&i.default.pointInRect(r[5]+r[7],r[6]+r[8],f[5],f[5]+f[7],f[6],f[6]+f[8]))return void(o=!0)}}if(n.$isWebgl)return void(r[0]&&r[0].texture&&s(n,r[0].texture,r[0].width,r[0].height,r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],a));var h=!1,d=n.$paintContext;1===a.globalAlpha||isNaN(a.globalAlpha)||(h||(d.save(),h=!0),d.globalAlpha=a.globalAlpha),a.translate&&(h||(d.save(),h=!0),d.translate(a.translate[0]||0,a.translate[1]||0)),a.rotate&&(h||(d.save(),h=!0),d.translate(a.translateBeforeRotate[0]||0,a.translateBeforeRotate[1]||0),d.rotate(a.rotate||0),d.translate(a.translateAfterRotate[0]||0,a.translateAfterRotate[1]||0)),a.scale&&(h||(d.save(),h=!0),d.scale(a.scale[0]||1,a.scale[1]||1)),a.transform&&(h||(d.save(),h=!0),d.transform(1,a.transform.fh,a.transform.fv,1,a.transform.fx,a.transform.fy)),"img"===t.type?d.drawImage(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8]):"text"===t.type&&r.content&&(d.font=r.font,d.strokeStyle=r.color,d.fillStyle=r.color,d.textAlign=r.align,d[r.type||"fillText"](r.content,r.tx,r.ty)),h&&d.restore()};t.exports=function(){var t=this;t.$paintList.forEach(l.bind(t))}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1),o=r(a),i=n(2),s=(r(i),window.getFinalStyle=function(t,e,n){var r=o.default.funcOrValue(t.style[n],t);return t.$parent&&t.inherit.indexOf(n)>=0?("tx"===n?r-=t.$parent.scroll.scrollX:"ty"===n&&(r-=t.$parent.scroll.scrollY),"opacity"===n||"scale"===n?o.default.firstValuable(s(t.$parent,e,n),1)*(r||1):o.default.firstValuable(s(t.$parent,e,n),0)+(r||0)):r});t.exports=function(t,e){var n={};for(var r in t.content)n[r]=o.default.funcOrValue(t.content[r],t);for(var a in t.style)n[a]=s(t,e,a);if(t.inherit.forEach(function(r){n[r]=s(t,e,r)}),n.sequence){var i=n.img,l=n.sequence;n.sequence.index=n.sequence.index||0;var c=n.sequence.index||0;0>c&&(c=0);var u=void 0,f=void 0;if(l.w||l.h){u=0>l.w?i.width/(0-l.w):l.w>0?l.w:i.width,f=0>l.h?i.height/(0-l.h):l.h>0?l.h:i.height;var h=parseInt(i.width/u),d=parseInt(i.height/f);l.h&&(n.sx=c%h*u,n.sy=parseInt(c/h)%d*f)}!l.loop&&c>0&&0===n.sx&&0===n.sy&&(n.img=void 0,t.remove()),n.sequence.lastTickTime=n.sequence.lastTickTime||0,e.$nextTickTime-n.sequence.lastTickTime<o.default.funcOrValue(n.sequence.interval,t)||(l.lastTickTime=e.$nextTickTime,n.sequence.index++,n.sequence.lastTickTime=e.$nextTickTime),n.sw=n.sw||u,n.sh=n.sh||f,n.tw=n.tw||u,n.th=n.th||f}return n}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1),o=r(a),i=n(13),s=(r(i),n(2)),l=r(s),c=n(24),u=r(c);t.exports=function(t,e){if(o.default.funcOrValue(t.style.visible,t)===!1)return o.default.execFuncs(t.hooks.beforeTick,t),void o.default.execFuncs(t.hooks.ticked,t);o.default.execFuncs(t.hooks.beforeTick,t);var n=this,r={},a=(0,u.default)(t,n),i=a.text,s=a.img,c=o.default.funcOrValue(t.children,t),f=s?s.$width||s.width||0:0,h=s?s.$height||s.height||0:0;if(s&&!s.$width&&(s.$width=f,s.$height=h),a.tw=a.tw||a.sw||f,a.th=a.th||a.sh||h,a.sw=a.sw||f,a.sh=a.sh||h,"center"===a.locate?(a.tx=a.tx-.5*a.tw,a.ty=a.ty-.5*a.th):"rd"===a.locate&&(a.tx=a.tx-1*a.tw,a.ty=a.ty-1*a.th),(a.fh||a.fv)&&(a.fh=a.fh||0,a.fv=a.fv||0,a.fx=a.fx||0,a.fy=a.fy||0,r.transform={fh:a.fh,fv:a.fv,fx:(a.ty+a.th/2)*a.fv*-1+a.fx,fy:(a.tx+a.tw/2)*a.fh*-1+a.fy}),a.rotate){var d=void 0!==a.rx?a.rx:a.tx+.5*a.tw,p=void 0!==a.ry?a.ry:a.ty+.5*a.th;r.translateBeforeRotate=[d,p],r.rotate=-a.rotate*Math.PI/180,r.rotate=+r.rotate.toFixed(4),r.translateAfterRotate=[-d,-p]}if(1!==a.scale&&(a.tx-=.5*(a.scale-1)*a.tw,a.ty-=.5*(a.scale-1)*a.th,a.tw*=a.scale,a.th*=a.scale),a.mirrX?(r.translate=[n.contextWidth,0],r.scale=[-1,1],a.tx=n.contextWidth-a.tx-a.tw,a.mirrY&&(r.translate=[n.contextWidth,n.contextHeight],r.scale=[-1,-1],a.ty=n.contextHeight-a.ty-a.th)):a.mirrY&&(r.translate=[0,n.contextHeight],r.scale=[1,-1],a.ty=n.contextHeight-a.ty-a.th),!a.rotate&&!i&&f){if(0>a.sx&&a.sw){var v=-a.sx/a.sw;a.tx+=a.tw*v,a.sx=0}if(0>a.sy&&a.sh){var g=-a.sy/a.sh;a.ty+=a.th*g,a.sy=0}if(f&&a.sx+a.sw>f){var y=(a.sx+a.sw-f)/a.sw;a.sw-=a.sw*y,a.tw-=a.tw*y}if(h&&a.sy+a.sh>h){var x=(a.sy+a.sh-h)/a.sh;a.sh-=a.sh*x,a.th-=a.th*x}if(0>a.tx&&a.tw){var m=-a.tx/a.tw;a.sx+=a.sw*m,a.sw-=a.sw*m,a.tw=a.tw+a.tx,a.tx=0}if(0>a.ty&&a.th){var $=-a.ty/a.th;a.sy+=a.sh*$,a.sh-=a.sh*$,a.th=a.th+a.ty,a.ty=0}if(a.tx+a.tw>n.contextWidth&&a.tw){var w=(a.tx+a.tw-n.contextWidth)/a.tw;a.tw-=a.tw*w,a.sw-=a.sw*w}if(a.ty+a.th>n.contextHeight&&a.th){var b=(a.ty+a.th-n.contextHeight)/a.th;a.th-=a.th*b,a.sh-=a.sh*b}}l.default.xywh.forEach(void 0!==t.$cache.tx?function(e){Math.abs(t.$cache[e]-a[e])>1&&(a[e]=parseInt(a[e]))}:function(t){a[t]=parseInt(a[t])});for(var T in a)t.$cache[T]=a[T];if(delete t.$cache.textBottom,s&&void 0===t.$cache.imgType&&(t.$cache.imgType=s.src?"png"===s.src.substr(-3)?"png":"*":"canvas"),c&&c.filter(function(t){return o.default.funcOrValue(t.style.zIndex,t)<0}).sort(function(t,e){var n=o.default.funcOrValue(t.style.zIndex,t),r=o.default.funcOrValue(e.style.zIndex,e);return n===r?0:n>r?1:-1}).forEach(function(t,e){n.$perPaint.call(n,t,e)}),r.globalAlpha=void 0!==a.opacity?a.opacity:1,s&&f&&0!==a.opacity&&a.sw&&a.sh&&n.contextWidth>a.tx&&n.contextHeight>a.ty&&n.$paintList.push({$id:t.$id,type:"img",settings:r,imgType:t.$cache.imgType,props:[s,a.sx,a.sy,a.sw,a.sh,a.tx,a.ty,a.tw,a.th]}),i){var _=a.tx,A=a.ty,E=t.style.align,L=o.default.funcOrValue(t.style.font,t)||"14px Arial",F=parseInt(L),k=t.style.lineHeight||F;if("center"===E?_+=a.tw/2:"right"===E&&(_+=a.tw),"top"===t.style.textVerticalAlign?A+=F+(k-F)/2:"bottom"===t.style.textVerticalAlign?A+=a.th-(k-F)/2:"middle"===t.style.textVerticalAlign&&(A+=a.th/2+F/2),"string"==typeof i)n.$paintList.push({$id:t.$id,type:"text",settings:r,props:{tx:_,ty:A,content:i,align:E||"left",font:L,color:t.style.color||"white",type:t.style.textType||"fillText"}});else if(i.length)i.forEach(function(e){n.$paintList.push({$id:t.$id,type:"text",settings:r,props:{tx:_+o.default.funcOrValue(e.tx,t),ty:A+o.default.funcOrValue(e.ty,t),content:o.default.funcOrValue(e.content,t),align:E||"left",font:L,color:t.style.color||"white",type:t.style.textType||"fillText"}})});else if("multline-text"===i.type){var O=i.text.split(/\t|\n/),R=function(t){var e=/[^\u4e00-\u9fa5]/;return!e.test(t)},M=[];O.forEach(function(t,e){t=String.prototype.trim.apply(t),i.config.start&&(t=t.replace(i.config.start,""));for(var n=0,r=a.tw;t.length&&t.length>n;)r>0||(r=a.tw,M.push(t.substr(0,n)),t=t.substr(n),n=0),n++,r-=F*(R(t[n])?1.05:.6);(t||e)&&M.push(t)}),M.forEach(function(e){n.$paintList.push({$id:t.$id,type:"text",settings:r,props:{tx:_,ty:A,content:e,align:E||"left",font:L,color:t.style.color||"white",type:t.style.textType||"fillText"}}),A+=k||F}),t.$cache.textBottom=A}}c&&c.filter(function(t){return!(o.default.funcOrValue(t.style.zIndex,t)<0)}).sort(function(t,e){var n=o.default.funcOrValue(t.style.zIndex,t),r=o.default.funcOrValue(e.style.zIndex,e);return n===r?0:n>r?1:-1}).forEach(function(t,e){n.$perPaint.call(n,t,e)}),o.default.execFuncs(t.hooks.ticked,t)}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(6),o=r(a);t.exports=function(t){var e=(new Date).getTime();this.$nextTickTime=e,1e3>e-this.fpsCalculateTime||(this.fpsCalculateTime=e,this.fpsHandler&&this.fpsHandler.call(this,this.fps),this.lastFps=this.fps,this.fps=0),(0,o.default)(function(n){if(this.$rafTime=n,this.$rAFer(t),this.maxFps>0&&60>this.maxFps){if(1e3/this.maxFps>=e-this.$lastPaintTime)return;this.$lastPaintTime=e-(e-this.$lastPaintTime)%(1e3/this.maxFps)}t()}.bind(this))}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(28),o=r(a),i=n(35),s=r(i),l=n(38),c=r(l),u=n(31),f=r(u),h=n(29),d=r(h),p=n(32),v=r(p),g=n(11),y=r(g),x=n(10),m=r(x),$=n(12),w=r($),b=n(9),T=r(b),_=n(30),A=r(_),E=n(33),L=r(E),F=n(36),k=r(F),O=n(37),R=r(O),M={start:c.default,paint:f.default,add:o.default,remove:s.default,register:L.default,clear:d.default,setFpsHandler:k.default,setMaxFps:R.default,pause:v.default,on:y.default,off:m.default,trigger:w.default,broadcast:T.default,nextTick:A.default};t.exports=M},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1),o=(r(a),n(7)),i=r(o),s=n(4),l=r(s),c=function(t){if(t){var e=this,n=t;return n.$canvas=e,n.$id||(n=new i.default(n)),l.default.bind(n),n.children.forEach(function(t,r){n.children[r]=new i.default(t),n.children[r].$canvas=e,n.children[r].$parent=n}),e.paintList.push(n),n}};t.exports=c},function(t,e){"use strict";t.exports=function(){this.paintList=[]}},function(t,e){"use strict";t.exports=function(t){var e=function e(){t.apply(this,arguments),this.off("nextTick",e)};this.on("nextTick",e.bind(this))}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1),o=r(a);t.exports=function(){if(!this.$pausing&&!document.hidden){var t=this;if(o.default.execFuncs(t.hooks.ticked,t,[t.$rafTime]),this.$isWebgl){var e=this.$gl;webglUtils.resizeCanvasToDisplaySize(e.canvas),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT)}else t.$paintContext.clearRect(0,0,this.contextWidth,this.contextHeight);t.$freezing||(t.$paintList=[],this.paintList.sort(function(t,e){var n=o.default.funcOrValue(t.style.zIndex,t),r=o.default.funcOrValue(e.style.zIndex,e);return n===r?0:n>r?1:-1}).forEach(function(e,n){t.$perPaint(e,n)})),t.$paint(),this.fps++,t.hooks.nextTick&&(o.default.execFuncs(t.hooks.nextTick,t,[t.$rafTime]),delete t.hooks.nextTick)}}},function(t,e){"use strict";t.exports=function(t){this.$pausing=void 0===t||t}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(34),o=r(a),i=n(8),s=r(i),l=n(13),c=r(l);t.exports=function(t,e){var n=this;for(var r in o.default)this[r]=JSON.parse(JSON.stringify(o.default[r]));var a=e||{};if(this.$dom=t,a.fullScreen&&(t.width=t.style.width=document.body.clientWidth||document.documentElement.clientWidth,t.height=t.style.height=document.body.clientHeight||document.documentElement.clientHeight),this.width=this.contextWidth=a.width||t.width,this.height=this.contextHeight=a.height||t.height,this.imageLoader=Easycanvas.imageLoader,a.webgl&&(this.$paintContext=t.getContext("webgl",{alpha:!0}))){this.$isWebgl=!0;var i=this.$gl=this.$paintContext;i.matrix=m4.orthographic(0,i.canvas.width,i.canvas.height,0,-1,1),i.clearColor(0,0,0,0),i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.program=webglUtils.createProgramFromScripts(i,["drawImage-vertex-shader","drawImage-fragment-shader"]),i.useProgram(i.program),i.positionLocation=i.getAttribLocation(i.program,"a_position"),i.texcoordLocation=i.getAttribLocation(i.program,"a_texcoord"),i.matrixLocation=i.getUniformLocation(i.program,"u_matrix"),i.textureMatrixLocation=i.getUniformLocation(i.program,"u_textureMatrix"),i.textureLocation=i.getUniformLocation(i.program,"u_texture"),i.positionBuffer=i.positionBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,i.positionBuffer),i.enableVertexAttribArray(i.positionLocation),i.vertexAttribPointer(i.positionLocation,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(i.texcoordLocation),i.vertexAttribPointer(i.texcoordLocation,2,i.FLOAT,!1,0,0);var l=[0,0,1,0,0,1,1,1];i.bufferData(i.ARRAY_BUFFER,new Float32Array(l),i.STATIC_DRAW);var u=i.createBuffer();i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,u),i.texcoordBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,i.texcoordBuffer);var f=[0,0,1,0,0,1,1,1];i.bufferData(i.ARRAY_BUFFER,new Float32Array(f),i.STATIC_DRAW);var h=[0,1,2,2,1,3];i.bufferData(i.ELEMENT_ARRAY_BUFFER,new Uint16Array(h),i.STATIC_DRAW),this.imgLoader=function(t,e){var n=i.createTexture();i.bindTexture(i.TEXTURE_2D,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR);var r={width:0,height:0,texture:n};return(0,c.default)(t,function(t){function n(t){var n=new Image;n.addEventListener("load",function(){r.width=n.width,r.height=n.height,i.bindTexture(i.TEXTURE_2D,r.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n),e&&e(r)}),n.src=t}n(t,e)}),r}}this.$paintContext=this.$paintContext||t.getContext("2d"),this.imgLoader=this.imgLoader||Easycanvas.imgLoader,this.events=a.events||{},this.hooks=a.hooks||{};var d=["contextmenu","mousewheel","click","dblclick","mousedown","mouseup","mousemove","touchstart","touchend","touchmove"];d.forEach(function(e){t.addEventListener(e,n.$eventHandler.bind(n))}),s.default.tick(),setInterval(function(){if(n.eHoldingFlag){var t=n.eHoldingFlag;n.$eventHandler.call(n,{layerX:t.layerX,layerY:t.layerY,screenX:t.screenX||t.layerX,screenY:t.screenY||t.layerY,type:"hold"})}},40)}},function(t,e){"use strict";var n={$dom:null,$paintContext:null,$nextTickTime:0,$lastPaintTime:0,$pausing:!1,$freezing:!1,fps:0,lastFps:0,fpsCalculateTime:0,fpsHandler:null,contextWidth:0,contextHeight:0,events:{click:null},paintList:[],eHoldingFlag:!1,eLastMouseHover:null,maxFps:-1,scroll:{scrollable:!1,scrollY:0,minScrollY:void 0,maxScrollY:void 0},$flags:{dragging:!1}};t.exports=n},function(t,e,n){"use strict";t.exports=function(t,e){t.style.visible=!1,t.removing=!0,setTimeout(function(){t.$parent?t.$parent.children=t.$parent.children.filter(function(t){return t.removing!==!0}):this.paintList=this.paintList.filter(function(t){return t.removing!==!0})}.bind(this)),e&&this.paintList.splice(this.paintList.indexOf(t),1)}},function(t,e){"use strict";t.exports=function(t){this.fpsHandler=t}},function(t,e){"use strict";t.exports=function(t){this.maxFps=t||-1}},function(t,e){"use strict";t.exports=function(){this.fpsCalculateTime=(new Date).getTime(),this.$rAFer(this.paint.bind(this))}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(1),o=r(a),i=n(2),s=r(i);t.exports=function(){var t,e,n,r}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a=n(27),o=r(a),i=n(21),s=r(i),l=function(){};for(var c in s.default)Object.prototype.hasOwnProperty.call(s.default,c)&&(l.prototype[c]=s.default[c]);for(var u in o.default)Object.prototype.hasOwnProperty.call(o.default,u)&&(l.prototype[u]=o.default[u]);t.exports=l},,,,,,function(t,e){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r={},a=[],o=0,i=function t(e,i,s){var l=s||{};if("object"===(void 0===e?"undefined":n(e))){var c=e;return l.callbackArgs=l.callbackArgs||[],void t(c.shift(),function(e){l.callbackArgs.push(e),c.length>1?t(c,i,l):t(c[0],function(t){l.callbackArgs.push(t),i(l.callbackArgs)},l)},s)}var u=e;if(l.alphaColor&&(u+=l.alphaColor),r[u])return setTimeout(function(){i&&i(r[u])}),r[u];var f=new Image;l.block?(f.src=e,o++):0===o?f.src=e:a.push({imgObj:f,src:e}),r[u]=f;var h=void 0;return(l.canvas||l.alphaColor)&&(h=document.createElement("canvas"),h.width=h.height||0,r[u]=h),f.onload=function(){if(l.block&&(o--,0===o&&(a.forEach(function(t){t.imgObj.src=t.src}),a.splice(0))),l.canvas||l.alphaColor){var t=h.getContext("2d");if(h.$width=h.width=f.width,h.$height=h.height=f.height,t.drawImage(f,0,0),l.alphaColor){for(var e=t.getImageData(0,0,f.width,f.height),n=0;e.data.length>n;n+=4){var r=e.data[n]+e.data[n+1]+e.data[n+2],s=1;s>e.data[n]&&s>e.data[n+1]&&s>e.data[n+2]&&(e.data[n+3]=parseInt(r/255))}t.putImageData(e,0,0)}f=h}i&&i(f)},f.onerror=function(){r[u]=f},h||f};t.exports=i},function(t,e){"use strict";t.exports=function(t){var e=t.width,n=t.height,r=document.createElement("canvas");r.width=e,r.height=n;var a=r.getContext("2d");a.scale(1,-1),a.translate(0,-n),a.drawImage(t,0,0);var o=a.getImageData(0,0,e,n);return{canvas:a,img:o}}},function(t,e){"use strict";t.exports=function(t,e){return{type:"multline-text",text:t,config:e}}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(1),i=r(o),s=[],l=3.141593,c=function(t){return t/1e3*60},u={linear:function(t,e,n){var r=s.length;s.push(t);var a=!1,o=function(){var o=s[r];return o>=t&&e>o||o>e&&t>=o?(s[r]+=(e-t)/c(n),{$$value:o,$$over:!1}):(a&&(s[r]=t),{$$value:e,$$over:!0,$$loop:function(){s[r]=t}})};return o.loop=function(){return a=!0,o},o},pendulum:function(t,e,n,r){var a=r||{};a.start=i.default.firstValuable(a.start,-l),a.end=i.default.firstValuable(a.end,l),a.cycle=i.default.firstValuable(a.cycle,2*l);var o=s.length;s.push(a.start);var u=!1,f=!1,h=function(){var r=Math.cos(s[o])+1;return s[o]+=l/c(n),s[o]>a.end&&(u?s[o]-=a.cycle:s[o]=a.end),{$$value:i.default.funcOrValue(t)+(i.default.funcOrValue(e)-i.default.funcOrValue(t))*r/2,$$over:!f&&s[o]>=a.end,$$loop:function(){s[o]=-l}}};return h.loop=function(){return u=!0,h},h.stay=function(){return f=!0,h},h},halfPendulum:function(t,e,n){return u.pendulum(t,e,n,{start:-l,end:0,cycle:l})},oneByOne:function(t){var e=t,n=!1,r=function(){for(var t=0;e.length>t;t++){var r=e[t]();if("object"===(void 0===r?"undefined":a(r))){if(!r.$$over)return r.$$value}else if(r!==!1)return r}if(n){for(var o=void 0,i=0;e.length>i;i++){var s=e[i]();s&&s.$$loop&&(s.$$loop(),o=o||e[i]())}return o}};return r.loop=function(){return n=!0,r},r}};t.exports=u}])});