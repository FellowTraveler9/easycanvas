(function(e, a) { for(var i in a) e[i] = a[i]; }(window, /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 1);
/******/ })
/************************************************************************/
/******/ ({

/***/ "./constants.js":
/*!**********************!*\
  !*** ./constants.js ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar sxywh = ['cutLeft', 'cutTop', 'cutWidth', 'cutHeight'];\nvar txywh = ['left', 'top', 'width', 'height'];\nvar xywh = sxywh.concat(txywh);\nvar styles = xywh.concat(['locate', 'rotateOriginLeft', 'rotateOriginTop', 'zIndex', 'fontSize', 'fontFamily', 'textAlign', 'textVerticalAlign', 'color', 'rotate', 'scale', 'opacity', 'backgroundColor', 'borderWidth', 'borderColor', 'overflow', 'overflowX', 'overflowY']);\nmodule.exports = {\n  txywh: txywh,\n  sxywh: sxywh,\n  xywh: xywh,\n  styles: styles,\n  devFlag: '__EASYCANVAS_DEVTOOL__',\n  version: '0.8.4'\n};\n\n//# sourceURL=webpack:///./constants.js?");

/***/ }),

/***/ "./src/bridge/chrome-devtool.js":
/*!**************************************!*\
  !*** ./src/bridge/chrome-devtool.js ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _constants = _interopRequireDefault(__webpack_require__(/*! constants */ \"./constants.js\"));\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Preparing data for devtool.\n *\n * ********** **/\nif (true) {\n  if (!window[_constants[\"default\"].devFlag]) {\n    // init\n    var devData = window[_constants[\"default\"].devFlag] = {\n      isPaintRecording: false,\n      selectMode: false,\n      current: {},\n      version: _constants[\"default\"].version,\n      $canvas: {},\n      $plugin: null\n    };\n    var BRIDGE = {\n      getSprite: function getSprite($canvasId) {\n        if (!devData.isPaintRecording) return [];\n        var res = {};\n\n        if ($canvasId) {\n          var children = devData.$canvas[$canvasId].children;\n          var $children = devData.$canvas[$canvasId].$children;\n\n          var pusher = function pusher(item) {\n            // Skip $mask in select mode\n            if (item.name === _constants[\"default\"].devFlag) return;\n            res[item.$id] = {\n              name: item.name,\n              $addIndex: item.$addIndex,\n              parent: item.$parent && item.$parent.$id,\n              style: {},\n              children: item.children.filter(function (child) {\n                return child.name !== _constants[\"default\"].devFlag;\n              }).map(function (child) {\n                return child.$id;\n              }),\n              rendered: item.$rendered\n            }; // if (item.content.img || item.content.text) {\n            //     res[item.$id].rendered = false;\n            //     for (let i = 0, l = $children.length; i < l; i++) {\n            //         if ($children[i].$id === item.$id) {\n            //             res[item.$id].rendered = true;\n            //             break;\n            //         }\n            //     }\n            // }\n\n            for (var i in item.style) {\n              res[item.$id].style[i] = _utils[\"default\"].funcOrValue(item.style[i], item);\n            }\n\n            _constants[\"default\"].xywh.forEach(function (key) {\n              res[item.$id].style[key] = Math.round(res[item.$id].style[key]);\n            });\n\n            ['physics', '$perf'].forEach(function (key) {\n              res[item.$id][key] = item[key];\n            });\n\n            if (item.webgl) {\n              res[item.$id].webgl = {};\n              ['rx', 'ry', 'rz', 'x', 'y', 'z'].forEach(function (key) {\n                res[item.$id].webgl[key] = _utils[\"default\"].funcOrValue(item.webgl[key], item);\n              });\n            }\n\n            if (item.children) {\n              item.children.sort(function (a, b) {\n                return a.$addIndex < b.$addIndex ? -1 : 1;\n              }).forEach(pusher);\n            }\n          };\n\n          children.sort(function (a, b) {\n            return a.$addIndex < b.$addIndex ? -1 : 1;\n          }).forEach(pusher);\n        } else {\n          for (var c in devData.$canvas) {\n            res = Object.assign(res, devData.$plugin.getSprite(c));\n          }\n        }\n\n        return res;\n      },\n      selectSpriteById: function selectSpriteById($spriteId, $canvasId) {\n        if (!$canvasId) {\n          for (var i in devData.$canvas) {\n            var _res = BRIDGE.selectSpriteById($spriteId, i);\n\n            if (_res) {\n              return {\n                $sprite: _res.$sprite || _res,\n                $canvas: devData.$canvas[i]\n              };\n            }\n          }\n\n          return false;\n        }\n\n        var looper = function looper(array) {\n          for (var _i = 0; _i < array.length; _i++) {\n            if (array[_i].$id === $spriteId) return array[_i];\n\n            var _res2 = looper(array[_i].children);\n\n            if (_res2) {\n              return {\n                $sprite: _res2.$sprite || _res2,\n                $canvas: devData.$canvas[$canvasId]\n              };\n            }\n          }\n\n          return false;\n        };\n\n        var children = devData.$canvas[$canvasId].children;\n        var res = looper(children);\n\n        if (res) {\n          return {\n            $sprite: res.$sprite || res,\n            $canvas: devData.$canvas[$canvasId]\n          };\n        }\n      },\n      updateSprite: function updateSprite($spriteId) {\n        var groupName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'style';\n        var keys = arguments.length > 2 ? arguments[2] : undefined;\n        var $canvasId = arguments.length > 3 ? arguments[3] : undefined;\n        var $sprite = BRIDGE.selectSpriteById($spriteId, $canvasId).$sprite;\n        if (!$sprite) console.warn(\"Sprite \".concat(spriteId, \" Not Found.\"));\n        Object.assign($sprite[groupName], keys);\n      },\n      highlightSprite: function highlightSprite($spriteId, opt, $canvasId) {\n        devData.selectMode = Boolean(opt);\n        var tmp = BRIDGE.selectSpriteById($spriteId, $canvasId);\n        var $sprite = tmp.$sprite;\n        var $canvas = tmp.$canvas;\n\n        if (opt && $canvas && $sprite) {\n          $canvas.$plugin.selectSprite(false, $canvas, $sprite);\n        } else if ($canvas) {\n          $canvas.$plugin.cancelSelectSprite($canvas);\n        }\n      },\n      sendGlobalHook: function sendGlobalHook($spriteId, $canvasId) {\n        var tmp = BRIDGE.selectSpriteById($spriteId, $canvasId);\n        var $sprite = tmp.$sprite;\n        var $canvas = tmp.$canvas;\n        console.log(\"%c window.$0 = %c Current Sprite(\".concat($sprite.name, \") %c \"), \"background:#4086f4 ; padding: 2px 0; border-radius: 2px 0 0 2px;  color: #fff\", \"background:#41b883 ; padding: 2px; border-radius: 0 2px 2px 0;  color: #fff\", \"background:transparent\"); // console.log(`%c window.$1 = %c Current Painter %c`,\n        //     \"background:#4086f4 ; padding: 2px 0; border-radius: 2px 0 0 2px;  color: #fff\",\n        //     \"background:#41b883 ; padding: 2px; border-radius: 0 2px 2px 0;  color: #fff\",\n        //     \"background:transparent\");\n\n        window.$0 = $sprite;\n        window.$1 = $canvas;\n      },\n      pause: function pause($canvasId, opt) {\n        var $canvas = devData.$canvas[$canvasId];\n        $canvas.$pausing = typeof opt !== 'undefined' ? opt : !$canvas.$pausing;\n      },\n      getPerf: function getPerf() {\n        var perfData = {\n          canvas: [],\n          navigator: {\n            clientWidth: document.body.clientWidth,\n            clientHeight: document.body.clientHeight,\n            devicePixelRatio: window.devicePixelRatio\n          }\n        };\n        if (!devData.isPaintRecording) return perfData;\n\n        for (var c in devData.$canvas) {\n          perfData.canvas.push({\n            $id: c,\n            name: devData.$canvas[c].name,\n            perf: devData.$canvas[c].$perf,\n            fps: devData.$canvas[c].lastFps,\n            size: {\n              styleWidth: devData.$canvas[c].$dom.getBoundingClientRect().width || parseInt(devData.$canvas[c].$dom.style.width) || devData.$canvas[c].$dom.width,\n              styleHeight: devData.$canvas[c].$dom.getBoundingClientRect().height || parseInt(devData.$canvas[c].$dom.style.height) || devData.$canvas[c].$dom.height,\n              canvasWidth: devData.$canvas[c].$dom.width,\n              canvasHeight: devData.$canvas[c].$dom.height\n            }\n          });\n        }\n\n        return perfData;\n      }\n    };\n    devData.$plugin = BRIDGE;\n  }\n}\n\n//# sourceURL=webpack:///./src/bridge/chrome-devtool.js?");

/***/ }),

/***/ "./src/class/api.addEventListener.js":
/*!*******************************************!*\
  !*** ./src/class/api.addEventListener.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Add current event\n *\n * ********** **/\nmodule.exports = function (name, func, throttle) {\n  var _handle = func;\n\n  if (throttle) {\n    var that = this;\n\n    _handle = function handle() {\n      var now = Date.now();\n\n      if (now > _handle.$lastTriggerTime + throttle) {\n        _handle.$lastTriggerTime = now;\n        var args = Array.prototype.slice.call(arguments);\n        func.apply(that, args);\n      }\n    };\n\n    _handle.$lastTriggerTime = -1;\n    _handle.$handle = func;\n  }\n\n  if (!this.events[name]) {\n    this.events[name] = _handle;\n  } else if (_utils[\"default\"].isArray(this.events[name])) {\n    this.events[name].push(_handle);\n  } else {\n    this.events[name] = [this.events[name], _handle];\n  }\n};\n\n//# sourceURL=webpack:///./src/class/api.addEventListener.js?");

/***/ }),

/***/ "./src/class/api.broadcast.js":
/*!************************************!*\
  !*** ./src/class/api.broadcast.js ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Trigger event on current sprite and its children\n * - Current sprite first, children following.\n * - Can pass arguments.\n *\n * ********** **/\nmodule.exports = function () {\n  var arg = Array.prototype.slice.call(arguments);\n  var name = arg.shift();\n\n  if (this.hooks[name]) {\n    _utils[\"default\"].execFuncs(this.hooks[name], this, arg); // this.hooks[name].apply(this, arg);\n\n  }\n\n  arg.unshift(name); // let children = this.$combine ? this.$combine.children : this.children;\n\n  var children = this.children;\n  children && children.forEach(function (child) {\n    child.broadcast.apply(child, arg);\n  });\n};\n\n//# sourceURL=webpack:///./src/class/api.broadcast.js?");

/***/ }),

/***/ "./src/class/api.combine.js":
/*!**********************************!*\
  !*** ./src/class/api.combine.js ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n// 图层合并，原理：\n// 取出要合并的sprite的所有children，新建一个<canvas>在上面render，然后截图放到sprite的$combine里\nvar COMBINE_ING = 9;\nvar COMBINE_DONE = 1; // const COMBINE_FAIL = 2;\n// const COMBINE_DELAY = 3;\n\nmodule.exports = function () {\n  var _this = this;\n\n  //return;\n  var $sprite = this;\n\n  if ($sprite.$combine !== COMBINE_ING) {\n    return COMBINE_DONE;\n  }\n\n  setTimeout(function () {\n    if ($sprite.$combine !== COMBINE_ING) {\n      return; // COMBINE_DONE;\n    }\n\n    if ($sprite.getStyle('visible') === false) return; // COMBINE_DELAY;\n\n    var $canvas = _this.$canvas;\n    var rect = $sprite.getRect(false, true);\n    if (rect.tw > $canvas.width) return; // COMBINE_FAIL;\n\n    if (rect.th > $canvas.height) return; // COMBINE_FAIL;\n\n    var allChildrenInCombine = $sprite.getAllChildren(true);\n\n    for (var i = 0; i < allChildrenInCombine.length; i++) {\n      var $child = allChildrenInCombine[i];\n\n      if ($child.content.img && !$child.$render._imgWidth) {\n        // 存在未加载完的子对象，不进行合并\n        return; // COMBINE_DELAY;\n      }\n\n      if ($child.getStyle('scale') !== 1) {\n        return; // COMBINE_DELAY;\n      }\n    }\n\n    var outerRect;\n\n    if (_utils[\"default\"].funcOrValue($sprite.style.overflow, $sprite) !== 'hidden') {\n      outerRect = $sprite.getOuterRect(false, true);\n      outerRect.left = Math.floor(outerRect.left);\n      outerRect.top = Math.floor(outerRect.top);\n      outerRect.width = Math.round(outerRect.width);\n      outerRect.height = Math.round(outerRect.height);\n      outerRect.right = Math.round(outerRect.right);\n      outerRect.bottom = Math.round(outerRect.bottom); // if (!force) {\n\n      if (outerRect.width > $canvas.width) return; // COMBINE_FAIL;\n\n      if (outerRect.height > $canvas.height) return; // COMBINE_FAIL;\n      // }\n    } else {\n      outerRect = rect;\n    }\n\n    $sprite.off('ticked', _this.combine);\n    var $renders = $canvas.$children.filter(function ($child) {\n      for (var _i = 0; _i < allChildrenInCombine.length; _i++) {\n        if (allChildrenInCombine[_i].$id === $child.$id) return true;\n      }\n    });\n    var spriteOpacity = $sprite.getStyle('opacity');\n    $renders.forEach(function ($render) {\n      if (!$render.settings) return; // sprite的透明度可能受到parent的影响，截图时需要还原opacity，先备份一下\n\n      $render.settings.$combineGlobalAlpha = $render.settings.globalAlpha;\n      $render.settings.globalAlpha = spriteOpacity > 0 ? $render.settings.globalAlpha / spriteOpacity : 1;\n\n      if (!$render.props.$moved) {\n        // 渲染之前先位移，便于裁剪\n        // 多个渲染对象来自同一个$sprite，那么在perPaint里计算出来的props是同一份引用\n        // 所以这里打一个标记，避免重复位移(hard code，硬编码)\n        $render.props.$moved = true;\n        $render.props.left -= outerRect.left;\n        $render.props.top -= outerRect.top;\n      }\n    });\n    var combinerCanvas = $canvas.$combinerCanvas;\n\n    if (!combinerCanvas) {\n      combinerCanvas = $canvas.$combinerCanvas = document.createElement('canvas');\n      combinerCanvas.width = $canvas.width;\n      combinerCanvas.height = $canvas.height; // document.body.prepend(canvas);\n    }\n\n    var combineCtx = combinerCanvas.getContext('2d');\n    combineCtx.clearRect(0, 0, $canvas.width, $canvas.height);\n    $canvas.$render(combineCtx, $renders, true\n    /* renderAll */\n    );\n    $renders.forEach(function ($render) {\n      if (!$render.settings) return; // sprite的透明度可能受到parent的影响，这里恢复\n\n      $render.settings.globalAlpha = $render.settings.$combineGlobalAlpha;\n    });\n    var canvas = document.createElement('canvas'); // document.body.prepend(canvas);\n\n    canvas.width = outerRect.width;\n    canvas.height = outerRect.height;\n    var ctx = canvas.getContext('2d');\n    ctx.drawImage(combinerCanvas, 0, 0, outerRect.width, outerRect.height, 0, 0, outerRect.width, outerRect.height); // $sprite.children.forEach((child) => {\n    //     // 清空$cache，以免后续使用时（如事件处理）拿到了老的坐标\n    //     // [RISK]但是可能导致一些transition的变量有偏差\n    //     child.$cache = {};\n    // });\n\n    $sprite.$combine = {\n      content: $sprite.content,\n      children: $sprite.children,\n      style: Object.assign({}, $sprite.style)\n    };\n    $sprite.children = [];\n    $sprite.content = {\n      img: canvas\n    };\n    var newLeft = $sprite.getSelfStyle('left') - (Math.floor(rect.left) - outerRect.left);\n    var newTop = $sprite.getSelfStyle('top') - (Math.floor(rect.top) - outerRect.top);\n    Object.assign($sprite.style, {\n      // opacity: 1,\n      scale: 1,\n      left: newLeft,\n      top: newTop,\n      width: canvas.width,\n      height: canvas.height,\n      backgroundColor: undefined\n    });\n    return; // COMBINE_DONE;\n  });\n  return this;\n};\n\n//# sourceURL=webpack:///./src/class/api.combine.js?");

/***/ }),

/***/ "./src/class/api.distribute.js":
/*!*************************************!*\
  !*** ./src/class/api.distribute.js ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n/** ********** *\n *\n * Trigger event on current sprite and its children\n * - Current sprite first, children following.\n * - Can pass arguments.\n *\n * ********** **/\nmodule.exports = function () {\n  var arg = Array.prototype.slice.call(arguments);\n  var name = arg.shift();\n  arg.unshift(name); // let children = this.$combine ? this.$combine.children : this.children;\n\n  var children = this.children;\n  children && children.forEach(function (child) {\n    child.broadcast.apply(child, arg);\n  });\n};\n\n//# sourceURL=webpack:///./src/class/api.distribute.js?");

/***/ }),

/***/ "./src/class/api.getOuterRect.js":
/*!***************************************!*\
  !*** ./src/class/api.getOuterRect.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nmodule.exports = function (notImg, fromCache) {\n  var $sprite = this;\n  var rect = $sprite.getRect(notImg, fromCache);\n  rect.right = rect.left + rect.width;\n  rect.bottom = rect.top + rect.height;\n  this.children.forEach(function (child) {\n    if (child.$cache.visible === false) return;\n    var childRect = child.getOuterRect(notImg, fromCache);\n    if (childRect.left < rect.left) rect.left = childRect.left;\n    if (childRect.top < rect.top) rect.top = childRect.top;\n    if (childRect.right > rect.right) rect.right = childRect.right;\n    if (childRect.bottom > rect.bottom) rect.bottom = childRect.bottom;\n    rect.width = rect.right - rect.left;\n    rect.height = rect.bottom - rect.top;\n  });\n  return rect;\n};\n\n//# sourceURL=webpack:///./src/class/api.getOuterRect.js?");

/***/ }),

/***/ "./src/class/api.off.js":
/*!******************************!*\
  !*** ./src/class/api.off.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Remove current hook\n *\n * ********** **/\nmodule.exports = function (event, func) {\n  if (!this.hooks[event]) return;\n\n  if (this.hooks[event] === func || this.hooks[event].$handle === func || !func) {\n    delete this.hooks[event];\n  } else if (_utils[\"default\"].isArray(this.hooks[event])) {\n    if (this.hooks[event].indexOf(func) >= 0) {\n      this.hooks[event][this.hooks[event].indexOf(func)] = undefined;\n    } else if (this.hooks[event].indexOf(func.$handle) >= 0) {\n      this.hooks[event][this.hooks[event].indexOf(func.$handle)] = undefined;\n    }\n  }\n};\n\n//# sourceURL=webpack:///./src/class/api.off.js?");

/***/ }),

/***/ "./src/class/api.on.js":
/*!*****************************!*\
  !*** ./src/class/api.on.js ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Add current hook\n *\n * ********** **/\nmodule.exports = function (name, func, throttle) {\n  var _handle = func;\n\n  if (throttle) {\n    var that = this;\n\n    _handle = function handle() {\n      var now = Date.now();\n\n      if (now > _handle.$lastTriggerTime + throttle) {\n        _handle.$lastTriggerTime = now;\n        var args = Array.prototype.slice.call(arguments);\n        func.apply(that, args);\n      }\n    };\n\n    _handle.$lastTriggerTime = -1;\n    _handle.$handle = func;\n  }\n\n  if (!this.hooks[name]) {\n    this.hooks[name] = _handle;\n  } else if (_utils[\"default\"].isArray(this.hooks[name])) {\n    this.hooks[name].push(_handle);\n  } else {\n    this.hooks[name] = [this.hooks[name], _handle];\n  }\n};\n\n//# sourceURL=webpack:///./src/class/api.on.js?");

/***/ }),

/***/ "./src/class/api.recalculate.js":
/*!**************************************!*\
  !*** ./src/class/api.recalculate.js ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nvar _math = _interopRequireDefault(__webpack_require__(/*! utils/math.rect-meet */ \"./src/utils/math.rect-meet.js\"));\n\nvar _constants = _interopRequireDefault(__webpack_require__(/*! constants */ \"./constants.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar blend = _utils[\"default\"].blend;\n\nvar getScaledParent = function getScaledParent($sprite) {\n  if (!$sprite) return;\n\n  var scale = _utils[\"default\"].funcOrValue($sprite.$style.scale, $sprite);\n\n  if (scale !== 1) return $sprite;\n  return getScaledParent($sprite.$parent);\n}; // 后面可能要拆成计算$cache、触发钩子、生成渲染对象$render，便于将部分逻辑复用于combine等场景\n\n\nmodule.exports = function (force) {\n  var $sprite = this;\n  !force && _utils[\"default\"].execFuncs($sprite.hooks.beforeTick, $sprite, [$sprite.$canvas.$rafTime]);\n\n  if (_utils[\"default\"].funcOrValue($sprite.style.visible, $sprite) === false) {\n    $sprite.$cache.visible = false; // 有可能在上面的beforeTick里调用了remove，这样就没有$canvas属性了\n\n    if (!$sprite.$canvas) return; // TODO：execFuncs的调用加判断，没有钩子时，没必要构造第三个数组参数，节约性能\n\n    !force && _utils[\"default\"].execFuncs($sprite.hooks.ticked, $sprite, [$sprite.$canvas.$rafTime]);\n    return;\n  }\n\n  $sprite.$cache.visible = true;\n\n  if (force) {\n    $sprite.$cache = {};\n\n    _constants[\"default\"].styles.forEach(function (key) {\n      $sprite.$needUpdate[key] = 1;\n      $sprite.$cache[key] = undefined;\n    });\n  }\n\n  var isNeedUpdate = Object.keys($sprite.$needUpdate).length;\n  $sprite.$lastUpdate = $sprite.$needUpdate;\n\n  if (isNeedUpdate) {\n    var $needUpdate = {};\n\n    var _loop = function _loop(key) {\n      var cur = $sprite.$cache[key];\n\n      if (typeof $sprite.$style[key] === 'function') {\n        $needUpdate[key] = 1; // double $sprite: same as what funcOrValue do\n\n        $sprite.$cache[key] = $sprite.$style[key].call($sprite, $sprite);\n      } else if (typeof $sprite.$style[key] === 'string' && $sprite.$style[key].indexOf('%') > -1) {\n        // 百分比的样式相对于parent计算\n        var parentWidth = $sprite.$parent && $sprite.$parent.$cache.width || $sprite.$canvas.width || 0;\n        var parentHeight = $sprite.$parent && $sprite.$parent.$cache.width || $sprite.$canvas.width || 0;\n\n        if (key === 'left' || key === 'width') {\n          $sprite.$cache[key] = Math.floor(parseFloat($sprite.$style[key]) / 100 * parentWidth);\n        } else if (key === 'top' || key === 'height') {\n          $sprite.$cache[key] = Math.floor(parseFloat($sprite.$style[key]) / 100 * parentHeight);\n        } else if (key === 'fontSize') {\n          $sprite.$cache[key] = Math.floor(parseFloat($sprite.$style[key]) / 100 * $sprite.$canvas.width);\n        }\n      } else {\n        $sprite.$cache[key] = $sprite.$style[key];\n      } // $sprite.$cache[key] = utils.funcOrValue($sprite.$style[key], $sprite);\n\n\n      if (key === 'left' || key === 'top') {\n        var parent = $sprite.$parent;\n\n        if (parent) {\n          $sprite.$cache[key] += parent.$cache[key] || 0;\n        }\n      } else if (key === 'opacity' || key === 'scale') {\n        var _parent = $sprite.$parent;\n\n        if (_parent) {\n          $sprite.$cache[key] *= _utils[\"default\"].firstValuable(_parent.$cache[key], 1);\n        }\n      }\n\n      if (cur === $sprite.$cache[key]) {\n        // 一些属性可能本次计算和上次的结果相同，例如return固定值的一些function，不要触发刷新\n        delete $sprite.$needUpdate[key];\n      } else {\n        if (key === 'left' || key === 'top' || key === 'opacity' || key === 'scale') {\n          if (cur !== $sprite.$cache[key]) {\n            // 继承的属性，parent变化时，child也需要update\n            $sprite.children.forEach(function ($child) {\n              $child.$needUpdate[key] = 1;\n            });\n          }\n        }\n      }\n    };\n\n    for (var key in $sprite.$needUpdate) {\n      _loop(key);\n    }\n\n    ; // 重新得出是否需要更新\n\n    isNeedUpdate = Object.keys($sprite.$needUpdate).length; // 一些属性是function的，提前标记出来，为下一次循环准备\n\n    $sprite.$needUpdate = $needUpdate;\n  }\n\n  !force && _utils[\"default\"].execFuncs($sprite.hooks.ticked, $sprite, [$sprite.$canvas.$rafTime]); // TODO:这两个属性目前没有通过依赖关系来主动更新，暂时用每帧计算，有优化空间\n  // 但是未加载成功的图片要一直触发更新操作，因为不知道什么时候加载成功\n\n  var _text = _utils[\"default\"].funcOrValue($sprite.content.text, $sprite);\n\n  var _img = _utils[\"default\"].funcOrValue($sprite.content.img, $sprite); // $render\n\n\n  if (isNeedUpdate || $sprite.$cache.text !== _text || $sprite.$cache.img !== _img || $sprite.content.img && !$sprite.$render._imgWidth) {\n    var $render = $sprite.$render;\n    $sprite.$cache.img = $render.img = _img;\n    $sprite.$cache.text = $render.text = _text;\n\n    if (typeof $render.img === 'string') {\n      _img = $render.img = $sprite.$canvas.imgLoader($render.img);\n    } // img有宽高，但是没有onload时，仍不能绘制\n\n\n    if (_img && _img._complete === false) _img = false; // 并不是所有属性都要现在挂在$render里，比如color、fontSize就是到perPaint阶段再挂的\n    // 可能需要都搬过来，因为这里是每次更新的时候运行一次，perPaint是每次都运行\n\n    $render.backgroundColor = $sprite.$cache.backgroundColor;\n    $render.borderWidth = $sprite.$cache.borderWidth;\n    $render.borderColor = $sprite.$cache.borderColor;\n    $render.overflow = $sprite.$cache.overflow;\n    $render.overflowX = $sprite.$cache.overflowX;\n    $render.overflowY = $sprite.$cache.overflowY;\n    $render.locate = $sprite.$cache.locate;\n    $render.rotate = $sprite.$cache.rotate;\n    $render.scale = $sprite.$cache.scale;\n    $render.opacity = $sprite.$cache.opacity;\n    $render.$moved = false; // ugly\n\n    $render.childrenInside = ($render.overflow || $render.overflowX || $render.overflowY) && $render.overflow !== 'visible';\n    $render.left = $sprite.$cache.left;\n    $render.top = $sprite.$cache.top;\n    $render.width = $sprite.$cache.width;\n    $render.height = $sprite.$cache.height;\n    $render._imgWidth = 0;\n    $render._imgHeight = 0;\n\n    if (_img && _img.width) {\n      $render._imgWidth = _img.width || 0;\n      $render._imgHeight = _img.height || 0;\n      $render.cutLeft = $sprite.$cache.cutLeft || 0;\n      $render.cutTop = $sprite.$cache.cutTop || 0;\n      $render.cutWidth = $sprite.$cache.cutWidth || $render._imgWidth;\n      $render.cutHeight = $sprite.$cache.cutHeight || $render._imgHeight; // 太小的图其实应该不取整，以免“高1像素的图，在cutLeft和cutWidth均为0.5的情况下渲染不出来”\n\n      $render.cutLeft = Math.round($render.cutLeft);\n      $render.cutTop = Math.round($render.cutTop);\n      $render.cutWidth = Math.round($render.cutWidth);\n      $render.cutHeight = Math.round($render.cutHeight);\n      $render.width = $render.width || $render.cutWidth || 0;\n      $render.height = $render.height || $render.cutHeight || 0;\n    }\n\n    if ($render.locate === 'lt') {} else if ($render.locate === 'ld') {\n      $render.top -= $render.height;\n    } else if ($render.locate === 'rt') {\n      $render.left -= $render.width;\n    } else if ($render.locate === 'rd') {\n      $render.left -= $render.width;\n      $render.top -= $render.height;\n    } else {\n      // center\n      $render.left -= $render.width >> 1;\n      $render.top -= $render.height >> 1;\n    } // 不能干掉，否则combine的时候可能模糊\n\n\n    $render.left = Math.round($render.left);\n    $render.top = Math.round($render.top);\n    $render.width = Math.round($render.width);\n    $render.height = Math.round($render.height);\n    var settings = $render.settings = {};\n    settings.globalAlpha = _utils[\"default\"].firstValuable($render.opacity, 1);\n\n    if ($render.childrenInside) {\n      settings.clip = true;\n    }\n\n    if ($sprite.$cache.scale !== 1) {\n      var scale = $render.scale;\n      var scaledParent = getScaledParent($sprite);\n\n      if (scaledParent) {\n        var scaleCenterX = scaledParent.$render.left + scaledParent.$render.width / 2;\n        var scaleCenterY = scaledParent.$render.top + scaledParent.$render.height / 2;\n        $render.left -= (scaleCenterX - $render.left) * (scale - 1);\n        $render.top -= (scaleCenterY - $render.top) * (scale - 1);\n        $render.width *= scale;\n        $render.height *= scale;\n      }\n    }\n\n    if ($render.fh || $render.fv) {\n      $render.fh = $render.fh || 0;\n      $render.fv = $render.fv || 0;\n      $render.fx = $render.fx || 0;\n      $render.fy = $render.fy || 0;\n      settings.transform = {\n        fh: $render.fh,\n        fv: $render.fv,\n        fx: -($render.top + ($render.height >> 1)) * $render.fv + $render.fx,\n        fy: -($render.left + ($render.width >> 1)) * $render.fh + $render.fy\n      };\n    }\n\n    if ($render.blend) {\n      if (typeof $render.blend === 'string') {\n        settings.globalCompositeOperation = $render.blend;\n      } else {\n        settings.globalCompositeOperation = blend[$render.blend];\n      }\n    }\n\n    if ($render.backgroundColor) {\n      settings.fillRect = $render.backgroundColor;\n    }\n\n    if ($render.borderWidth) {\n      settings.line = $render.borderWidth;\n    }\n\n    if ($render.mirrX) {\n      settings.translate = [$canvas.width, 0];\n      settings.scale = [-1, 1];\n      $render.left = $canvas.width - $render.left - $render.width;\n\n      if ($render.mirrY) {\n        settings.translate = [$canvas.width, $canvas.height];\n        settings.scale = [-1, -1];\n        $render.top = $canvas.height - $render.top - $render.height;\n      }\n    } else if ($render.mirrY) {\n      settings.translate = [0, $canvas.height];\n      settings.scale = [1, -1];\n      $render.top = $canvas.height - $render.top - $render.height;\n    }\n\n    if ($render.rotate) {\n      // 定点旋转\n      $render.rx = _utils[\"default\"].firstValuable(_utils[\"default\"].funcOrValue($sprite.$cache.rotateOriginLeft, $sprite), $render.left + 0.5 * $render.width);\n      $render.ry = _utils[\"default\"].firstValuable(_utils[\"default\"].funcOrValue($sprite.$cache.rotateOriginTop, $sprite), $render.top + 0.5 * $render.height);\n\n      var transX = _utils[\"default\"].firstValuable($render.rx, $render.left + 0.5 * $render.width);\n\n      var transY = _utils[\"default\"].firstValuable($render.ry, $render.top + 0.5 * $render.height);\n\n      settings.beforeRotate = [transX, transY];\n      settings.rotate = -$render.rotate * Math.PI / 180;\n      settings.rotate = Number(settings.rotate.toFixed(4));\n      settings.afterRotate = [-transX, -transY];\n    }\n\n    if ($sprite.$canvas) {\n      if (!$render.borderWidth) {\n        $render.$insight = (0, _math[\"default\"])($render.left, $render.top, $render.width, $render.height, 0, 0, $sprite.$canvas.width, $sprite.$canvas.height, settings.beforeRotate && settings.beforeRotate[0], settings.beforeRotate && settings.beforeRotate[1], $render.rotate);\n      } else {\n        $render.$insight = (0, _math[\"default\"])($render.left - $render.borderWidth, $render.top - $render.borderWidth, $render.width + $render.borderWidth * 2, $render.height + $render.borderWidth * 2, 0, 0, $sprite.$canvas.width, $sprite.$canvas.height, settings.beforeRotate && settings.beforeRotate[0], settings.beforeRotate && settings.beforeRotate[1], $render.rotate);\n      }\n    }\n  }\n\n  $sprite.children.forEach(function ($child) {\n    $child.recalculate(force);\n  });\n};\n\n//# sourceURL=webpack:///./src/class/api.recalculate.js?");

/***/ }),

/***/ "./src/class/api.removeEventListener.js":
/*!**********************************************!*\
  !*** ./src/class/api.removeEventListener.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Remove current event\n *\n * ********** **/\nmodule.exports = function (event, func) {\n  if (!this.events[event]) return;\n\n  if (this.events[event] === func || this.events[event].$handle === func || !func) {\n    delete this.events[event];\n  } else if (_utils[\"default\"].isArray(this.events[event])) {\n    if (this.events[event].indexOf(func) >= 0) {\n      this.events[event][this.events[event].indexOf(func)] = undefined;\n    } else if (this.events[event].indexOf(func.$handle) >= 0) {\n      this.events[event][this.events[event].indexOf(func.$handle)] = undefined;\n    }\n  }\n};\n\n//# sourceURL=webpack:///./src/class/api.removeEventListener.js?");

/***/ }),

/***/ "./src/class/api.trigger.js":
/*!**********************************!*\
  !*** ./src/class/api.trigger.js ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Trigger event on current sprite without its children\n * - Current sprite first, children following.\n * - Can pass arguments.\n *\n * ********** **/\nmodule.exports = function () {\n  var arg = Array.prototype.slice.call(arguments);\n  var name = arg.shift();\n\n  if (this.hooks[name]) {\n    return _utils[\"default\"].execFuncs(this.hooks[name], this, arg); // this.hooks[name].apply(this, arg);\n  }\n};\n\n//# sourceURL=webpack:///./src/class/api.trigger.js?");

/***/ }),

/***/ "./src/class/api.uncombine.js":
/*!************************************!*\
  !*** ./src/class/api.uncombine.js ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _constants = _interopRequireDefault(__webpack_require__(/*! constants */ \"./constants.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nmodule.exports = function () {\n  var _this = this;\n\n  this.off('ticked', this.combine);\n  if (!this.$combine) return;\n\n  if (this.$combine === 9) {\n    this.$combine = false;\n    return;\n  }\n\n  this.content = this.$combine.content;\n  this.children = this.$combine.children;\n  Object.keys(this.style).forEach(function (key) {\n    _this.style[key] = undefined;\n  });\n  Object.keys(this.$combine.style).forEach(function (key) {\n    _this.style[key] = _this.$combine.style[key];\n  });\n  this.$combine = false;\n  this.recalculate(true);\n};\n\n//# sourceURL=webpack:///./src/class/api.uncombine.js?");

/***/ }),

/***/ "./src/class/extend.js":
/*!*****************************!*\
  !*** ./src/class/extend.js ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = _default;\n\nvar _sprite = _interopRequireDefault(__webpack_require__(/*! ./sprite.js */ \"./src/class/sprite.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _default(pluginHook) {\n  var $extendList = _sprite[\"default\"].prototype.$extendList;\n  if ($extendList.indexOf(pluginHook) >= 0) return;\n  $extendList.push(pluginHook);\n}\n\n;\n\n//# sourceURL=webpack:///./src/class/extend.js?");

/***/ }),

/***/ "./src/class/sprite.js":
/*!*****************************!*\
  !*** ./src/class/sprite.js ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nvar _constants = _interopRequireDefault(__webpack_require__(/*! constants */ \"./constants.js\"));\n\nvar _apiOn = _interopRequireDefault(__webpack_require__(/*! ./api.on.js */ \"./src/class/api.on.js\"));\n\nvar _apiOff = _interopRequireDefault(__webpack_require__(/*! ./api.off.js */ \"./src/class/api.off.js\"));\n\nvar _apiAddEventListener = _interopRequireDefault(__webpack_require__(/*! ./api.addEventListener.js */ \"./src/class/api.addEventListener.js\"));\n\nvar _apiRemoveEventListener = _interopRequireDefault(__webpack_require__(/*! ./api.removeEventListener.js */ \"./src/class/api.removeEventListener.js\"));\n\nvar _clear = _interopRequireDefault(__webpack_require__(/*! ../painter/apiOuter/clear.js */ \"./src/painter/apiOuter/clear.js\"));\n\nvar _nextTick = _interopRequireDefault(__webpack_require__(/*! ../painter/apiOuter/nextTick.js */ \"./src/painter/apiOuter/nextTick.js\"));\n\nvar _apiTrigger = _interopRequireDefault(__webpack_require__(/*! ./api.trigger.js */ \"./src/class/api.trigger.js\"));\n\nvar _apiBroadcast = _interopRequireDefault(__webpack_require__(/*! ./api.broadcast.js */ \"./src/class/api.broadcast.js\"));\n\nvar _apiDistribute = _interopRequireDefault(__webpack_require__(/*! ./api.distribute.js */ \"./src/class/api.distribute.js\"));\n\nvar _apiGetOuterRect = _interopRequireDefault(__webpack_require__(/*! ./api.getOuterRect.js */ \"./src/class/api.getOuterRect.js\"));\n\nvar _apiCombine = _interopRequireDefault(__webpack_require__(/*! ./api.combine.js */ \"./src/class/api.combine.js\"));\n\nvar _apiUncombine = _interopRequireDefault(__webpack_require__(/*! ./api.uncombine.js */ \"./src/class/api.uncombine.js\"));\n\nvar _apiRecalculate = _interopRequireDefault(__webpack_require__(/*! ./api.recalculate.js */ \"./src/class/api.recalculate.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar COMBINE_ING = 9;\n\nfunction flat(arr) {\n  var depth = isNaN(arguments[1]) ? 1 : Number(arguments[1]);\n  return depth ? Array.prototype.reduce.call(arr, function (acc, cur) {\n    if (Array.isArray(cur)) {\n      acc.push.apply(acc, flat(cur, depth - 1));\n    } else {\n      acc.push(cur);\n    }\n\n    return acc;\n  }, []) : Array.prototype.slice.call(arr);\n} // 记录sprite创建的顺序，用于调试工具的排序\n\n\nvar $addIndex = 0;\n\nvar ChangeChildrenToSprite = function ChangeChildrenToSprite($parent) {\n  if ($parent.children) {\n    if (true) {\n      if ($parent.children && !Array.isArray($parent.children)) {\n        console.error(\"[Easycanvas] Children is not an array\", $parent.children);\n      }\n    }\n\n    $parent.children.forEach(function (child, i) {\n      if (!child.$id) {\n        $parent.children[i] = new sprite(child);\n      }\n\n      if ($parent.$id && !$parent.$dom) {\n        $parent.children[i].$canvas = $parent.$canvas;\n        $parent.children[i].$parent = $parent;\n      } else {\n        $parent.children[i].$canvas = $parent;\n      } // if (typeof $parent.children[i].content.img === 'string') {\n      //     $parent.children[i].content.img = $parent.children[i].$canvas.imgLoader($parent.children[i].content.img);\n      // }\n\n\n      ChangeChildrenToSprite($parent.children[i]);\n    });\n  }\n}; // Set default values to sprite\n\n\nvar preAdd = function preAdd(_item, $instance) {\n  var item = _item || {};\n\n  if (!item.$id) {\n    item.$id = Math.random().toString(36).substr(2);\n  }\n\n  item.$tickedTimes = item.$tickedTimes || 0;\n  item.content = item.content || {};\n  item.style = item.style || {};\n  item.style.scale = _utils[\"default\"].firstValuable(item.style.scale, 1);\n  item.style.opacity = _utils[\"default\"].firstValuable(item.style.opacity, 1);\n  item.style.borderWidth = _utils[\"default\"].firstValuable(item.style.borderWidth, 0);\n  item.style.zIndex = item.style.zIndex || 0; // item.style.mirrX = item.style.mirrX || 0;\n\n  item.style.locate = item.style.locate || 'center'; // item.style.rotate = item.style.rotate || 0;\n  // let _img = utils.funcOrValue(item.content.img);\n\n  $instance.$cache = {}; // 当前最终style\n\n  $instance.$render = {}; // 当前渲染style\n\n  $instance.$style = {}; // 当前自身style\n\n  $instance.$needUpdate = {};\n  item.hooks = item.hooks || {};\n\n  _constants[\"default\"].styles.concat(['visible']).forEach(function (key) {\n    $instance.$cache[key] = undefined;\n    $instance.$style[key] = item.style[key];\n\n    if (typeof item.style[key] === 'function') {\n      $instance.$style[key] = item.style[key].bind($instance);\n    }\n\n    if (_constants[\"default\"].xywh.indexOf(key) > -1) {\n      $instance.$style[key] = $instance.$style[key] || 0;\n    } else if (['opacity', 'scale'].indexOf(key) > -1) {\n      $instance.$style[key] = _utils[\"default\"].firstValuable($instance.$style[key], 1);\n    }\n\n    $instance.$needUpdate[key] = 1;\n    Object.defineProperty(item.style, key, {\n      get: function get() {\n        return $instance.$style[key];\n      },\n      set: function set(v) {\n        if ($instance.$style[key] === v) return;\n        $instance.$style[key] = v;\n        $instance.$needUpdate[key] = 1;\n      }\n    });\n  }); // ['img', 'text'].forEach((key) => {\n  //     $instance.$cache[key] = undefined;\n  //     $instance.$style[key] = item.content[key];\n  //     $instance.$needUpdate = true;\n  //     let lastSelfValue;\n  //     let needRecalculate = true;\n  //     if (typeof item.content[key] === 'function') {\n  //         $instance.$style[key] = item.content[key].bind($instance);\n  //     }\n  //     Object.defineProperty(item.content, key, {\n  //         get () {\n  //             return $instance.$style[key];\n  //         },\n  //         set (v) {\n  //             if ($instance.$style[key] === v) return;\n  //             $instance.$style[key] = v;\n  //             $instance.$needUpdate = true;\n  //         },\n  //     });\n  // });\n\n\n  item.events = item.events || {};\n\n  if (true) {\n    for (var i in item.events) {\n      if (typeof item.events[i] !== 'function' && i !== 'eIndex') {\n        console.warn(\"[Easycanvas] Handler \".concat(i, \" is not a function.\"), item.events[i]);\n      }\n    }\n  }\n\n  if (true) {\n    item.$addIndex = $addIndex++;\n  } // item.events.eIndex = item.events.eIndex;\n\n\n  if (true) {\n    item.$perf = {};\n  }\n\n  if (true) {\n    if (!item.name && item.content.img && item.content.img.src) {\n      var fileName = item.content.img.src.match(/.*\\/([^\\/]*)$/);\n\n      if (fileName && fileName[1]) {\n        item.name = fileName[1];\n      }\n    }\n\n    item.name = item.name || 'Unnamed Sprite';\n  }\n\n  item.children = item.children || []; // JSX可能有[[a,b],c]的数据结构\n\n  item.children = flat(item.children, Infinity);\n  ChangeChildrenToSprite(item);\n  item.$styleCacheTime = {};\n  return item;\n};\n\nvar extend = function extend(opt) {\n  var _this = this;\n\n  this.$extendList.forEach(function (plugin) {\n    plugin.call(_this, opt);\n  });\n};\n\nvar sprite = function sprite(opt) {\n  var _opt = preAdd(opt, this);\n\n  for (var i in _opt) {\n    if (Object.prototype.hasOwnProperty.call(_opt, i)) {\n      this[i] = _opt[i];\n    }\n  }\n\n  if (opt.ref) {\n    opt.ref(this);\n  }\n\n  extend.call(this, _opt);\n  return this;\n};\n\nsprite.prototype.$extendList = [];\n\nsprite.prototype.add = function (child) {\n  if (!child) {\n    return;\n  }\n\n  this.children.push(child);\n  ChangeChildrenToSprite(this);\n  return this.children[this.children.length - 1];\n};\n\nsprite.prototype.getImage = function () {\n  var img = _utils[\"default\"].funcOrValue(this.content.img, this);\n\n  if (typeof img === 'string' && this.$canvas) {\n    return this.$canvas.imgLoader(img);\n  }\n\n  return img;\n};\n\nsprite.prototype.getRect = function (notImg, fromCache) {\n  var _this2 = this;\n\n  var res = {};\n\n  _constants[\"default\"].txywh.forEach(function (key) {\n    res[key] = _this2.getStyle(key, fromCache);\n  });\n\n  if (res.width === 0 && this.content.img && !notImg) {\n    var img = _utils[\"default\"].funcOrValue(this.content.img, this);\n\n    res.width = img.width;\n    res.height = img.height;\n  }\n\n  var locate = this.getStyle('locate');\n\n  if (locate === 'lt') {} else if (locate === 'ld') {\n    res.top -= res.height;\n  } else if (locate === 'rt') {\n    res.left -= res.width;\n  } else if (locate === 'rd') {\n    res.left -= res.width;\n    res.top -= res.height;\n  } else {\n    // center\n    res.left -= res.width >> 1;\n    res.top -= res.height >> 1;\n  }\n\n  res.right = this.$canvas.width - res.left - res.width;\n  res.bottom = this.$canvas.height - res.top - res.height;\n  return res;\n}; // sprite.prototype.getRender = function () {\n//     if (!this.$canvas) return {};\n//     let res = this.$canvas.$children.filter(($children) => {\n//         return $children.$id === this.$id;\n//     });\n//     return res && res[0];\n// };\n\n\nsprite.prototype.getSelfStyle = function (key) {\n  if (key) {\n    return _utils[\"default\"].funcOrValue(this.style[key], this);\n  }\n\n  var res = {};\n\n  for (var _key in this.style) {\n    res[_key] = _utils[\"default\"].funcOrValue(this.style[_key], this);\n  }\n\n  return res;\n};\n\nsprite.prototype.getStyle = function (key, fromCache) {\n  var $sprite = this; // let lastPaintTime = $sprite.$canvas.$lastPaintTime;\n  // if ($sprite.$styleCacheTime[key] === lastPaintTime) {\n  //     return $sprite.$cache[key];\n  // }\n\n  if (fromCache && $sprite.$cache[key] !== undefined) {\n    return $sprite.$cache[key];\n  }\n\n  var currentValue = _utils[\"default\"].funcOrValue($sprite.$style[key], $sprite);\n\n  if ($sprite.$parent) {\n    var parentValue = $sprite.$parent.getStyle(key);\n\n    if (key === 'left' || key === 'top') {\n      parentValue = _utils[\"default\"].firstValuable(parentValue, 0); // $sprite.$parent.$styleCacheTime[key] = lastPaintTime;\n      // $sprite.$parent.$cache[key] = parentValue;\n\n      return parentValue + _utils[\"default\"].firstValuable(currentValue, 0);\n    } else if (key === 'scale' || key === 'opacity') {\n      parentValue = _utils[\"default\"].firstValuable(parentValue, 1); // $sprite.$parent.$styleCacheTime[key] = lastPaintTime;\n      // $sprite.$parent.$cache[key] = parentValue;\n\n      return parentValue * _utils[\"default\"].firstValuable(currentValue, 1);\n    } else if (key === 'visible') {\n      if (parentValue === false) return false; // $sprite.$parent.$styleCacheTime[key] = lastPaintTime;\n      // $sprite.$parent.$cache[key] = parentValue;\n\n      return currentValue;\n    }\n  }\n\n  return currentValue;\n};\n\nsprite.prototype.remove = function (child) {\n  if (child) {\n    this.$canvas.remove(child);\n\n    _utils[\"default\"].execFuncs(child.hooks.removed, child);\n\n    return;\n  }\n\n  if (this.$parent) {\n    this.$parent.remove(this);\n  } else {\n    this.$canvas.remove(this);\n  }\n\n  _utils[\"default\"].execFuncs(this.hooks.removed, this);\n};\n\nsprite.prototype.update = function (opt) {\n  if (!opt) return;\n\n  for (var i in opt) {\n    if (_typeof(opt[i]) === 'object') {\n      for (var j in opt[i]) {\n        if (!this[i]) {\n          this[i] = {};\n        }\n\n        this[i][j] = opt[i][j];\n      }\n    } else {\n      this[i] = opt[i];\n    }\n  }\n\n  if (this.$canvas) {\n    this.recalculate(true); // if painted, force update\n  }\n\n  return this;\n};\n\nsprite.prototype.getAllChildren = function (includeSelf) {\n  var $sprite = this;\n  var childrenSet = includeSelf ? [$sprite] : [];\n  $sprite.children.forEach(function (child) {\n    childrenSet = childrenSet.concat(child.getAllChildren(true));\n  });\n  return childrenSet;\n};\n\nsprite.prototype.getAllVisibleChildren = function (includeSelf) {\n  var $sprite = this;\n\n  if (_utils[\"default\"].funcOrValue($sprite.style.visible, $sprite) === false) {\n    return [];\n  }\n\n  var childrenSet = includeSelf ? [$sprite] : [];\n  $sprite.children.forEach(function (child) {\n    childrenSet = childrenSet.concat(child.getAllVisibleChildren(true));\n  });\n  return childrenSet;\n};\n\nsprite.prototype.getOuterRect = _apiGetOuterRect[\"default\"];\nsprite.prototype.combine = _apiCombine[\"default\"];\nsprite.prototype.uncombine = _apiUncombine[\"default\"];\n\nsprite.prototype.combineAsync = function () {\n  if (this.$combine) return this;\n  this.$combine = COMBINE_ING;\n  this.off('ticked', this.combine);\n  this.on('ticked', this.combine, 100);\n  return this;\n};\n\nsprite.prototype.recalculate = _apiRecalculate[\"default\"];\nsprite.prototype.nextTick = _nextTick[\"default\"];\nsprite.prototype.on = _apiOn[\"default\"];\nsprite.prototype.off = _apiOff[\"default\"];\nsprite.prototype.addEventListener = _apiAddEventListener[\"default\"];\nsprite.prototype.removeEventListener = _apiRemoveEventListener[\"default\"];\nsprite.prototype.clear = _clear[\"default\"];\nsprite.prototype.trigger = _apiTrigger[\"default\"];\nsprite.prototype.broadcast = _apiBroadcast[\"default\"];\nsprite.prototype.distribute = _apiDistribute[\"default\"];\nmodule.exports = sprite;\n\n//# sourceURL=webpack:///./src/class/sprite.js?");

/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"Painter\", {\n  enumerable: true,\n  get: function get() {\n    return _index[\"default\"];\n  }\n});\nObject.defineProperty(exports, \"tick\", {\n  enumerable: true,\n  get: function get() {\n    return _tick[\"default\"];\n  }\n});\nObject.defineProperty(exports, \"utils\", {\n  enumerable: true,\n  get: function get() {\n    return _utils[\"default\"];\n  }\n});\nObject.defineProperty(exports, \"Transition\", {\n  enumerable: true,\n  get: function get() {\n    return _transition[\"default\"];\n  }\n});\nObject.defineProperty(exports, \"ImgLoader\", {\n  enumerable: true,\n  get: function get() {\n    return _imgLoader[\"default\"];\n  }\n});\nObject.defineProperty(exports, \"ImgPretreat\", {\n  enumerable: true,\n  get: function get() {\n    return _imgPretreat[\"default\"];\n  }\n});\nObject.defineProperty(exports, \"extend\", {\n  enumerable: true,\n  get: function get() {\n    return _extend[\"default\"];\n  }\n});\nexports.Sprite = exports[\"default\"] = void 0;\n\nvar _constants = _interopRequireDefault(__webpack_require__(/*! constants */ \"./constants.js\"));\n\nvar _index = _interopRequireDefault(__webpack_require__(/*! ./painter/index.js */ \"./src/painter/index.js\"));\n\nvar _tick = _interopRequireDefault(__webpack_require__(/*! utils/tick.js */ \"./src/utils/tick.js\"));\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nvar _transition = _interopRequireDefault(__webpack_require__(/*! utils/transition.js */ \"./src/utils/transition.js\"));\n\nvar _imgLoader = _interopRequireDefault(__webpack_require__(/*! utils/img-loader.js */ \"./src/utils/img-loader.js\"));\n\nvar _imgPretreat = _interopRequireDefault(__webpack_require__(/*! utils/img-pretreat.js */ \"./src/utils/img-pretreat.js\"));\n\nvar _sprite = _interopRequireDefault(__webpack_require__(/*! ./class/sprite.js */ \"./src/class/sprite.js\"));\n\nvar _extend = _interopRequireDefault(__webpack_require__(/*! ./class/extend.js */ \"./src/class/extend.js\"));\n\n__webpack_require__(/*! ./bridge/chrome-devtool.js */ \"./src/bridge/chrome-devtool.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n// import mirror from 'utils/mirror.js';\n// const $version = constants.version;\nvar Sprite = _sprite[\"default\"];\nexports.Sprite = Sprite;\nvar Easycanvas = {\n  Painter: _index[\"default\"],\n  ImgLoader: _imgLoader[\"default\"],\n  ImgPretreat: _imgPretreat[\"default\"],\n  Transition: _transition[\"default\"],\n  tick: _tick[\"default\"],\n  utils: _utils[\"default\"],\n  extend: _extend[\"default\"],\n  // mirror,\n  // 兼容老版本写法“new Easycanvas.class.sprite(opt);”\n  \"class\": {\n    sprite: _sprite[\"default\"]\n  },\n  sprite: _sprite[\"default\"],\n  Sprite: Sprite,\n  // for JSX\n  createElement: function createElement(Component, props) {\n    var _props = props || {};\n\n    for (var _len = arguments.length, children = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      children[_key - 2] = arguments[_key];\n    }\n\n    _props.children = children || [];\n    return new Component(_props, Easycanvas);\n  }\n};\n\nEasycanvas.use = function (pluginHook) {\n  var $extendList = Easycanvas.Painter.prototype.$extendList;\n  if ($extendList.indexOf(pluginHook) >= 0) return;\n\n  if (pluginHook.onUse) {\n    pluginHook.onUse(Easycanvas);\n  }\n\n  $extendList.push(pluginHook);\n};\n\nvar inBrowser = typeof window !== 'undefined';\n\nif (inBrowser) {\n  // if (process.env.UMD === 'true') {\n  if (window.Easycanvas) {\n    console.warn('[Easycanvas] already loaded, it should be loaded only once.');\n  } else {\n    if (true) {\n      setTimeout(function () {\n        console.log(\"%c Easycanvas %c You are using the develop version \".concat(_constants[\"default\"].version, \" %c\"), \"background:#4086f4; padding: 2px 0; border-radius: 2px 0 0 2px;  color: #fff\", \"background:#41b883; padding: 2px; border-radius: 0 2px 2px 0;  color: #fff\", \"background:transparent\");\n      }, 500);\n    }\n\n    window.Easycanvas = Easycanvas;\n  }\n}\n\nvar _default = Easycanvas;\nexports[\"default\"] = _default;\n\n//# sourceURL=webpack:///./src/index.js?");

/***/ }),

/***/ "./src/painter/apiInner.js":
/*!*********************************!*\
  !*** ./src/painter/apiInner.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _perPaint = _interopRequireDefault(__webpack_require__(/*! ./apiInner/perPaint.js */ \"./src/painter/apiInner/perPaint.js\"));\n\nvar _render = _interopRequireDefault(__webpack_require__(/*! ./apiInner/render.js */ \"./src/painter/apiInner/render.js\"));\n\nvar _eventHandler = _interopRequireDefault(__webpack_require__(/*! ./apiInner/eventHandler.js */ \"./src/painter/apiInner/eventHandler.js\"));\n\nvar _apiPlugin = _interopRequireDefault(__webpack_require__(/*! ./apiPlugin/apiPlugin.js */ \"./src/painter/apiPlugin/apiPlugin.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Inner apis of an easycanvas instance\n * - Used for Easycanvas.js only normally.\n * - Will be added to Easycanvas instance's prototype.\n *\n * ********** **/\nvar apiInner = {\n  $render: _render[\"default\"],\n  $eventHandler: _eventHandler[\"default\"],\n  $perPaint: _perPaint[\"default\"]\n};\n\nif (true) {\n  apiInner.$plugin = (0, _apiPlugin[\"default\"])();\n}\n\nmodule.exports = apiInner;\n\n//# sourceURL=webpack:///./src/painter/apiInner.js?");

/***/ }),

/***/ "./src/painter/apiInner/eventHandler.js":
/*!**********************************************!*\
  !*** ./src/painter/apiInner/eventHandler.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nvar _constants = _interopRequireDefault(__webpack_require__(/*! constants */ \"./constants.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Handle events on canvas (Includes both user's events and debugging events)\n * - Compare event's coordinate and the coordinate of every sprite in\n *   Easycanvas.children, and check sprite's handlers one by one.\n * - Events: 'contextmenu', 'mousewheel', 'click', 'dblclick', 'mousedown',\n *   'mouseup', 'mousemove', 'touchstart', 'touchend', 'touchmove'\n * - Expanded events: touchout(deprecated)\n *\n * ********** **/\nvar isMobile = typeof wx !== 'undefined' || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n/**\n * Sort sprite\n * - Order by eIndex dev-tool's in events' triggering\n * - Order by zIndex in dev-tool's select mode\n */\n\nvar sortByIndex = function sortByIndex(arr) {\n  return arr.sort(function (a, b) {\n    if (true) {\n      if (window[_constants[\"default\"].devFlag] && window[_constants[\"default\"].devFlag].selectMode) {\n        return _utils[\"default\"].funcOrValue(a.style.zIndex, a) < _utils[\"default\"].funcOrValue(b.style.zIndex, b) ? 1 : -1;\n      }\n    }\n\n    return _utils[\"default\"].funcOrValue(_utils[\"default\"].firstValuable(a.events.eIndex, a.style.zIndex), a) < _utils[\"default\"].funcOrValue(_utils[\"default\"].firstValuable(b.events.eIndex, b.style.zIndex), b) ? 1 : -1;\n  });\n};\n/**\n * Check whether the event hits certain sprite\n */\n\n\nvar hitSprite = function hitSprite($sprite, e) {\n  var rect = $sprite.getRect();\n  return _utils[\"default\"].pointInRect(e.canvasX, e.canvasY, rect.left, rect.left + rect.width, rect.top, rect.top + rect.height);\n};\n/**\n * Sort all the sprites(including children), then put to @caughts\n * - Child is above the parent only if Index >= 0\n */\n\n\nvar looper = function looper(arr, e, caughts) {\n  if (!arr || !arr.length) return;\n  if (e.$stopPropagation) return;\n  var l = arr.length;\n\n  for (var i = 0; i < l; i++) {\n    var item = arr[i];\n    if (_utils[\"default\"].funcOrValue(item.style.visible, item) === false) continue;\n    if (item.events && item.events.pointerEvents === 'none') continue;\n\n    if (hitSprite(item, e)) {\n      var interceptor = item.events.interceptor;\n\n      if (true) {\n        if (window[_constants[\"default\"].devFlag] && window[_constants[\"default\"].devFlag].selectMode) {\n          // 选取Sprite时禁掉捕获，以免事件被阻止，导致无法选中\n          interceptor = false;\n        }\n      }\n\n      if (interceptor) {\n        // var result = utils.firstValuable(interceptor.call(item, e), e);\n        // if (!result || result.$stopPropagation) return;\n        _utils[\"default\"].execFuncs(interceptor, item, [e]);\n\n        if (e.$stopPropagation) return;\n      }\n    }\n\n    var children = item.$combine && item.$combine.children ? item.$combine.children : item.children;\n\n    if (true) {\n      if (window[_constants[\"default\"].devFlag] && window[_constants[\"default\"].devFlag].selectMode) {\n        // 选取Sprite时不选取内部Sprite\n        children = item.children;\n      }\n    }\n\n    if (children.length) {\n      // Children above\n      looper(sortByIndex(children.filter(function (a) {\n        if (true) {\n          if (window[_constants[\"default\"].devFlag] && window[_constants[\"default\"].devFlag].selectMode) {\n            return _utils[\"default\"].funcOrValue(a.style.zIndex, a) >= 0;\n          }\n        }\n\n        return _utils[\"default\"].funcOrValue(_utils[\"default\"].firstValuable(a.events.eIndex, a.style.zIndex), a) >= 0;\n      })), e, caughts);\n    }\n\n    if (e.$stopPropagation) break;\n\n    if (hitSprite(item, e)) {\n      if (true) {\n        // 开发者工具select模式下为选取元素\n        if (window[_constants[\"default\"].devFlag] && window[_constants[\"default\"].devFlag].selectMode) {\n          if (item.name !== _constants[\"default\"].devFlag) {\n            e.stopPropagation();\n\n            if (item.$canvas.$plugin.selectSprite(e.type === 'click' || e.type === 'touchend', item.$canvas, item)) {\n              return;\n            }\n          }\n\n          continue;\n        }\n      }\n\n      triggerEventOnSprite(item, e, caughts);\n      e.stopPropagation();\n      return;\n    }\n\n    if (children.length) {\n      // Children below\n      looper(sortByIndex(children.filter(function (a) {\n        if (true) {\n          if (window[_constants[\"default\"].devFlag] && window[_constants[\"default\"].devFlag].selectMode) {\n            return _utils[\"default\"].funcOrValue(a.style.zIndex, a) < 0;\n          }\n        }\n\n        return !(_utils[\"default\"].funcOrValue(_utils[\"default\"].firstValuable(a.events.eIndex, a.style.zIndex), a) >= 0);\n      })), e, caughts);\n    }\n  }\n};\n\nvar extend = function extend($e, caughts) {\n  var _this = this;\n\n  this.$extendList.forEach(function (plugin) {\n    if (plugin.onEvent) {\n      plugin.onEvent.call(_this, $e, caughts);\n    }\n  });\n};\n\nvar triggerEventOnSprite = function triggerEventOnSprite($sprite, $e, caughts) {\n  caughts && caughts.push($sprite);\n\n  if ($sprite.events[$e.type]) {\n    _utils[\"default\"].execFuncs($sprite.events[$e.type], $sprite, [$e]); // $sprite.events[$e.type].call($sprite, $e);\n\n\n    if ($e.$stopPropagation) return;\n  }\n\n  if ($sprite.$parent) {\n    triggerEventOnSprite($sprite.$parent, $e, caughts);\n  } else {\n    if ($sprite.$canvas && !$e.$stopPropagation) {\n      triggerEventOnSprite($sprite.$canvas, $e);\n      $e.stopPropagation();\n    }\n  }\n};\n\nvar fastclick = {\n  x: 0,\n  y: 0,\n  timeStamp: 0\n};\n\nvar _eventHandler;\n\n_eventHandler = function eventHandler(e, _$e) {\n  var $canvas = this;\n  var layerX;\n  var layerY;\n  var scaleX = 1;\n  var scaleY = 1;\n\n  if (!_$e) {\n    if (!e.layerX && e.targetTouches && e.targetTouches[0]) {\n      layerX = e.targetTouches[0].pageX - e.currentTarget.offsetLeft;\n      layerY = e.targetTouches[0].pageY - e.currentTarget.offsetTop;\n    } else if (!e.layerX && e.changedTouches && e.changedTouches[0]) {\n      layerX = e.changedTouches[0].pageX - e.currentTarget.offsetLeft;\n      layerY = e.changedTouches[0].pageY - e.currentTarget.offsetTop;\n    } else {\n      layerX = e.layerX;\n      layerY = e.layerY;\n    }\n\n    var isRotated = false; // TODO\n\n    if (this.$dom.getBoundingClientRect) {\n      var bcr = this.$dom.getBoundingClientRect();\n      bcr.width > bcr.height !== this.width > this.height;\n      scaleX = Math.floor(bcr[isRotated ? 'height' : 'width']) / this.width;\n      scaleY = Math.floor(bcr[isRotated ? 'width' : 'height']) / this.height;\n    }\n  }\n\n  var $e = _$e || {\n    type: e.type,\n    canvasX: layerX / scaleX,\n    canvasY: layerY / scaleY,\n    event: e\n  };\n\n  if (isMobile && $canvas.fastclick) {\n    if ($e.type === 'click' && !$e.$fakeClick) {\n      return;\n    } else if ($e.type === 'touchstart') {\n      fastclick.x = $e.canvasX;\n      fastclick.y = $e.canvasY;\n      fastclick.timeStamp = Date.now();\n    } else if ($e.type === 'touchend') {\n      if (Math.abs(fastclick.x - $e.canvasX) < 30 && Math.abs(fastclick.y - $e.canvasY) < 30 && Date.now() - fastclick.timeStamp < 200) {\n        _eventHandler.call(this, null, {\n          $fakeClick: true,\n          type: 'click',\n          canvasX: fastclick.x,\n          canvasY: fastclick.y,\n          event: e\n        });\n      }\n    }\n  }\n\n  $e.stopPropagation = function () {\n    $e.$stopPropagation = true;\n  };\n\n  $e.preventDefault = function () {\n    $e.event.preventDefault();\n  };\n\n  if ($canvas.events.interceptor) {\n    // $e = utils.firstValuable($canvas.events.interceptor.call($canvas, $e), $e);\n    // if (!$e || $e.$stopPropagation) return;\n    _utils[\"default\"].execFuncs($canvas.events.interceptor, $canvas, [$e]);\n\n    if (e.$stopPropagation) return;\n  }\n\n  var caughts = [];\n  looper(sortByIndex($canvas.children), $e, caughts); // utils.execFuncs($canvas.hooks.afterEvent, $canvas, $e);\n  // $canvas.hooks.afterEvent = null;\n\n  extend.call($canvas, $e, caughts); // Create a new event: 'hold' (suits both mobile and pc)\n  // if (!$canvas.eHoldingFlag && ($e.type === 'mousedown' || $e.type === 'touchstart')) {\n  //     $canvas.eHoldingFlag = $e;\n  // } else if ($canvas.eHoldingFlag && ($e.type === 'mouseup' || $e.type === 'touchend')) {\n  //     $canvas.eHoldingFlag = false;\n  // } else if ($canvas.eHoldingFlag && ($e.type === 'mousemove' || $e.type === 'touchmove')) {\n  //     $canvas.eHoldingFlag = $e;\n  // }// else if (!$canvas.eHoldingFlag && e.type === 'contextmenu') {\n  // trigger 'mouseout' or 'touchout' event \n\n  if (($e.type === 'mousemove' || $e.type === 'touchmove') && $canvas.eLastMouseHover && caughts.indexOf($canvas.eLastMouseHover) === -1) {\n    // touchout待移除（目前可能不触发）\n    var eMouseout = $canvas.eLastMouseHover['events']['mouseout'] || $canvas.eLastMouseHover['events']['touchout'];\n\n    if (eMouseout) {\n      eMouseout.call($canvas.eLastMouseHover, $e);\n    }\n  }\n\n  $canvas.eLastMouseHover = caughts[0];\n\n  if (!caughts.length && $canvas.eLastMouseHover) {\n    // hover更替，触发mouseout\n    var _eMouseout = $canvas.eLastMouseHover['events']['mouseout'];\n\n    if (_eMouseout) {\n      _eMouseout.call($canvas.eLastMouseHover, $e);\n    }\n\n    $canvas.eLastMouseHover = null;\n  }\n\n  var handler = $canvas.events[$e.type];\n\n  if (handler && !$e.$stopPropagation) {\n    _utils[\"default\"].execFuncs(handler, $canvas, [$e]); // if (handler.call($canvas, $e)) {\n    //     $canvas.eHoldingFlag = false;\n    //     return true;\n    // }\n\n  }\n};\n\nmodule.exports = _eventHandler;\n\n//# sourceURL=webpack:///./src/painter/apiInner/eventHandler.js?");

/***/ }),

/***/ "./src/painter/apiInner/perPaint.deliverChildren.js":
/*!**********************************************************!*\
  !*** ./src/painter/apiInner/perPaint.deliverChildren.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Send children to be painted\n * - Children will be rendered above the parent, if zIndex >= 0\n * - Even the same zIndex, chilren will be render in differrent orders\n *   in different environments, like Chrome and PhantomJs.\n *\n * ********** **/\nmodule.exports = function ($canvas, children, part) {\n  children.filter(function (item) {\n    var zIndex = _utils[\"default\"].funcOrValue(item.style.zIndex, item);\n\n    if (part < 0) {\n      return zIndex < 0;\n    }\n\n    return zIndex >= 0;\n  }).sort(function (a, b) {\n    var za = _utils[\"default\"].funcOrValue(a.style.zIndex, a);\n\n    var zb = _utils[\"default\"].funcOrValue(b.style.zIndex, b); // let za = a.style.zIndex;\n    // let zb = b.style.zIndex;\n\n\n    if (za === zb) return 0;\n    return za > zb ? 1 : -1;\n  }).forEach(function (c, _index) {\n    $canvas.$perPaint.call($canvas, c, _index);\n  });\n};\n\n//# sourceURL=webpack:///./src/painter/apiInner/perPaint.deliverChildren.js?");

/***/ }),

/***/ "./src/painter/apiInner/perPaint.js":
/*!******************************************!*\
  !*** ./src/painter/apiInner/perPaint.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nvar _perPaintDeliverChildren = _interopRequireDefault(__webpack_require__(/*! ./perPaint.deliverChildren.js */ \"./src/painter/apiInner/perPaint.deliverChildren.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * CORE painting function\n * - Calculates props of every sprite in children, then puts to $children.\n * - Includes optimization.\n * - NOT connecting to canvas's prototype functions.\n *\n * ********** **/\nvar extend = function extend() {\n  var _this = this;\n\n  this.$canvas.$extendList.forEach(function (plugin) {\n    if (plugin.onPaint) {\n      plugin.onPaint.call(_this);\n    }\n  });\n};\n\nmodule.exports = function ($sprite, index) {\n  $sprite.$rendered = false;\n\n  if ($sprite.$cache.visible === false) {\n    // utils.execFuncs($sprite.hooks.ticked, $sprite, ++$sprite.$tickedTimes);\n    return;\n  }\n\n  var $canvas = this;\n  extend.call($sprite);\n  var _props = $sprite.$render;\n  var _text = _props.text;\n  var _img = _props.img;\n  var childrenInside = _props.childrenInside; // 容器提前结束\n\n  if (!_props.settings || !_img && !_text && !_props.settings.rotate && !_props.backgroundColor && !_props.borderWidth && !childrenInside) {\n    $sprite.$rendered = undefined;\n    var _children2 = $sprite.children;\n\n    if (_children2.length) {\n      (0, _perPaintDeliverChildren[\"default\"])($canvas, _children2, -1);\n      (0, _perPaintDeliverChildren[\"default\"])($canvas, _children2, 1);\n    } // utils.execFuncs($sprite.hooks.ticked, $sprite, ++$sprite.$tickedTimes);\n\n\n    return;\n  }\n\n  var _children = $sprite.children;\n  var settings = _props.settings;\n  /*\n   * 性能浪费检测\n   * 拿到最大的“绘制/源尺寸”比值，如果这个值过低，那么显然存在资源浪费\n   * 由于对象可能处于动画中，因此选用最大的绘制比\n   */\n  // if (process.env.NODE_ENV !== 'production') {\n  //     if (_props._imgWidth && _props._imgHeight) {\n  //         let paintRate = _props.width * _props.height / (_props.height * _props.cutHeight);\n  //         if (!$sprite.$perf.paintRate || paintRate > $sprite.$perf.paintRate) {\n  //             $sprite.$perf.paintRate = paintRate;\n  //             // $sprite.$perf.paintProps = JSON.stringify(_props);\n  //         }\n  //     }\n  // }\n  // if (process.env.NODE_ENV !== 'production') {\n  //     if (!$sprite.$cache.base64 && _img && _img.src) {\n  //         $sprite.$cache.base64 = 'processing';\n  //         img2base64(_img.src, function (data) {\n  //             $sprite.$cache.base64 = data;\n  //         });\n  //     }\n  // }\n\n  if (settings.rotate) {\n    var $paintSprite = {\n      $id: $sprite.$id,\n      type: 'rotateStart',\n      settings: settings,\n      props: _props\n    }; // if (process.env.NODE_ENV !== 'production') {\n    //     // 开发环境下，将元素挂载到$children里以供标记\n\n    $paintSprite.$origin = $sprite; // };\n\n    $canvas.$children.push($paintSprite);\n  }\n\n  if (settings.clip) {\n    var _$paintSprite = {\n      $id: $sprite.$id,\n      type: 'clip',\n      // settings: settings,\n      props: _props\n    }; // if (process.env.NODE_ENV !== 'production') {\n    //     // 开发环境下，将元素挂载到$children里以供标记\n\n    _$paintSprite.$origin = $sprite; // };\n\n    $canvas.$children.push(_$paintSprite);\n  }\n\n  _children.length && (0, _perPaintDeliverChildren[\"default\"])($canvas, _children, -1);\n\n  if (settings.fillRect) {\n    $sprite.$rendered = true;\n    var _$paintSprite2 = {\n      $id: $sprite.$id,\n      type: 'fillRect',\n      settings: settings,\n      props: _props\n    }; // if (process.env.NODE_ENV !== 'production') {\n    //     // 开发环境下，将元素挂载到$children里以供标记\n\n    _$paintSprite2.$origin = $sprite; // };\n\n    $canvas.$children.push(_$paintSprite2);\n  }\n\n  if (_props._imgWidth && _props.opacity !== 0 && _props.cutWidth && _props.cutHeight) {\n    // if (!_props.rotate && !_text) {\n    // cutOutside($canvas, _props, _imgWidth, _imgHeight);\n    // cut的结果没有取整，要看是否需要\n    // }\n    $sprite.$rendered = true;\n    var _$paintSprite3 = {\n      $id: $sprite.$id,\n      type: 'img',\n      settings: settings,\n      img: _img,\n      props: _props\n    }; // _img.$painted = true;\n    // if (process.env.NODE_ENV !== 'production') {\n    //     // 开发环境下，将元素挂载到$children里以供标记\n\n    _$paintSprite3.$origin = $sprite; // };\n\n    $canvas.$children.push(_$paintSprite3);\n  } // TODO: rewrite\n\n\n  if (_text) {\n    _props.fontSize = $sprite.$cache.fontSize;\n    _props.fontFamily = $sprite.$cache.fontFamily;\n    _props.color = $sprite.$cache.color;\n    _props.textAlign = $sprite.$cache.textAlign;\n    _props.textVerticalAlign = $sprite.$cache.textVerticalAlign;\n    $sprite.$rendered = true;\n    var textLeft = _props.left;\n    var textTop = _props.top;\n    var textAlign = _props.align || _props.textAlign || 'left';\n    var textFont = (_props.fontSize || 14) + 'px ' + (_props.fontFamily || 'serif');\n    var textFontsize = parseInt(textFont);\n    var textBaseline = 'top'; // Change css-align to canvas-align style\n\n    if (textAlign === 'center') {\n      textLeft += _props.width / 2;\n    } else if (textAlign === 'right') {\n      textLeft += _props.width;\n    } // Change css-align to canvas-align style\n\n\n    if (_props.textVerticalAlign === 'top') {\n      textBaseline = 'top';\n    } else if (_props.textVerticalAlign === 'bottom') {\n      textBaseline = 'bottom';\n      textTop += _props.height;\n    } else if (_props.textVerticalAlign === 'middle') {\n      textTop += _props.height >> 1;\n      textBaseline = 'middle';\n    }\n\n    if (typeof _text === 'string' || typeof _text === 'number') {\n      // if (textTop + textFontsize * 2 > 0 && textTop - textFontsize * 2 < $canvas.height) {\n      $canvas.$children.push({\n        $id: $sprite.$id,\n        type: 'text',\n        settings: settings,\n        props: {\n          left: textLeft,\n          top: textTop,\n          content: String(_text),\n          fontsize: textFontsize,\n          align: textAlign,\n          baseline: textBaseline,\n          font: textFont,\n          color: _props.color,\n          type: _props.textToppe\n        },\n        $origin: $sprite\n      }); // }\n    } else if (_text.length) {\n      _text.forEach(function (t) {\n        $canvas.$children.push({\n          $id: $sprite.$id,\n          type: 'text',\n          settings: settings,\n          props: {\n            left: textLeft + _utils[\"default\"].funcOrValue(t.left, $sprite),\n            top: textTop + _utils[\"default\"].funcOrValue(t.top, $sprite),\n            content: _utils[\"default\"].funcOrValue(t.content, $sprite),\n            fontsize: textFontsize,\n            baseline: textBaseline,\n            align: textAlign,\n            font: textFont,\n            color: _props.color,\n            type: _props.textToppe\n          },\n          $origin: $sprite\n        });\n      });\n    }\n  }\n\n  if (!_img && !_text) {\n    $sprite.$rendered = undefined;\n  }\n\n  _children.length && (0, _perPaintDeliverChildren[\"default\"])($canvas, _children, 1);\n\n  if (settings.clip) {\n    var _$paintSprite4 = {\n      $id: $sprite.$id,\n      type: 'clipOver',\n      props: _props\n    }; // if (process.env.NODE_ENV !== 'production') {\n    //     // 开发环境下，将元素挂载到$children里以供标记\n\n    _$paintSprite4.$origin = $sprite; // };\n\n    $canvas.$children.push(_$paintSprite4);\n  }\n\n  if (settings.line) {\n    $sprite.$rendered = true;\n    var _$paintSprite5 = {\n      $id: $sprite.$id,\n      type: 'line',\n      settings: settings,\n      props: _props\n    }; // if (process.env.NODE_ENV !== 'production') {\n    //     // 开发环境下，将元素挂载到$children里以供标记\n\n    _$paintSprite5.$origin = $sprite; // };\n\n    $canvas.$children.push(_$paintSprite5);\n  }\n\n  if (settings.rotate) {\n    var _$paintSprite6 = {\n      $id: $sprite.$id,\n      type: 'rotateEnd',\n      settings: settings,\n      props: _props\n    }; // if (process.env.NODE_ENV !== 'production') {\n    //     // 开发环境下，将元素挂载到$children里以供标记\n\n    _$paintSprite6.$origin = $sprite; // };\n\n    $canvas.$children.push(_$paintSprite6);\n  }\n};\n\n//# sourceURL=webpack:///./src/painter/apiInner/perPaint.js?");

/***/ }),

/***/ "./src/painter/apiInner/render.js":
/*!****************************************!*\
  !*** ./src/painter/apiInner/render.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * CORE painting function\n * - Controlling canvas context, Transfer $children to rendered sprite.\n * - Includes some optimization.\n *\n * ********** **/\nvar extend = function extend($sprite, settings) {\n  var _this = this;\n\n  var stopDefault = false;\n  this.$extendList.forEach(function (plugin) {\n    if (plugin.onRender) {\n      var res = plugin.onRender.call(_this, $sprite, settings);\n\n      if (res) {\n        stopDefault = res;\n      }\n    }\n  });\n  return stopDefault;\n};\n\nmodule.exports = function (_ctx, _children, renderAll) {\n  var $canvas = this;\n  var $children = _children || $canvas.$children;\n\n  if (!renderAll && !$canvas.webgl) {\n    $children = $children.filter(function ($child) {\n      if ($child.type !== 'img') return true;\n      return $child.props.$insight !== false;\n    });\n  }\n\n  $children.forEach(function ($sprite, i) {\n    if (true) {\n      if ($sprite.$origin) {\n        // 先标记为true，绘制的时候改为false\n        $sprite.$origin.$useless = true;\n      }\n    }\n\n    var props = $sprite.props;\n    /*\n        Jump useless paintings, by calculating border size\n    */\n\n    var currentSize; // let isText = $sprite.type === 'text';\n    // 一些扩展插件的绘制可能没有props\n\n    if (props && $sprite.type !== 'clip' && $sprite.type !== 'rotateStart' && $sprite.type !== 'rotateEnd' && $sprite.type !== 'text' && $sprite.type !== 'clipOver' && $sprite.type !== 'line') {\n      // if (isText) {\n      //     let length = props.content.length;\n      //     currentSize = props.fontsize * props.fontsize * 9 * length;\n      //     props.left = props.left - props.fontsize * 1.5 * length;\n      //     if (props.left < 0) props.left = 0;\n      //     props.top = props.top - props.fontsize * 1.5;\n      //     if (props.top < 0) props.top = 0;\n      //     props.width = props.fontsize * 3 * length;\n      //     if (props.left + props.width > $canvas.width) props.width = $canvas.width - props.left;\n      //     props.height = props.fontsize * 3;\n      //     if (props.top + props.height > $canvas.height) props.height = $canvas.height - props.top;\n      // } else {\n      currentSize = props.width * props.height; // }\n      // 当前图层不太小的时候，判断是否可以跳过绘制\n\n      if (currentSize > 200 * 200 && !$sprite.settings.transform && !$sprite.settings.rotate) {\n        var l = $children.length;\n\n        for (var j = i + 1; j < l; j++) {\n          var $tmpSprite = $children[j];\n\n          if ($tmpSprite.$cannotCover) {\n            // 被判断为不能遮挡当前绘制的直接跳过\n            continue;\n          }\n\n          if ($tmpSprite.type === 'clip') {\n            // clip到clipOver之间的不进行判断\n            // 这些sprite可能无法遮挡当前要绘制的sprite\n            while (j < l && $children[++j].type !== 'clipOver') {// do nothing\n              // 仅仅是j自增1\n            }\n\n            continue;\n          }\n\n          var tmpSpriteSettings = $tmpSprite.settings;\n\n          if (!$tmpSprite.type || $tmpSprite.type !== 'img') {\n            // 不是图片\n            // 但fillRect可能还有透明度\n            if (!($tmpSprite.type === 'fillRect' && tmpSpriteSettings.fillRect.indexOf('rgba') === -1)) {\n              $tmpSprite.$cannotCover = true;\n              continue;\n            }\n          }\n\n          var tmpProps = $tmpSprite.props;\n\n          if (tmpProps.width * tmpProps.height < 200 * 200) {\n            // 太小的图片不认为可以遮挡\n            $tmpSprite.$cannotCover = true;\n            continue;\n          }\n\n          if (tmpProps.width * tmpProps.height < currentSize) {\n            continue;\n          }\n\n          if ($tmpSprite.img && !$tmpSprite.img.$noAlpha) {\n            // 带alpha通道的图片不会遮挡当前图片，不能跳过当前图片的绘制\n            $tmpSprite.$cannotCover = true;\n            continue;\n          } // 带rotate的元素暂时不考虑，需要复杂的计算\n\n\n          if (tmpSpriteSettings.globalAlpha !== 1 || tmpSpriteSettings.globalCompositeOperation || tmpSpriteSettings.transform || tmpSpriteSettings.rotate) {\n            $tmpSprite.$cannotCover = true;\n            continue;\n          }\n\n          if (_utils[\"default\"].pointInRect(props.left, props.top, tmpProps.left, tmpProps.left + tmpProps.width, tmpProps.top, tmpProps.top + tmpProps.height) && _utils[\"default\"].pointInRect(props.left + props.width, props.top + props.height, tmpProps.left, tmpProps.left + tmpProps.width, tmpProps.top, tmpProps.top + tmpProps.height)) {\n            if (true) {\n              $sprite.$origin.$useless = true; // props格式换了\n              // $canvas.$plugin.jumpRender($canvas, props);\n            } // console.log('useless');\n\n\n            return;\n          }\n        }\n      }\n    }\n\n    var settings = $sprite.settings || {};\n\n    if (extend.call($canvas, $sprite, settings)) {\n      return;\n    }\n\n    if (true) {\n      if ($sprite.$origin) {\n        $sprite.$origin.$useless = false;\n      }\n    }\n\n    var ctx = _ctx || $canvas.$paintContext;\n\n    if ($sprite.type === 'rotateStart') {\n      ctx.save();\n      ctx.translate(settings.beforeRotate[0] || 0, settings.beforeRotate[1] || 0);\n      ctx.rotate(settings.rotate || 0);\n      ctx.translate(settings.afterRotate[0] || 0, settings.afterRotate[1] || 0);\n    }\n\n    if ($sprite.type === 'clip') {\n      ctx.save(); // rect会导致FPS逐渐降低，怀疑未清理导致\n      // ctx.rect(props.left, props.ty, props.width, props.height);\n\n      ctx.beginPath();\n      ctx.moveTo(props.left, props.top);\n      ctx.lineTo(props.left + props.width, props.top);\n      ctx.lineTo(props.left + props.width, props.top + props.height);\n      ctx.lineTo(props.left, props.top + props.height);\n      ctx.lineTo(props.left, props.top);\n      ctx.closePath();\n      ctx.clip();\n    }\n    /*\n        Rendering operation\n    */\n\n\n    var saved = false;\n\n    if (settings.globalCompositeOperation) {\n      if (!saved) {\n        ctx.save();\n        saved = true;\n      }\n\n      ctx.globalCompositeOperation = settings.globalCompositeOperation;\n    }\n\n    if (ctx.$globalAlpha !== settings.globalAlpha) {\n      ctx.$globalAlpha = ctx.globalAlpha = settings.globalAlpha;\n    } // if (settings.globalAlpha !== 1 && !isNaN(settings.globalAlpha)) {\n    //     if (!saved) {\n    //         ctx.save();\n    //         saved = true;\n    //     }\n    //     ctx.globalAlpha = settings.globalAlpha;\n    // }\n\n\n    if (settings.translate) {\n      if (!saved) {\n        ctx.save();\n        saved = true;\n      }\n\n      ctx.translate(settings.translate[0] || 0, settings.translate[1] || 0);\n    }\n\n    if (settings.scale) {\n      if (!saved) {\n        ctx.save();\n        saved = true;\n      }\n\n      ctx.scale(settings.scale[0] || 1, settings.scale[1] || 1);\n    }\n\n    if (settings.transform) {\n      if (!saved) {\n        ctx.save();\n        saved = true;\n      }\n\n      ctx.transform(1, settings.transform.fh, settings.transform.fv, 1, settings.transform.fx, settings.transform.fy);\n    }\n\n    if ($sprite.type === 'img') {\n      ctx.drawImage($sprite.img, props.cutLeft, props.cutTop, props.cutWidth, props.cutHeight, props.left, props.top, props.width, props.height);\n\n      if (true) {\n        if ($canvas.$plugin) {\n          $canvas.$plugin.drawImage($canvas, props);\n        }\n      }\n    } else if ($sprite.type === 'text' && props.content) {\n      ctx.font = props.font;\n      ctx.fillStyle = props.color || 'black';\n      ctx.textAlign = props.align;\n      ctx.textBaseline = props.baseline;\n      ctx[props.type || 'fillText'](props.content, props.left, props.top);\n    } else if ($sprite.type === 'fillRect') {\n      ctx.fillStyle = settings.fillRect;\n      ctx.fillRect(props.left, props.top, props.width, props.height);\n    } else if ($sprite.type === 'line') {\n      ctx.beginPath();\n      var strokeStyle = props.borderColor || 'black';\n      ctx.strokeStyle = strokeStyle; // if (ctx._strokeStyle !== strokeStyle)\n      //     ctx._strokeStyle = ctx.strokeStyle = strokeStyle;\n\n      var borderWidth = ctx.lineWidth = props.borderWidth || 1;\n      ctx.moveTo(props.left - borderWidth, props.top - borderWidth);\n      ctx.lineTo(props.left + props.width + borderWidth, props.top - borderWidth);\n      ctx.lineTo(props.left + props.width + borderWidth, props.top + props.height + borderWidth);\n      ctx.lineTo(props.left - borderWidth, props.top + props.height + borderWidth); // ctx.lineTo(props.left, props.top);\n      // let lineWidth = props.borderWidth || 1;\n      // ctx.lineWidth = lineWidth;\n      // ctx.moveTo(props.left - lineWidth, props.top - lineWidth);\n      // ctx.lineTo(props.left + props.width + lineWidth, props.top - lineWidth);\n      // ctx.lineTo(props.left + props.width + lineWidth, props.top + props.height + lineWidth);\n      // ctx.lineTo(props.left - lineWidth, props.top + props.height + lineWidth);\n      // // ctx.lineTo(props.left - lineWidth, props.top - lineWidth);\n\n      ctx.closePath();\n      ctx.stroke();\n    } else if ($sprite.type === 'rotateEnd') {\n      ctx.$globalAlpha = false;\n      ctx.restore(); // ctx.save();\n      // ctx.translate(settings.beforeRotate[0] || 0, settings.beforeRotate[1] || 0);\n      // ctx.rotate(settings.rotate || 0);\n      // ctx.translate(settings.afterRotate[0] || 0, settings.afterRotate[1] || 0);\n    } else if ($sprite.type === 'clipOver') {\n      ctx.$globalAlpha = false;\n      ctx.restore();\n    }\n\n    if (saved) {\n      ctx.$globalAlpha = false;\n      ctx.restore();\n    }\n  });\n};\n\n//# sourceURL=webpack:///./src/painter/apiInner/render.js?");

/***/ }),

/***/ "./src/painter/apiOuter.js":
/*!*********************************!*\
  !*** ./src/painter/apiOuter.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _remove = _interopRequireDefault(__webpack_require__(/*! ./apiOuter/remove.js */ \"./src/painter/apiOuter/remove.js\"));\n\nvar _start = _interopRequireDefault(__webpack_require__(/*! ./apiOuter/start.js */ \"./src/painter/apiOuter/start.js\"));\n\nvar _paint = _interopRequireDefault(__webpack_require__(/*! ./apiOuter/paint.js */ \"./src/painter/apiOuter/paint.js\"));\n\nvar _clear = _interopRequireDefault(__webpack_require__(/*! ./apiOuter/clear.js */ \"./src/painter/apiOuter/clear.js\"));\n\nvar _pause = _interopRequireDefault(__webpack_require__(/*! ./apiOuter/pause.js */ \"./src/painter/apiOuter/pause.js\"));\n\nvar _nextTick = _interopRequireDefault(__webpack_require__(/*! ./apiOuter/nextTick.js */ \"./src/painter/apiOuter/nextTick.js\"));\n\nvar _register = _interopRequireDefault(__webpack_require__(/*! ./apiOuter/register.js */ \"./src/painter/apiOuter/register.js\"));\n\nvar _setFpsHandler = _interopRequireDefault(__webpack_require__(/*! ./apiOuter/setFpsHandler.js */ \"./src/painter/apiOuter/setFpsHandler.js\"));\n\nvar _setMaxFps = _interopRequireDefault(__webpack_require__(/*! ./apiOuter/setMaxFps.js */ \"./src/painter/apiOuter/setMaxFps.js\"));\n\nvar _skeleton = _interopRequireDefault(__webpack_require__(/*! ./apiOuter/skeleton.js */ \"./src/painter/apiOuter/skeleton.js\"));\n\nvar _sprite = _interopRequireDefault(__webpack_require__(/*! class/sprite.js */ \"./src/class/sprite.js\"));\n\nvar _apiOuter;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar apiOuter = (_apiOuter = {\n  start: _start[\"default\"],\n  paint: _paint[\"default\"],\n  add: _sprite[\"default\"].prototype.add,\n  remove: _remove[\"default\"],\n  register: _register[\"default\"],\n  clear: _clear[\"default\"],\n  setFpsHandler: _setFpsHandler[\"default\"],\n  setMaxFps: _setMaxFps[\"default\"],\n  pause: _pause[\"default\"],\n  on: _sprite[\"default\"].prototype.on,\n  off: _sprite[\"default\"].prototype.off,\n  addEventListener: _sprite[\"default\"].prototype.addEventListener,\n  removeEventListener: _sprite[\"default\"].prototype.removeEventListener\n}, _defineProperty(_apiOuter, \"off\", _sprite[\"default\"].prototype.off), _defineProperty(_apiOuter, \"trigger\", _sprite[\"default\"].prototype.trigger), _defineProperty(_apiOuter, \"broadcast\", _sprite[\"default\"].prototype.broadcast), _defineProperty(_apiOuter, \"nextTick\", _nextTick[\"default\"]), _defineProperty(_apiOuter, \"getAllChildren\", _sprite[\"default\"].prototype.getAllChildren), _apiOuter);\n\nif (true) {\n  apiOuter.skeleton = _skeleton[\"default\"];\n}\n\nmodule.exports = apiOuter;\n\n//# sourceURL=webpack:///./src/painter/apiOuter.js?");

/***/ }),

/***/ "./src/painter/apiOuter/clear.js":
/*!***************************************!*\
  !*** ./src/painter/apiOuter/clear.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n/** ********** *\n *\n * Clear children\n *\n * ********** **/\nmodule.exports = function () {\n  this.children.forEach(function (child) {\n    child.remove();\n  });\n  this.children = [];\n};\n\n//# sourceURL=webpack:///./src/painter/apiOuter/clear.js?");

/***/ }),

/***/ "./src/painter/apiOuter/nextTick.js":
/*!******************************************!*\
  !*** ./src/painter/apiOuter/nextTick.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n/** ********** *\n *\n * Trigger event only once on next painting-tick\n * - Removed after triggering.\n *\n * ********** **/\nmodule.exports = function (func) {\n  var _func = function _func() {\n    func.apply(this, arguments);\n    this.off('ticked', _func);\n  };\n\n  this.on('ticked', _func);\n};\n\n//# sourceURL=webpack:///./src/painter/apiOuter/nextTick.js?");

/***/ }),

/***/ "./src/painter/apiOuter/paint.js":
/*!***************************************!*\
  !*** ./src/painter/apiOuter/paint.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Sort the sprite and call inner functions\n * - Will be called in each frame after the 'start' function called.\n *\n * ********** **/\n// var c = document.createElement('canvas');\n// c.height = 1334;\n// c.width = 750;\n// var d = c.getContext('2d');\n// 新老props相同指针，此处判断不再有意义\n// const diffRender = function (olds, news) {//debugger;return news; //TODO!!!\n//     if (!olds || olds.length !== news.length) {\n//         return news;\n//     }\n//     for (let i = 0; i < olds.length; i++) {\n//         let o = olds[i];\n//         let n = news[i];\n//         if (o.$id !== n.$id || o.img !== n.img) return news;\n//         if (o.props && n.props) {\n//             // if (o.props.opacity !== n.props.opacity) return news;\n//             // if (o.props.rotate !== n.props.rotate) return news;\n//             // if (o.props.sh !== n.props.sh) return news;\n//             // if (o.props.sw !== n.props.sw) return news;\n//             // if (o.props.sx !== n.props.sx) return news;\n//             // if (o.props.sy !== n.props.sy) return news;\n//             // if (o.props.th !== n.props.th) return news;\n//             // if (o.props.tw !== n.props.tw) return news;\n//             // if (o.props.tx !== n.props.tx) return news;\n//             // if (o.props.ty !== n.props.ty) return news;\n//             // if (o.props.text !== n.props.text) return news;\n//             // if (o.props.align !== n.props.align) return news;\n//             // if (o.props.baseline !== n.props.baseline) return news;\n//             // if (o.props.color !== n.props.color) return news;\n//             // if (o.props.type !== n.props.type) return news;\n//             // if (o.props.font !== n.props.font) return news;\n//             for (let prop in n.props) {\n//                 if (n.props[prop] !== o.props[prop]) return news;\n//             }\n//         }\n//     }\n//     return false;\n// };\nmodule.exports = function () {\n  if (this.$pausing || this.$inBrowser && document.hidden) return;\n  var $canvas = this;\n\n  if (true) {\n    $canvas.$plugin.timeCollect($canvas, 'custom', 'START');\n  }\n\n  _utils[\"default\"].execFuncs($canvas.hooks.beforeTick, $canvas, [$canvas.$rafTime]); // $canvas.broadcast('beforeTick', $canvas.$rafTime);\n\n\n  if (true) {\n    $canvas.$plugin.timeCollect($canvas, 'preprocessTimeSpend', 'START');\n  }\n\n  $canvas.children.forEach(function ($sprite) {\n    $sprite.recalculate();\n  });\n\n  if (!$canvas.$freezing) {\n    $canvas.$lastTickChildren = $canvas.$children;\n    $canvas.$children = [];\n    this.children.sort(function (a, b) {\n      var za = _utils[\"default\"].funcOrValue(a.style.zIndex, a);\n\n      var zb = _utils[\"default\"].funcOrValue(b.style.zIndex, b);\n\n      if (za === zb) return 0;\n      return za > zb ? 1 : -1;\n    }).forEach(function (perItem, index) {\n      $canvas.$perPaint(perItem, index);\n    });\n  }\n\n  if (true) {\n    $canvas.$plugin.timeCollect($canvas, 'preprocessTimeSpend', 'END');\n  }\n\n  if (true) {\n    $canvas.$plugin.timeCollect($canvas, 'paintTimeSpend', 'START');\n  }\n\n  if ($canvas.$paintContext.clearRect) {\n    // let diffs = $canvas.$nodiff ? $canvas.$children : diffRender($canvas.$lastTickChildren, $canvas.$children);\n    // if (diffs) {\n    // d.globalAlpha = 0.3;\n    // d.clearRect(0, 0, this.width, this.height);\n    // d.globalAlpha = 0.7;\n    // d.drawImage($canvas.$dom, 0,0);\n    $canvas.$paintContext.clearRect(0, 0, this.width, this.height);\n    $canvas.$render(); // }\n  } else {\n    $canvas.$render();\n  } // $canvas.$paintContext.globalAlpha = 0.3;\n  // $canvas.$paintContext.drawImage(c,0,0);\n  // $canvas.$paintContext.globalAlpha = 1;\n\n\n  if (true) {\n    $canvas.$plugin.timeCollect($canvas, 'paintTimeSpend', 'END');\n  }\n\n  _utils[\"default\"].execFuncs($canvas.hooks.ticked, $canvas, [$canvas.$rafTime]); // $canvas.broadcast('ticked', $canvas.$rafTime);\n\n\n  if ($canvas.hooks.nextTick) {\n    _utils[\"default\"].execFuncs($canvas.hooks.nextTick, $canvas, [$canvas.$rafTime]);\n\n    delete $canvas.hooks.nextTick;\n  }\n\n  if (true) {\n    $canvas.$plugin.timeCollect($canvas, 'custom', 'END');\n  }\n};\n\n//# sourceURL=webpack:///./src/painter/apiOuter/paint.js?");

/***/ }),

/***/ "./src/painter/apiOuter/pause.js":
/*!***************************************!*\
  !*** ./src/painter/apiOuter/pause.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n/** ********** *\n *\n * Stop painting in paint function.\n *\n * ********** **/\nmodule.exports = function (val) {\n  this.$pausing = val === undefined ? true : val;\n};\n\n//# sourceURL=webpack:///./src/painter/apiOuter/pause.js?");

/***/ }),

/***/ "./src/painter/apiOuter/register.js":
/*!******************************************!*\
  !*** ./src/painter/apiOuter/register.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n/** ********** *\n *\n * Create an Easycanvas instance on current dom\n * - Start the 'hold' event judging interval(may includes a memory waste after destroyed).\n *\n * ********** **/\nvar extend = function extend(opt) {\n  var _this = this;\n\n  this.$extendList.forEach(function (plugin) {\n    if (plugin.onCreate) {\n      plugin.onCreate.call(_this, opt);\n    }\n  });\n};\n\nmodule.exports = function (dom, option) {\n  var _this2 = this;\n\n  if (true) {\n    this.fpsHandler = this.fpsHandler || function (fps) {\n      if (this.maxFps > 0 && fps < this.maxFps - 5 && fps < 40) {\n        console.warn(\"[Easycanvas] Low FPS detected (\".concat(fps, \"/\").concat(this.maxFps, \").\"));\n      }\n    };\n  }\n\n  var _option = option || {};\n\n  dom = this.$dom = dom || this.$dom;\n\n  if (true) {\n    if (!dom) {\n      console.error('[Easycanvas] Not found <canvas> element in \"register\" function.');\n    }\n  } // 修复iOS下click时闪烁\n  // https://stackoverflow.com/questions/9526719/ipad-canvas-flickers-when-tapped\n  // dom.style['webkitTapHighlightColor'] = 'rgba(0,0,0,0);';\n\n\n  for (var i in _option) {\n    this[i] = _option[i];\n  }\n\n  this.name = _option.name || dom.id || dom.classList && dom.classList[0] || 'Unnamed';\n  this.$inBrowser = typeof window !== 'undefined';\n\n  if (_option.fullScreen && typeof document !== 'undefined') {\n    dom.width = dom.style.width = document.body.clientWidth || document.documentElement.clientWidth;\n    dom.height = dom.style.height = document.body.clientHeight || document.documentElement.clientHeight;\n\n    if (_option.dpr) {\n      dom.width *= _option.dpr;\n      dom.height *= _option.dpr;\n    }\n  }\n\n  if (true) {\n    if (_option.width && dom.attributes.width && _option.width !== dom.width || _option.height && dom.attributes.height && _option.height !== dom.height) {\n      console.warn('[Easycanvas] Canvas size mismatched in \"register\" function.');\n    }\n  }\n\n  dom.width = this.width = this.width || _option.width || dom.width;\n  dom.height = this.height = this.height || _option.height || dom.height;\n\n  if (true) {\n    this.$plugin.register(this);\n  }\n\n  this.events = _option.events || {};\n  this.hooks = _option.hooks || {};\n\n  if (this.$inBrowser) {\n    var eventList = ['contextmenu', 'mousewheel', 'click', 'dblclick', 'mousedown', 'mouseup', 'mousemove', 'touchstart', 'touchend', 'touchmove'];\n    eventList.forEach(function (e) {\n      dom.addEventListener(e, _this2.$eventHandler.bind(_this2));\n    });\n  }\n\n  if (true) {\n    if (this.$paintContext) {\n      console.error(\"[Easycanvas] Current instance is already registered.\");\n    }\n  }\n\n  extend.call(this, _option);\n  this.$paintContext = this.$paintContext || dom.getContext('2d');\n  return this;\n};\n\n//# sourceURL=webpack:///./src/painter/apiOuter/register.js?");

/***/ }),

/***/ "./src/painter/apiOuter/remove.js":
/*!****************************************!*\
  !*** ./src/painter/apiOuter/remove.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Remove a sprite (async)\n * - In develop mode, fps will throw warnings in low performance.\n *\n * ********** **/\nmodule.exports = function ($sprite, sync) {\n  _utils[\"default\"].execFuncs($sprite.hooks.beforeRemove, $sprite, $sprite.$tickedTimes++);\n\n  $sprite.style.visible = false;\n  $sprite.$removing = true; // setTimeout(() => {\n\n  if ($sprite.$parent) {\n    $sprite.$parent.children = $sprite.$parent.children.filter(function (child) {\n      return child.$removing !== true;\n    });\n  } else {\n    this.children = this.children.filter(function (child) {\n      return child.$removing !== true;\n    });\n  }\n\n  if ($sprite.$canvas) {\n    _utils[\"default\"].execFuncs($sprite.hooks.removed, $sprite, $sprite.$tickedTimes);\n\n    $sprite.$canvas = undefined;\n    $sprite.$parent = undefined;\n    $sprite.$tickedTimes = undefined;\n    $sprite.$cache = {}; // ??\n\n    $sprite.$rendered = false;\n\n    if (true) {\n      $sprite.$perf = undefined;\n    }\n  } // });\n\n\n  if (sync) {\n    this.children.splice(this.children.indexOf($sprite), 1);\n  }\n};\n\n//# sourceURL=webpack:///./src/painter/apiOuter/remove.js?");

/***/ }),

/***/ "./src/painter/apiOuter/setFpsHandler.js":
/*!***********************************************!*\
  !*** ./src/painter/apiOuter/setFpsHandler.js ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n/** ********** *\n *\n * Set fps handler\n * - Same to new Easycanvas.Painter().fpsHandler = callback\n *\n * ********** **/\nmodule.exports = function (callback) {\n  this.fpsHandler = callback;\n};\n\n//# sourceURL=webpack:///./src/painter/apiOuter/setFpsHandler.js?");

/***/ }),

/***/ "./src/painter/apiOuter/setMaxFps.js":
/*!*******************************************!*\
  !*** ./src/painter/apiOuter/setMaxFps.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n/** ********** *\n *\n * Set max fps\n * - @fps -1 means Infinity\n *\n * ********** **/\nmodule.exports = function (fps) {\n  this.maxFps = fps || -1;\n};\n\n//# sourceURL=webpack:///./src/painter/apiOuter/setMaxFps.js?");

/***/ }),

/***/ "./src/painter/apiOuter/skeleton.js":
/*!******************************************!*\
  !*** ./src/painter/apiOuter/skeleton.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nif (true) {\n  module.exports = function () {\n    var $canvas = this;\n\n    $canvas.children[0].__proto__.getAllChildren.call($canvas).forEach(function (child) {\n      child.uncombine();\n      child.$combine = true;\n    });\n\n    $canvas.paint();\n\n    $canvas.children[0].__proto__.getAllChildren.call($canvas).forEach(function (child) {\n      child.$combine = false;\n    });\n\n    var sekeletonString = '';\n    sekeletonString += \"var $SKL=document.getElementsByTagName('canvas')[0];\";\n    sekeletonString += \"$SKL.width=\".concat($canvas.width, \";$SKL.height=\").concat($canvas.height, \";\");\n    sekeletonString += \"$SKL.style.width='100%';$SKL.style.width='100%';\";\n    sekeletonString += \"var SKLIMG=[];\";\n    sekeletonString += \"var SKL = function(){\";\n    sekeletonString += \"var _=$SKL.getContext('2d');\";\n    var $children = $canvas.$children;\n    $children.forEach(function ($child) {\n      var props = $child.props;\n      var settings = $child.settings;\n\n      if ($child.type === 'img') {\n        sekeletonString += \"_.globalAlpha=\".concat(settings.globalAlpha, \";\");\n\n        if ($child.img && $child.img.$origin) {\n          // is canvas\n          sekeletonString += $child.img.$origin.join(';') + ';';\n          sekeletonString += \"_.drawImage(tempCanvas, \".concat(props.cutLeft, \", \").concat(props.cutTop, \", \").concat(props.cutWidth, \", \").concat(props.cutHeight, \", \").concat(props.left, \", \").concat(props.top, \", \").concat(props.width, \", \").concat(props.height, \");\");\n        } else if ($child.img && $child.img.src) {\n          sekeletonString += \"var img = new Image();\";\n          sekeletonString += \"var imgUrl='\".concat($child.img.src, \"';if(SKLIMG.indexOf(imgUrl)===-1){SKLIMG.push(imgUrl);img.onload=function(){_.clearRect(0,0,$SKL.width,$SKL.height);SKL();}};\");\n          sekeletonString += \"img.src=imgUrl;\";\n          sekeletonString += \"_.drawImage(img, \".concat(props.cutLeft, \", \").concat(props.cutTop, \", \").concat(props.cutWidth, \", \").concat(props.cutHeight, \", \").concat(props.left, \", \").concat(props.top, \", \").concat(props.width, \", \").concat(props.height, \");\");\n        } else {\n          sekeletonString += \"_.fillStyle='#666';\";\n          sekeletonString += \"_.fillRect(\".concat(props.left, \", \").concat(props.top, \", \").concat(props.width, \", \").concat(props.height, \");\");\n        }\n      } else if ($child.type === 'fillRect') {\n        sekeletonString += \"_.globalAlpha=\".concat(settings.globalAlpha, \";\");\n        sekeletonString += \"_.fillStyle='\".concat(settings.fillRect, \"';\");\n        sekeletonString += \"_.fillRect(\".concat(props.left, \", \").concat(props.top, \", \").concat(props.width, \", \").concat(props.height, \");\");\n      }\n    });\n    sekeletonString += \"_.globalAlpha=1;\";\n    sekeletonString += '};SKL($SKL);';\n    console.log(sekeletonString);\n  };\n}\n\n//# sourceURL=webpack:///./src/painter/apiOuter/skeleton.js?");

/***/ }),

/***/ "./src/painter/apiOuter/start.js":
/*!***************************************!*\
  !*** ./src/painter/apiOuter/start.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _tick = _interopRequireDefault(__webpack_require__(/*! utils/tick.js */ \"./src/utils/tick.js\"));\n\nvar _transition = _interopRequireDefault(__webpack_require__(/*! utils/transition.js */ \"./src/utils/transition.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Start rAF loop\n * - Cannot called twice on same instance\n *\n * ********** **/\nvar rAFer = function rAFer() {\n  var time = Date.now();\n  _transition[\"default\"].$lastPaintTime = this.$nextTickTime = time; // calculating fps\n\n  if (time - this.fpsCalculateTime >= 1000) {\n    this.fpsCalculateTime = time;\n\n    if (this.fpsHandler) {\n      this.fpsHandler.call(this, this.fps);\n    }\n\n    this.lastFps = this.fps;\n    this.fps = 0;\n  }\n\n  (0, _tick[\"default\"])(loop.bind(this));\n};\n\nvar loop = function loop(rafTime) {\n  this.$rafTime = rafTime;\n  rAFer.call(this);\n\n  if (this.maxFps > 0 && this.maxFps < 60) {\n    if (time - this.$lastPaintTime <= 1000 / this.maxFps) {\n      return;\n    } // 让$lastPaintTime不带有小尾巴（101，199，202，298这种变成100，200，300，400）\n    // https://stackoverflow.com/questions/19764018/controlling-fps-with-requestanimationframe\n\n\n    this.$lastPaintTime = time - (time - this.$lastPaintTime) % (1000 / this.maxFps);\n  } else {\n    this.$lastPaintTime = Date.now();\n  }\n\n  this.fps++;\n  this.paint();\n};\n\nmodule.exports = function () {\n  this.fpsCalculateTime = Date.now();\n  rAFer.call(this); // setInterval(() => {\n  //     if (this.eHoldingFlag) {\n  //         let $e = this.eHoldingFlag;\n  //         $e.type = 'hold';\n  //         this.$eventHandler.call(this, null, $e);\n  //     }\n  // }, 100); // TODO\n\n  return this;\n};\n\n//# sourceURL=webpack:///./src/painter/apiOuter/start.js?");

/***/ }),

/***/ "./src/painter/apiPlugin/apiPlugin.js":
/*!********************************************!*\
  !*** ./src/painter/apiPlugin/apiPlugin.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = _interopRequireDefault(__webpack_require__(/*! utils/utils.js */ \"./src/utils/utils.js\"));\n\nvar _constants = _interopRequireDefault(__webpack_require__(/*! constants */ \"./constants.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Plugined to each canvas instance\n * - Will add a 'mask' sprite to show the active sprite.\n * - Only works in develop mode.\n * - The handlers are in /plugin/panel/index.js file.\n *\n * ********** **/\nmodule.exports = function () {\n  if (true) {\n    var TO_PANEL_EVENT_NAME = '__EASYCANVAS_BRIDGE_TOPANEL__'; // 不再通过事件来监听了devTool了，直接从devTool来inspectedWindow.eval\n    // window.document.addEventListener('__EASYCANVAS_BRIDGE_TODOC__', function (recieveData) {\n    //     let data = recieveData.detail;\n    //     if (data.action = 'code') {\n    //         // console.log(data.content);\n    //         eval(data.content);\n    //     }\n    // });\n\n    var $emit = function $emit(passData) {\n      passData.tabId = window[_constants[\"default\"].devFlag].tabId;\n      window.document.dispatchEvent(new CustomEvent(TO_PANEL_EVENT_NAME, {\n        //  filtering special types\n        detail: JSON.parse(JSON.stringify(passData)) // bubbles: true,\n        // cancelable: true\n\n      }));\n    };\n\n    var textFont = '24px san-serif';\n    var textFontSmall = '18px san-serif';\n\n    var measureText = function measureText(text, size) {\n      var tempCanvas = document.createElement('canvas');\n      var tempCtx = tempCanvas.getContext('2d');\n      tempCtx.font = size || textFont;\n      return tempCtx.measureText(text).width;\n    };\n\n    setTimeout(function () {\n      $emit({\n        name: 'init'\n      });\n    });\n    var MaskCanvasBase64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQYV2OYePb/fwAHrQNdl+exzgAAAABJRU5ErkJggg==';\n\n    var MaskTriangleCanvas = function () {\n      var canvas = document.createElement('canvas');\n      canvas.width = 40;\n      canvas.height = 20;\n      var ctx = canvas.getContext('2d');\n      ctx.beginPath();\n      ctx.moveTo(0, 20);\n      ctx.lineTo(40, 20);\n      ctx.lineTo(20, 0);\n      ctx.closePath(); // draws last line of the triangle\n\n      ctx.fill();\n      return canvas;\n    }();\n\n    var $selectMask = null;\n    var $selectMaskParent = null;\n    var PerSecondCollects = ['paintArea', 'paintTimes', 'paintTimeSpend', 'preprocessTimeSpend', 'custom', 'loadArea', 'jumpArea'];\n    var ApiPlugin = {\n      drawImage: function drawImage($canvas, _props) {\n        if (!window[_constants[\"default\"].devFlag].isPaintRecording) return;\n\n        if (_props) {\n          $canvas.$perf.$paintArea += _props[7] * _props[8];\n          $canvas.$perf.$loadArea += _props[3] * _props[4];\n        }\n\n        $canvas.$perf.$paintTimes++;\n      },\n      jumpRender: function jumpRender($canvas, _props) {\n        $canvas.$perf.$jumpArea += _props[7] * _props[8];\n      },\n      register: function register($canvas) {\n        $canvas.$id = Math.random().toString(36).substr(2); // 性能打点\n        // 带$是临时值，否则为每秒的快照值；临时值每秒快照一次\n        // 因此开发工具只需要使用快照进行分析即可\n\n        $canvas.$perf = {};\n        PerSecondCollects.forEach(function (key) {\n          $canvas.$perf[key] = 0;\n          $canvas.$perf['$' + key] = 0;\n        });\n        setInterval(function () {\n          PerSecondCollects.forEach(function (key) {\n            $canvas.$perf[key] = $canvas.$perf['$' + key];\n            $canvas.$perf['$' + key] = 0;\n          });\n        }, 1000);\n\n        if (!$canvas.$flags.devtoolHanged) {\n          window[_constants[\"default\"].devFlag].$canvas[$canvas.$id] = $canvas;\n          $canvas.$flags.devtoolHanged = true;\n        }\n      },\n      timeCollect: function timeCollect($canvas, type, startOrEnd) {\n        // START与END必须在同一个event loop中，且位于相同的微任务队列中\n        // 否则会影响指标收集\n        $canvas.$perf['$' + type] += (startOrEnd === 'START' || startOrEnd === 'PAUSE' ? -1 : 1) * (performance ? performance.now() : Date.now());\n      },\n      selectSprite: function selectSprite(isChoosing, $canvas, $sprite) {\n        window[_constants[\"default\"].devFlag].MaskCanvasBase64 = MaskCanvasBase64;\n\n        if (!$sprite || !window[_constants[\"default\"].devFlag].selectMode) {\n          ApiPlugin.cancelSelectSprite($canvas);\n          return false;\n        } // let originScale = $sprite.style.scale;\n        // $sprite.style.scale = Easycanvas.Transition.linear(1, 1.2, 100).then(() => {\n        //     $sprite.style.scale = Easycanvas.Transition.linear(1.2, 1, 100).then(() => {\n        //         $sprite.style.scale = originScale;\n        //     });\n        // });\n\n\n        if (!$selectMask) {\n          var tipsWidth = 0;\n          var maskRect = {};\n          var maskParentRect = {};\n          $selectMask = $canvas.add({\n            // 高亮\n            name: _constants[\"default\"].devFlag,\n            content: {\n              img: $canvas.imgLoader(MaskCanvasBase64)\n            },\n            style: {\n              border: function border() {\n                if (this.getStyle('width') < 2 && this.getStyle('height') < 2) {\n                  return '10 rgba(0, 0, 255, 0.5)';\n                }\n\n                return '1 blue';\n              }\n            },\n            webgl: undefined,\n            children: !$canvas.$paintContext.clearRect ? [] : [{\n              // sprite名字\n              name: _constants[\"default\"].devFlag,\n              data: {},\n              style: {\n                locate: 'center',\n                left: function left() {\n                  var res = maskRect.left + maskRect.width / 2;\n\n                  if (res - tipsWidth / 2 < 10) {\n                    res = tipsWidth / 2 + 10;\n                  } else if (res + tipsWidth / 2 > this.$canvas.width - 10) {\n                    res = this.$canvas.width - tipsWidth / 2 - 10;\n                  }\n\n                  return res - this.$parent.$cache.left;\n                },\n                top: function top() {\n                  var res = maskRect.top + maskRect.height + 30;\n\n                  if (this.data.above = res + 30 > this.$canvas.height) {\n                    res = maskRect.top - 32;\n                  }\n\n                  return res - this.$parent.$cache.top;\n                },\n                width: function width() {\n                  return tipsWidth;\n                },\n                height: 32,\n                color: 'orange',\n                backgroundColor: 'black',\n                textVerticalAlign: 'middle',\n                textAlign: 'center',\n                fontSize: parseInt(textFont),\n                fontFamily: 'san-serif'\n              },\n              hooks: {\n                beforeTick: function beforeTick() {\n                  maskRect = this.$parent.getRect();\n                  this.content.text = '<' + $sprite.name + '> | ' + Math.round(this.$parent.getStyle('width')) + '×' + Math.round(this.$parent.getStyle('height'));\n                  tipsWidth = measureText(this.content.text) + 20;\n                }\n              },\n              children: [{\n                name: _constants[\"default\"].devFlag,\n                content: {\n                  img: MaskTriangleCanvas\n                },\n                style: {\n                  left: function left() {\n                    return maskRect.left + maskRect.width / 2 - this.$parent.$cache.left;\n                  },\n                  top: function top() {\n                    return this.$parent.data.above ? 5 + 16 : -5 - 16;\n                  },\n                  width: 20,\n                  height: 10,\n                  rotate: function rotate() {\n                    return this.$parent.data.above ? 180 : 0;\n                  }\n                }\n              }]\n            }, {\n              // 距离parent的距离标注\n              name: _constants[\"default\"].devFlag,\n              style: {\n                visible: function visible() {\n                  return this.getStyle('width') < this.data.value;\n                },\n                locate: 'center',\n                left: function left() {\n                  var res = maskParentRect.left + ($selectMask.getSelfStyle('left') - $selectMaskParent.getSelfStyle('left')) / 2;\n                  return res - this.$parent.$cache.left;\n                },\n                top: function top() {\n                  var res = $selectMask.getSelfStyle('top');\n                  return res - this.$parent.$cache.top;\n                },\n                width: function width() {\n                  return measureText(this.content.text, textFontSmall) + 10;\n                },\n                height: 20,\n                backgroundColor: '#ddd',\n                color: 'black',\n                textVerticalAlign: 'middle',\n                textAlign: 'center',\n                fontSize: parseInt(textFontSmall),\n                fontFamily: 'san-serif'\n              },\n              data: {},\n              hooks: {\n                beforeTick: function beforeTick() {\n                  maskParentRect = $selectMaskParent.getRect();\n                  this.data.value = Math.round($selectMask.getSelfStyle('left') - $selectMaskParent.getSelfStyle('left'));\n                  this.content.text = 'left: ' + String(this.data.value);\n                }\n              }\n            }, {\n              // 距离parent的距离标注\n              name: _constants[\"default\"].devFlag,\n              style: {\n                visible: function visible() {\n                  return this.getStyle('height') < this.data.value;\n                },\n                locate: 'center',\n                left: function left() {\n                  var res = $selectMask.getSelfStyle('left');\n                  return res - this.$parent.$cache.left;\n                },\n                top: function top() {\n                  var res = maskParentRect.top + ($selectMask.getSelfStyle('top') - $selectMaskParent.getSelfStyle('top')) / 2;\n                  return res - this.$parent.$cache.top;\n                },\n                width: function width() {\n                  return measureText(this.content.text, textFontSmall) + 10;\n                },\n                height: 20,\n                backgroundColor: '#ddd',\n                color: 'black',\n                textVerticalAlign: 'middle',\n                textAlign: 'center',\n                fontSize: parseInt(textFontSmall),\n                fontFamily: 'san-serif'\n              },\n              data: {},\n              hooks: {\n                beforeTick: function beforeTick() {\n                  maskParentRect = $selectMaskParent.getRect();\n                  this.data.value = Math.round($selectMask.getSelfStyle('top') - $selectMaskParent.getSelfStyle('top'));\n                  this.content.text = 'top: ' + String(this.data.value);\n                }\n              }\n            }]\n          });\n          $selectMaskParent = $canvas.add({\n            name: _constants[\"default\"].devFlag,\n            style: {\n              // backgroundColor: 'yellow',\n              locate: 'lt'\n            },\n            children: [{\n              name: _constants[\"default\"].devFlag,\n              style: {\n                locate: 'lt',\n                left: 0,\n                top: 0,\n                width: function width() {\n                  return $selectMask.getSelfStyle('left') - this.$parent.getStyle('left');\n                },\n                height: function height() {\n                  return $selectMask.getSelfStyle('top') - this.$parent.getStyle('top');\n                },\n                backgroundColor: 'rgba(140, 205, 255, 0.1)',\n                border: '1 rgba(80, 120, 200, 0.9)'\n              }\n            }]\n          });\n        }\n\n        ['left', 'top', 'rotate', 'rx', 'ry', 'scale', 'width', 'height', 'locate'].forEach(function (key) {\n          (function (_key) {\n            $selectMask.style[_key] = function () {\n              if (_key === 'width' || _key === 'height') {\n                return $sprite.getStyle(_key) || $sprite.getRect()[_key] || 0.1; // 如果尺寸为0，会使用mask的图片尺寸，变成1\n              }\n\n              return $sprite.getStyle(_key);\n            };\n          })(key);\n        });\n        ['left', 'top'].forEach(function (key) {\n          (function (_key) {\n            $selectMaskParent.style[_key] = function () {\n              if (!$sprite.$parent) return 0;\n              return $sprite.$parent.getStyle(_key);\n            };\n          })(key);\n        });\n        $selectMask.style.zIndex = Number.MAX_SAFE_INTEGER;\n        $selectMaskParent.style.zIndex = Number.MAX_SAFE_INTEGER - 1;\n\n        $selectMask.style.visible = function () {\n          return window[_constants[\"default\"].devFlag].selectMode && $sprite.$canvas;\n        };\n\n        $selectMaskParent.style.visible = function () {\n          return window[_constants[\"default\"].devFlag].selectMode && $sprite.$parent && $sprite.$parent.$canvas;\n        };\n\n        $selectMask.style.opacity = 0.8; // mask of webgl\n\n        $selectMask.webgl = $sprite.webgl ? {} : undefined;\n\n        if ($selectMask.webgl) {\n          for (var key in $sprite.webgl) {\n            (function (_key) {\n              $selectMask.webgl[_key] = function () {\n                if (typeof $sprite.webgl[_key] === 'function') {\n                  return $sprite.webgl[_key].call($sprite);\n                }\n\n                return $sprite.webgl[_key];\n              };\n            })(key);\n          }\n\n          $selectMask.webgl.img = $canvas.imgLoader(MaskCanvasBase64);\n          $selectMask.webgl.colors = false;\n          $selectMask.style.zIndex = Number.MIN_SAFE_INTEGER;\n        }\n\n        if (isChoosing) {\n          $canvas.remove($selectMask);\n          $canvas.remove($selectMaskParent);\n          $selectMask = null;\n          $emit({\n            name: 'selectSprite',\n            id: $canvas.$id,\n            value: {\n              sprite: $sprite.$id,\n              canvas: $canvas.$id\n            }\n          });\n          window[_constants[\"default\"].devFlag].current = {\n            $sprite: $sprite,\n            $canvas: $canvas\n          };\n          window[_constants[\"default\"].devFlag].selectMode = false;\n        }\n\n        return true;\n      },\n      cancelSelectSprite: function cancelSelectSprite($canvas) {\n        if (!$selectMask) return;\n        $canvas.remove($selectMask);\n        $canvas.remove($selectMaskParent);\n        $selectMask = null;\n      }\n    };\n    return ApiPlugin;\n  }\n};\n\n//# sourceURL=webpack:///./src/painter/apiPlugin/apiPlugin.js?");

/***/ }),

/***/ "./src/painter/index.js":
/*!******************************!*\
  !*** ./src/painter/index.js ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _apiOuter = _interopRequireDefault(__webpack_require__(/*! ./apiOuter.js */ \"./src/painter/apiOuter.js\"));\n\nvar _apiInner = _interopRequireDefault(__webpack_require__(/*! ./apiInner.js */ \"./src/painter/apiInner.js\"));\n\nvar _prototype = _interopRequireDefault(__webpack_require__(/*! ./prototype.js */ \"./src/painter/prototype.js\"));\n\nvar _imgLoader = _interopRequireDefault(__webpack_require__(/*! utils/img-loader.js */ \"./src/utils/img-loader.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n/** ********** *\n *\n * Exports an Easycanvas Prototype\n * - Merge apis to its prototypes.\n *\n * ********** **/\nvar painter = function painter(config) {\n  this.imgLoader = _imgLoader[\"default\"];\n\n  for (var i in _prototype[\"default\"]) {\n    // Avoid muti instances from sharing data\n    this[i] = this[i] || JSON.parse(JSON.stringify(_prototype[\"default\"][i]));\n  }\n\n  if (!config) {\n    return;\n  }\n\n  if (!config.el) {\n    config = {\n      el: config\n    };\n  }\n\n  if (config.el) {\n    this.register(typeof config.el === 'string' ? document.querySelector(config.el) : config.el, config);\n  }\n};\n\npainter.prototype.$extendList = [];\n\nfor (var i in _apiInner[\"default\"]) {\n  if (Object.prototype.hasOwnProperty.call(_apiInner[\"default\"], i)) {\n    painter.prototype[i] = _apiInner[\"default\"][i];\n  }\n}\n\nfor (var _i in _apiOuter[\"default\"]) {\n  if (Object.prototype.hasOwnProperty.call(_apiOuter[\"default\"], _i)) {\n    painter.prototype[_i] = _apiOuter[\"default\"][_i];\n  }\n}\n\nmodule.exports = painter;\n\n//# sourceURL=webpack:///./src/painter/index.js?");

/***/ }),

/***/ "./src/painter/prototype.js":
/*!**********************************!*\
  !*** ./src/painter/prototype.js ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n/** ********** *\n *\n * Prototype of canvas instance\n * - In develop mode, fps will throw warnings in low performance.\n *\n * ********** **/\nvar PROTOS = {\n  $dom: null,\n  $paintContext: null,\n  $nextTickTime: 0,\n  $lastPaintTime: 0,\n  // 只有当maxFps位于1～59时才不为0\n  $pausing: false,\n  $freezing: false,\n  name: '',\n  fps: 0,\n  lastFps: 0,\n  fpsCalculateTime: 0,\n  fpsHandler: null,\n  width: 0,\n  height: 0,\n  events: {\n    click: null\n  },\n  children: [],\n  eHoldingFlag: false,\n  eLastMouseHover: null,\n  maxFps: -1\n};\n\nif (true) {\n  PROTOS.$flags = {// dragging: false\n  };\n}\n\nmodule.exports = PROTOS;\n\n//# sourceURL=webpack:///./src/painter/prototype.js?");

/***/ }),

/***/ "./src/utils/img-loader.js":
/*!*********************************!*\
  !*** ./src/utils/img-loader.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n/** ********** *\n *\n * Load images\n * - Easycanvas.ImgLoader.cacheCanvas\n *\n * ********** **/\nvar Cache = {};\nvar BlockingImgs = [];\nvar ProcessingFlag = 'processing'; // 防止非浏览器环境报错；非浏览器下，不会使用下面的loader方法，因此OImage为空不影响\n\nvar OImage = typeof window !== 'undefined' && Image;\nvar blockingAmount = 0;\n\nvar loader = function loader(url, callback, option) {\n  var _option = option || {};\n\n  var cacheCanvas = loader.cacheCanvas;\n\n  if (_typeof(url) === 'object') {\n    var imgs = url;\n    _option.callbackArgs = _option.callbackArgs || [];\n    loader(imgs.shift(), function (perImg) {\n      _option.callbackArgs.push(perImg);\n\n      if (imgs.length > 1) {\n        loader(imgs, callback, _option);\n      } else {\n        loader(imgs[0], function (lastImg) {\n          _option.callbackArgs.push(lastImg);\n\n          callback(_option.callbackArgs);\n        }, _option);\n      }\n    }, option);\n    return;\n  }\n\n  var cacheNamespace = url + '_' + JSON.stringify(option) + '_' + cacheCanvas;\n\n  if (Cache[cacheNamespace]) {\n    if (callback) {\n      if (Cache[cacheNamespace].width && callback) {\n        callback(Cache[cacheNamespace]);\n      } else {\n        setTimeout(function () {\n          loader(url, callback, option);\n        }, 100);\n      }\n\n      return;\n    } else {\n      return Cache[cacheNamespace];\n    }\n  } // todo: 多个loader加载同一图片，目前只触发一个callback；待补充\n\n\n  var i = new OImage();\n  i._complete = false;\n\n  if (_option.block) {\n    i.src = url;\n    blockingAmount++;\n  } else if (blockingAmount === 0) {\n    i.src = url;\n  } else {\n    BlockingImgs.push({\n      imgObj: i,\n      src: url\n    });\n  }\n\n  Cache[cacheNamespace] = i;\n  var tempCanvas;\n\n  if (_option.canvas || _option.alphaColor || cacheCanvas) {\n    tempCanvas = document.createElement('canvas');\n    tempCanvas.width = tempCanvas.height || 0;\n    Cache[cacheNamespace] = tempCanvas;\n  }\n\n  i.onload = function (e) {\n    i._complete = true;\n\n    if (i.src.substr(-3) === 'jpg' || i.src.substr(-3) === 'jpeg' || i.src.substr(-3) === 'bmp') {\n      i.$noAlpha = true;\n    } else if (i.src.indexOf('data:image/jpg;') === 0) {\n      i.$noAlpha = true;\n    }\n\n    if (_option.block) {\n      blockingAmount--;\n\n      if (blockingAmount === 0) {\n        BlockingImgs.forEach(function (blockingImg) {\n          blockingImg.imgObj.src = blockingImg.src;\n        });\n        BlockingImgs.splice(0);\n      }\n    }\n\n    if (tempCanvas && (_option.canvas || _option.alphaColor || cacheCanvas)) {\n      var cts = tempCanvas.getContext('2d');\n      tempCanvas.width = i.width;\n      tempCanvas.height = i.height;\n      tempCanvas.$noAlpha = i.$noAlpha;\n      cts.drawImage(i, 0, 0);\n\n      if (_option.alphaColor) {\n        var data = cts.getImageData(0, 0, i.width, i.height);\n\n        for (var d = 0; d < data.data.length; d += 4) {\n          var colorWeight = data.data[d] + data.data[d + 1] + data.data[d + 2];\n          var blackLike = 1;\n\n          if (data.data[d] < blackLike && data.data[d + 1] < blackLike && data.data[d + 2] < blackLike) {\n            data.data[d + 3] = Math.floor(colorWeight / 255);\n          }\n        }\n\n        cts.putImageData(data, 0, 0);\n        tempCanvas.$noAlpha = false;\n      }\n\n      i = tempCanvas;\n    }\n\n    if (callback) {\n      callback(i);\n    }\n  };\n\n  i.onerror = function () {\n    Cache[cacheNamespace] = i;\n  };\n\n  return tempCanvas || i;\n};\n\nloader.cacheCanvas = false;\nmodule.exports = loader;\n\n//# sourceURL=webpack:///./src/utils/img-loader.js?");

/***/ }),

/***/ "./src/utils/img-pretreat.js":
/*!***********************************!*\
  !*** ./src/utils/img-pretreat.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _imgLoader = _interopRequireDefault(__webpack_require__(/*! ./img-loader.js */ \"./src/utils/img-loader.js\"));\n\nvar _img2base = _interopRequireDefault(__webpack_require__(/*! ./img2base64.js */ \"./src/utils/img2base64.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nmodule.exports = function (url, option) {\n  var result;\n  (0, _img2base[\"default\"])(url, function (base64) {\n    return (0, _imgLoader[\"default\"])(base64, function (canvas) {\n      // let t0 = new Date() * 1;\n      var cw = canvas.width,\n          ch = canvas.height;\n      var imageData = canvas.getContext('2d').getImageData(0, 0, cw, ch);\n      var data = imageData.data;\n\n      for (var i = data.length - 1; i >= 0; i -= 4) {\n        if (option && option.conversion) {\n          var pixel = option.conversion({\n            r: data[i - 3],\n            g: data[i - 2],\n            b: data[i - 1],\n            a: data[i]\n          }, (i + 1 >> 2) % cw, Math.floor((i + 1 >> 2) / cw));\n          data[i - 3] = Math.max(Math.min(pixel.r, 255), 0);\n          data[i - 2] = Math.max(Math.min(pixel.g, 255), 0);\n          data[i - 1] = Math.max(Math.min(pixel.b, 255), 0);\n          data[i - 0] = Math.max(Math.min(pixel.a, 255), 0);\n        }\n      }\n\n      canvas.getContext('2d').clearRect(0, 0, cw, ch);\n      canvas.getContext('2d').putImageData(imageData, 0, 0);\n      result = canvas; // console.log(new Date() * 1 - t0);\n    }, {\n      canvas: true,\n      cacheFlag: Math.random()\n    });\n  });\n  return function () {\n    return result;\n  };\n};\n\n//# sourceURL=webpack:///./src/utils/img-pretreat.js?");

/***/ }),

/***/ "./src/utils/img2base64.js":
/*!*********************************!*\
  !*** ./src/utils/img2base64.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar ProcessingFlag = 'processing';\nvar ProcessingPool = {};\n\nfunction toDataURL(url, callback) {\n  if (url && url.match(/^data:/)) {\n    callback && callback(url);\n    return;\n  }\n\n  if (ProcessingPool[url]) {\n    if (ProcessingPool[url] !== ProcessingFlag) {\n      callback(ProcessingPool[url]);\n    } else {\n      setTimeout(function () {\n        toDataURL(url, callback);\n      }, 100);\n    }\n\n    return;\n  }\n\n  ProcessingPool[url] = ProcessingFlag;\n  var xhr = new XMLHttpRequest();\n\n  xhr.onload = function () {\n    var reader = new FileReader();\n\n    reader.onloadend = function () {\n      ProcessingPool[url] = reader.result;\n      callback && callback(reader.result);\n    };\n\n    reader.readAsDataURL(xhr.response);\n  };\n\n  xhr.open('GET', url);\n  xhr.responseType = 'blob';\n  xhr.send();\n}\n\nmodule.exports = toDataURL;\n\n//# sourceURL=webpack:///./src/utils/img2base64.js?");

/***/ }),

/***/ "./src/utils/math.point-in-rect.js":
/*!*****************************************!*\
  !*** ./src/utils/math.point-in-rect.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _mathPointRotate = _interopRequireDefault(__webpack_require__(/*! ./math.point-rotate.js */ \"./src/utils/math.point-rotate.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n// 判断矩形(x1,y1,w1,h1)围绕定点(rx,ry)旋转deg角度后，能否与矩形(x2,y2,w2,h2)相交\n// 用于跳过绘制的判断\n// 用中心点距离+上下左右分离的方式模糊判断\nvar PI = 3.141593;\n\nmodule.exports = function (x, y, x2, y2, w2, h2, rx, ry, deg) {\n  var _deg = deg ? -deg / 180 * PI : 0;\n\n  if (_deg) {\n    x = (x - rx) * Math.cos(_deg) - (y - ry) * Math.sin(_deg) + rx;\n    y = (x - rx) * Math.sin(_deg) + (y - ry) * Math.cos(_deg) + ry;\n  }\n\n  return x >= x2 && x <= x2 + w2 && y >= y2 && y <= y2 + h2;\n};\n\n//# sourceURL=webpack:///./src/utils/math.point-in-rect.js?");

/***/ }),

/***/ "./src/utils/math.point-rotate.js":
/*!****************************************!*\
  !*** ./src/utils/math.point-rotate.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar PI = 3.141593;\n\nmodule.exports = function (x, y, rx0, ry0, d, returnArr) {\n  var deg = d ? -d / 180 * PI : 0;\n  var _x = x,\n      _y = y;\n\n  if (d) {\n    _x = (x - rx0) * Math.cos(deg) - (y - ry0) * Math.sin(deg) + rx0;\n    _y = (x - rx0) * Math.sin(deg) + (y - ry0) * Math.cos(deg) + ry0;\n  }\n\n  if (returnArr) {\n    return [_x, _y];\n  }\n\n  return {\n    x: _x,\n    y: _y\n  };\n};\n\n//# sourceURL=webpack:///./src/utils/math.point-rotate.js?");

/***/ }),

/***/ "./src/utils/math.rect-meet.js":
/*!*************************************!*\
  !*** ./src/utils/math.rect-meet.js ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _mathPointRotate = _interopRequireDefault(__webpack_require__(/*! ./math.point-rotate.js */ \"./src/utils/math.point-rotate.js\"));\n\nvar _mathPointInRect = _interopRequireDefault(__webpack_require__(/*! ./math.point-in-rect.js */ \"./src/utils/math.point-in-rect.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\n// 判断矩形(x1,y1,w1,h1)围绕定点(rx,ry)旋转deg角度后，能否与矩形(x2,y2,w2,h2)相交\n// 用于跳过绘制的判断\n// 用中心点距离+上下左右分离的方式模糊判断\n// module.exports = function (x1, y1, w1, h1, x2, y2, w2, h2, rx, ry, deg) {\n//     var cx = x1 + w1 / 2;\n//     var cy = y1 + h1 / 2;\n//     var distance = Math.max(w1, h1) + Math.max(w2, h2);\n//     if (deg) {\n//         var newxy = pointRotate(cx, cy, rx, ry, deg);\n//         cx = newxy.x, cy = newxy.y;\n//     }\n//     // 中心点距离太远一定不meet\n//     var meet = Math.pow((cx - (x2 + w2 / 2)), 2) + Math.pow((cy - (y2 + y2 / 2)), 2) < Math.pow(distance, 2);\n//     if (!meet) return false;\n//     if (deg) {\n//         // 没必要计算4个点\n//         var point1 = pointRotate(x1, y1, rx, ry, deg);\n//         // var point2 = pointRotate(x1 + w1, y1, rx, ry, deg);\n//         var point3 = pointRotate(x1, y1 + h1, rx, ry, deg);\n//         // var point4 = pointRotate(x1 + w1, y1 + h1, rx, ry, deg);\n//         meet = Math.max(point1.x, point3) > x2 &&\n//             Math.min(point1.x, point3.x) < x2 + w2 &&\n//             Math.max(point1.y, point3.y) > y2 &&\n//             Math.min(point1.y, point3.y) < y2 + h2;\n//         // meet = Math.max(point1.x, point2.x, point3.x, point4.x) > x2 &&\n//         //  Math.min(point1.x, point2.x, point3.x, point4.x) < x2 + w2 &&\n//         //  Math.max(point1.y, point2.y, point3.y, point4.y) > y2 &&\n//         //  Math.min(point1.y, point2.y, point3.y, point4.y) < y2 + h2;\n//     } else {\n//         meet = Math.max(x1 + w1, x2 + w2) - Math.min(x1, x2) < w1 + w2 &&\n//             Math.max(y1 + h1, y2 + h2) - Math.min(y1, y2) < h1 + h2;\n//     }\n//     return meet;\n// };\nmodule.exports = function (x1, y1, w1, h1, x2, y2, w2, h2, rx, ry, deg) {\n  if (!deg) {\n    // 先快速判断几个明显不相交的场景，提升性能\n    if (y1 > y2 + h2) return false;\n    if (y2 > y1 + h1) return false;\n    if (x1 > x2 + w2) return false;\n    if (x2 > x1 + w1) return false;\n  }\n\n  var aMeetB = (0, _mathPointInRect[\"default\"])(x1, y1, x2, y2, w2, h2, rx, ry, deg) || (0, _mathPointInRect[\"default\"])(x1 + w1, y1, x2, y2, w2, h2, rx, ry, deg) || (0, _mathPointInRect[\"default\"])(x1, y1 + h1, x2, y2, w2, h2, rx, ry, deg) || (0, _mathPointInRect[\"default\"])(x1 + w1, y1 + h1, x2, y2, w2, h2, rx, ry, deg);\n  if (aMeetB) return true; // 将矩形1设置为原点，矩形2的xywh为：\n\n  var bMeetA = (0, _mathPointInRect[\"default\"])(x2, y2, x1, y1, w1, h1, rx, ry, -deg) || (0, _mathPointInRect[\"default\"])(x2 + w2, y2, x1, y1, w1, h1, rx, ry, -deg) || (0, _mathPointInRect[\"default\"])(x2, y2 + h2, x1, y1, w1, h1, rx, ry, -deg) || (0, _mathPointInRect[\"default\"])(x2 + w2, y2 + h2, x1, y1, w1, h1, rx, ry, -deg);\n  if (bMeetA) return true; // 十字形\n\n  if (y1 > y2 && y1 + h1 < y2 + h2 && x1 < x2 && x1 + w1 > x2 + w2) return true;\n  if (x1 > x2 && x1 + w1 < x2 + w2 && y1 < y2 && y1 + h1 > y2 + h2) return true;\n  return false;\n};\n\n//# sourceURL=webpack:///./src/utils/math.rect-meet.js?");

/***/ }),

/***/ "./src/utils/tick.js":
/*!***************************!*\
  !*** ./src/utils/tick.js ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar fallback = function fallback(callback) {\n  setTimeout(callback, 1000 / 60);\n};\n\nvar rAF = typeof requestAnimationFrame !== 'undefined' ? requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || fallback : fallback;\nmodule.exports = rAF;\n\n//# sourceURL=webpack:///./src/utils/tick.js?");

/***/ }),

/***/ "./src/utils/transition.js":
/*!*********************************!*\
  !*** ./src/utils/transition.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _utils = __webpack_require__(/*! ./utils.js */ \"./src/utils/utils.js\");\n\nvar PI = Math.PI;\n\nvar getLastPaintTime = function getLastPaintTime(transitions) {\n  return transitions.$lastPaintTime || Date.now();\n};\n\nvar types = {\n  linear: function linear(a, b, duration) {\n    var startTime = getLastPaintTime(this);\n    var loop = false;\n    var callback;\n\n    var resFunc = function () {\n      var currentTime = this.$lastPaintTime;\n      var progress = (currentTime - startTime) / duration;\n      var result = (b - a) * progress + a;\n\n      if (loop) {\n        if (b > a) {\n          while (result > b) {\n            result -= b - a;\n          }\n        } else {\n          while (result < b) {\n            result += a - b;\n          }\n        }\n      } else {\n        if (b > a && result > b) {\n          resFunc.$done = true;\n          result = b;\n        } else if (b < a && result < b) {\n          resFunc.$done = true;\n          result = b;\n        }\n      }\n\n      if (progress >= 1 && callback) {\n        callback.call(this, result);\n        callback = null;\n      }\n\n      return result;\n    }.bind(this);\n\n    resFunc.loop = function () {\n      loop = true;\n      return resFunc;\n    };\n\n    resFunc.restart = function () {\n      startTime = getLastPaintTime(this);\n      return resFunc;\n    };\n\n    resFunc.then = function (cb) {\n      callback = cb;\n      return resFunc;\n    };\n\n    return resFunc;\n  },\n  pendulum: function pendulum(a, b, duration, _config) {\n    var startTime = getLastPaintTime(this);\n    var config = _config || {};\n    config.start = config.start || 0;\n    var loop = false;\n    var callback;\n    var cycle = config.cycle || 1;\n\n    var resFunc = function () {\n      var currentTime = getLastPaintTime(this);\n      var progress = (currentTime - startTime) / duration;\n\n      if (!loop) {\n        if (cycle) {\n          if (progress > cycle) {\n            progress = cycle;\n            resFunc.$done = true;\n            progress = cycle;\n          }\n        } else if (progress > 1) {\n          resFunc.$done = true;\n          progress = 1;\n        }\n      } else {\n        if (cycle) {\n          progress %= cycle;\n        }\n      }\n\n      var deg = progress * PI * 2 - PI / 2 + config.start / 360 * PI;\n      var result = (b - a) * (Math.sin(deg) + 1) / 2 + a;\n\n      if (progress >= cycle && callback) {\n        callback.call(this, result);\n        callback = null;\n      }\n\n      return result;\n    }.bind(this);\n\n    resFunc.loop = function () {\n      loop = true;\n      return resFunc;\n    };\n\n    resFunc.restart = function () {\n      startTime = getLastPaintTime(this);\n      return resFunc;\n    };\n\n    resFunc.then = function (cb) {\n      callback = cb;\n      return resFunc;\n    };\n\n    return resFunc;\n  },\n  ease: function ease(a, b, duration) {\n    return this.pendulum(a, b, duration * 2, {\n      cycle: 0.5\n    });\n  },\n  oneByOne: function oneByOne(_arr) {\n    var arr = _arr;\n    var loop = false;\n\n    var resFunc = function resFunc() {\n      for (var _i = 0; _i < arr.length; _i++) {\n        if (!arr[_i].$done) {\n          return arr[_i]();\n        } else if (!arr[_i].$nextRestart) {\n          arr[_i].$nextRestart = true;\n\n          if (arr[_i + 1]) {\n            arr[_i + 1].restart();\n\n            return arr[_i + 1]();\n          }\n        }\n      }\n\n      if (loop) {\n        for (var _i2 = 0; _i2 < arr.length; _i2++) {\n          arr[_i2].$done = false;\n          arr[_i2].$nextRestart = false;\n\n          arr[_i2].restart();\n        }\n\n        return arr[0]();\n      }\n\n      return arr[arr.length - 1]();\n    };\n\n    resFunc.loop = function () {\n      loop = true;\n      return resFunc;\n    };\n\n    return resFunc;\n  }\n};\n\nvar transition = function transition(sprite, key, type, end, duration) {\n  var current = (0, _utils.funcOrValue)(sprite[key]);\n\n  if (true) {\n    if (typeof current === 'undefined') {\n      console.warn('[Easycanvas] start value in transition is undefined, using 0 instead.');\n    }\n  }\n\n  current = current || 0;\n  sprite[key] = types[type].bind(transition)(current, end, duration);\n};\n\nfor (var i in types) {\n  transition[i] = types[i];\n}\n\nmodule.exports = transition;\n\n//# sourceURL=webpack:///./src/utils/transition.js?");

/***/ }),

/***/ "./src/utils/utils.js":
/*!****************************!*\
  !*** ./src/utils/utils.js ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar utils = {\n  isArray: Array.isArray || function (arg) {\n    return Object.prototype.toString.call(arg) === '[object Array]';\n  },\n  funcOrValue: function funcOrValue(_funcOrValue, _this) {\n    if (typeof _funcOrValue === 'function') {\n      return _funcOrValue.call(_this, _this);\n    }\n\n    return _funcOrValue;\n  },\n  // 执行钩子函数或者钩子函数队列\n  execFuncs: function execFuncs(funcOrArray, _this, _arg) {\n    if (funcOrArray) {\n      if (!utils.isArray(_arg)) {\n        _arg = [_arg];\n      }\n    }\n\n    if (typeof funcOrArray === 'function') {\n      // return funcOrArray.apply(_this, _arg);\n      funcOrArray.apply(_this, _arg);\n    } else if (utils.isArray(funcOrArray)) {\n      // 返回值没用到\n      // let res = [];\n      // funcOrArray.length && funcOrArray.forEach((f) => {\n      //     res.push(f && f.apply(_this, _arg));\n      // });\n      // return res;\n      funcOrArray.length && funcOrArray.forEach(function (f) {\n        f && f.apply(_this, _arg);\n      });\n    }\n  },\n  blend: ['source-over', 'source-in', 'source-out', 'source-atop', 'destination-over', 'destination-in', 'destination-out', 'destination-atop', 'lighter', 'copy', 'xor', 'multiply', 'screen', 'overlay', 'darken', 'lighten', 'color-dodge', 'color-burn', 'hard-light', 'soft-light', 'difference', 'exclusion', 'hue', 'saturation', 'color', 'luminosity'],\n  pointInRect: function pointInRect(x, y, x1, x2, y1, y2) {\n    return !(x < x1 || x > x2 || y < y1 || y > y2);\n  },\n  firstValuable: function firstValuable(a, b, c) {\n    // 效率低\n    // for (let i = 0; i < arguments.length; i++) {\n    //     if (typeof arguments[i] !== 'undefined') {\n    //         return arguments[i];\n    //     }\n    // }\n    // return a === undefined ? (b === undefined ? c : b) : a;\n    return typeof a === 'undefined' ? typeof b === 'undefined' ? c : b : a;\n  }\n};\nmodule.exports = utils;\n\n//# sourceURL=webpack:///./src/utils/utils.js?");

/***/ }),

/***/ 1:
/*!****************************!*\
  !*** multi ./src/index.js ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("module.exports = __webpack_require__(/*! ./src/index.js */\"./src/index.js\");\n\n\n//# sourceURL=webpack:///multi_./src/index.js?");

/***/ })

/******/ })));