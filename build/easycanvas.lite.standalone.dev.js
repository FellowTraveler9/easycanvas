!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var a in n)("object"==typeof exports?exports:t)[a]=n[a]}}(this,function(){return function(t){function e(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return t[a].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(16)},function(t,e){"use strict";t.exports={funcOrValue:function(t,e){if("function"==typeof t){var n=t.call(e);return n&&void 0!==n.$$value?n.$$value:n}return t},execFuncs:function(t,e,n){"function"==typeof t?t.apply(e,n):Array.prototype.isPrototypeOf(t)&&t.forEach(function(t){t&&t.apply(e)})},getMinFromArray:function(t){var e=t[0];return t.forEach(function(t){e>t&&(e=t)}),e},getCharFromKey:function(t){return t.key||String.fromCharCode(t.keyCode)},noop:function(){},firstValuable:function(t,e){return void 0===t?e:t},assign:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}}},function(t,e){"use strict";t.exports={xywh:["sx","sy","sw","sh","tx","ty","tw","th"],txywh:["tx","ty","tw","th"],sxywh:["sx","sy","sw","sh"],devFlag:"__EASYCANVAS_DEVTOOL__"}},function(t,e){"use strict";var n=function(t,e,n,a,r){var i=r||1;return i>t-n?t-n>-i?i>e-a?e-a>-i?5:8:2:i>e-a?e-a>-i?4:7:1:i>e-a?e-a>-i?6:9:3},a={1:{x:-1,y:1},2:{x:0,y:1},3:{x:1,y:1},4:{x:-1,y:0},5:{x:0,y:0},6:{x:1,y:0},7:{x:-1,y:-1},8:{x:0,y:-1},9:{x:1,y:-1}};t.exports={num:n,xy:function(){var t=n.apply(this,arguments);return JSON.parse(JSON.stringify(a[t]||{}))},NUM2XAY:function(t){return JSON.parse(JSON.stringify(a[t]))},pointInRect:function(t,e,n,a,r,i){return!(n>t||t>a||r>e||e>i)},getDistanceSq:function(t,e,n,a){return(t-n)*(t-n)+(e-a)*(e-a)},enoughNear:function(t,e,n,a,r){return r*r>=(t-n)*(t-n)+(e-a)*(e-a)}}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(1),i=(a(r),n(3)),s=(a(i),!1),o=function(t,e){t.drag.draggingFlag=e,s=e},l=function(t,e,n,a){return t?t.call(e,n):!!a&&"drag"};t.exports={bind:function(t){var e={x:0,y:0};t.drag.draggingFlag=!1;var n=t.events.mousedown||t.events.touchstart;t.events.touchstart=t.events.mousedown=function(a){if(t.drag.dragable){o(t,!0);e.x=a.canvasX,e.y=a.canvasY}return l(n,t,a,t.drag.dragable)}.bind(t);var a=t.events.hold||t.events.mousemove;t.events.touchmove=t.events.mousemove=function(n){var r=t.drag.draggingFlag&&t.drag.dragable;return r&&(this.style.tx+=n.canvasX-e.x,this.style.ty+=n.canvasY-e.y,e.x=n.canvasX,e.y=n.canvasY),l(a,t,n,r)}.bind(t);var r=t.events.mouseup||t.events.touchend;t.events.touchend=t.events.mouseup=function(e){var n=t.drag.draggingFlag&&t.drag.dragable;return t.drag.draggingFlag&&t.drag.dragable&&o(t,!1),l(r,t,e,n)};var i=t.events.mouseout;t.events.mouseout=function(e){var n=t.drag.draggingFlag&&t.drag.dragable;return o(t,!1),l(i,t,e,n)};var s=t.events.click;t.events.click=function(e){var n=t.drag.dragable;if(n){return!s||s.call(t,e)}return l(s,t,e,n)}}}},function(t,e){"use strict";var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};t.exports=n},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(1),i=a(r),s=n(2),o=a(s),l=n(10),c=a(l),u=n(9),f=a(u),d=n(11),h=a(d),p=n(8),v=a(p),g=n(4),y=a(g),$=function(t){t.$id||(t.$id=Math.random().toString(36).substr(2)),t.content=t.content||{},t.style=t.style||{},t.style.zIndex=t.style.zIndex||0,t.style.mirrX=t.style.mirrX||0,t.style.opacity=void 0===t.style.opacity?1:t.style.opacity,t.style.locate=t.style.locate||"center",t.style.scale=t.style.scale||1;var e=i.default.funcOrValue(t.content.img);if(void 0===e&&(e={width:0,height:0}),o.default.xywh.forEach(function(e){t.style[e]=t.style[e]||0}),t.inherit=t.inherit||["tx","ty","scale"],t.drag=t.drag||{},t.events=t.events||{},t.events.eIndex=t.events.eIndex||0,t.events.through=!!t.events.through,t.scroll=t.scroll||{},t.scroll.scrollX=t.scroll.scrollX||0,t.scroll.scrollY=t.scroll.scrollY||0,t.hooks=t.hooks||{},t.name=t.name,!t.name&&t.content.img&&t.content.img.src){var n=t.content.img.src.match(/.*\/([^\/]*)$/);n&&n[1]&&(t.name=n[1])}return t.name=t.name||"Unnamed Easycanvas Object",t.children=t.children||[],t.children.forEach(function(e){e.$canvas=t.$canvas,e.$parent=t,e=new x(e)}),t.$cache={},t.$scroll={speedX:0,speedY:0},t},x=function(t){var e=$(t);for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(this[n]=e[n]);return this};x.prototype.add=function(t){return this.children=this.children||[],t.$canvas=this.$canvas,t.$parent=this,t.$id||(t=new x(t)),y.default.bind(t),t.children.forEach(function(e,n){t.children[n]=new x(e),t.children[n].$canvas=t.$canvas,t.children[n].$parent=t}),this.children.push(t),t},x.prototype.remove=function(t){return t?(this.$canvas.remove(t),void i.default.execFuncs(t.hooks.removed,t)):(this.$parent?this.$parent.remove(this):this.$canvas.remove(this),void i.default.execFuncs(this.hooks.removed,this))},x.prototype.on=c.default,x.prototype.off=f.default,x.prototype.trigger=h.default,x.prototype.broadcast=v.default,t.exports=x},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(1),i=a(r),s=n(5),o=a(s),l={},c=!1,u=[],f={stop:function(){c=!1},tick:function(){(0,o.default)(f.looper)},looper:function(){u.forEach(function(t,e){if(Math.abs(t.$scroll.speedX)>1?t.$scroll.speedX*=t.scroll.smooth||.8:t.$scroll.speedX=0,Math.abs(t.$scroll.speedY)>1?t.$scroll.speedY*=t.scroll.smooth||.8:t.$scroll.speedY=0,Math.abs(t.$scroll.speedX)<=1&&Math.abs(t.$scroll.speedY)<=1)return void u.splice(e,1);t.scroll.scrollY-=t.$scroll.speedY,t.scroll.scrollX-=t.$scroll.speedX;var n=i.default.funcOrValue(t.scroll.minScrollX,t),a=i.default.funcOrValue(t.scroll.maxScrollX,t),r=i.default.funcOrValue(t.scroll.minScrollY,t),s=i.default.funcOrValue(t.scroll.maxScrollY,t);!isNaN(r)&&r>t.scroll.scrollY?t.scroll.scrollY=r:!isNaN(s)&&t.scroll.scrollY>s&&(t.scroll.scrollY=s),!isNaN(n)&&n>t.scroll.scrollX?t.scroll.scrollX=n:!isNaN(a)&&t.scroll.scrollX>a&&(t.scroll.scrollX=a)}),f.tick()},touch:function(t,e){if(!t.scroll.scrollable)return!1;if(c){u.indexOf(t)===-1&&u.push(t);var n=Math.abs(e.canvasX-l.x),a=Math.abs(e.canvasY-l.y),r=+new Date-c;return c=+new Date,r/=10,n/r>1&&r>1&&(t.$scroll.speedX+=(e.canvasX-l.x)/r),a/r>1&&r>1&&(t.$scroll.speedY+=(e.canvasY-l.y)/r),l.x=e.canvasX,l.y=e.canvasY,!0}c=+new Date,l.x=e.canvasX,l.y=e.canvasY},wheel:function(t,e){u.indexOf(t)===-1&&u.push(t),t.$scroll.speedX=e.wheelDeltaX,t.$scroll.speedY=e.wheelDeltaY}};t.exports=f},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(1);a(r);t.exports=function(){var t=Array.prototype.slice.call(arguments),e=t.shift();this.hooks[e]&&this.hooks[e].apply(this,t),t.unshift(e),this.children&&this.children.forEach(function(e){e.broadcast.apply(e,t)}),this.paintList&&this.paintList.forEach(function(e){e.broadcast.apply(e,t)})}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(1);a(r);t.exports=function(t,e){this.hooks[t]&&(this.hooks[t]!==e&&e?Array.prototype.isPrototypeOf(this.hooks[t])&&(this.hooks[t][this.hooks[t].indexOf(e)]=void 0):delete this.hooks[t])}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(1);a(r);t.exports=function(t,e){this.hooks[t]?Array.prototype.isPrototypeOf(this.hooks[t])?this.hooks[t].push(e):this.hooks[t]=[this.hooks[t],e]:this.hooks[t]=e}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(1);a(r);t.exports=function(){var t=Array.prototype.slice.call(arguments),e=t.shift();this.hooks[e]&&this.hooks[e].apply(this,t)}},function(t,e){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a={},r=[],i="processing",s=0,o=function t(e,o,l){var c=l||{};if("object"===(void 0===e?"undefined":n(e))){var u=e;return c.callbackArgs=c.callbackArgs||[],void t(u.shift(),function(e){c.callbackArgs.push(e),u.length>1?t(u,o,c):t(u[0],function(t){c.callbackArgs.push(t),o(c.callbackArgs)},c)},l)}var f=e;if(c.alphaColor&&(f+=alphaColor),a[f]&&a[f]!==i)return setTimeout(function(){o&&o(a[f])}),a[f];var d=new Image;return c.block?(d.src=e,s++):0===s?d.src=e:r.push({imgObj:d,src:e}),a[f]=i,d.onload=function(){if(c.block&&(s--,0===s&&(r.forEach(function(t){t.imgObj.src=t.src}),r.splice(0))),c.cache){var t=document.createElement("canvas"),e=t.getContext("2d");if(t.width=d.width,t.height=d.height,e.drawImage(d,0,0),c.alphaColor){for(var n=e.getImageData(0,0,d.width,d.height),i=0;n.data.length>i;i+=4){var l=n.data[i]+n.data[i+1]+n.data[i+2],u=1;u>n.data[i]&&u>n.data[i+1]&&u>n.data[i+2]&&(n.data[i+3]=parseInt(l/255))}e.putImageData(n,0,0)}d=t}a[f]=d,o&&o(d)},d.onerror=function(){a[f]=d},d};t.exports=o},function(t,e){"use strict";t.exports=function(t){var e=t.width,n=t.height,a=document.createElement("canvas");a.width=e,a.height=n;var r=a.getContext("2d");r.scale(1,-1),r.translate(0,-n),r.drawImage(t,0,0);var i=r.getImageData(0,0,e,n);return{canvas:r,img:i}}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},i=n(2),s=a(i),o={getSprite:function(t){if(!window[s.default.devFlag].isPaintRecording)return[];var e={};if(t){var n=window[s.default.devFlag].$canvas[t].$canvas.paintList,a=window[s.default.devFlag].$canvas[t].$canvas.$paintList,i=function t(n){if(n.name!==s.default.devFlag){if(e[n.$id]={name:n.name,parent:n.$parent&&n.$parent.$id,style:{},children:n.children&&n.children.map(function(t){return t.$id})},n.content.img||n.content.text){e[n.$id].rendered=!1;for(var r=0,i=a.length;i>r;r++)if(a[r].$id===n.$id){e[n.$id].rendered=!0;break}}for(var o in n.style)"function"==typeof n.style[o]?(e[n.$id].style[o]=n.$cache[o],"function"==typeof n.$cache[o]&&(e[n.$id].style[o]="function")):e[n.$id].style[o]=n.style[o];n.physics&&(e[n.$id].physics=n.physics),n.children&&n.children.forEach(t)}};n.forEach(i)}else for(var o in window[s.default.devFlag].$canvas)e=r(e,window[s.default.devFlag].$plugin.getSprite(o));return e},selectSpriteById:function(t,e){if(!e){for(var n in window[s.default.devFlag].$canvas){var a=o.selectSpriteById(t,n);if(a)return{$sprite:a.$sprite||a,$canvas:window[s.default.devFlag].$canvas[n].$canvas}}return!1}var r=window[s.default.devFlag].$canvas[e].$canvas.paintList,i=function n(a){for(var r=0;a.length>r;r++){if(a[r].$id===t)return a[r];var i=n(a[r].children);if(i)return{$sprite:i.$sprite||i,$canvas:window[s.default.devFlag].$canvas[e].$canvas}}return!1},l=i(r);if(l)return{$sprite:l.$sprite||l,$canvas:window[s.default.devFlag].$canvas[e].$canvas}},updateSprite:function(t,e,n){var a=o.selectSpriteById(t,n).$sprite;a||console.warn("Sprite "+spriteId+" Not Found."),r(a.style,e)},highlightSprite:function(t,e,n){window[s.default.devFlag].selectMode=!!e;var a=o.selectSpriteById(t,n),r=a.$sprite,i=a.$canvas;e&&i&&r?i.$plugin.hook.selectSprite(!1,i,r):i&&i.$plugin.hook.cancelSelectSprite(i)},sendGlobalHook:function(t,e){var n=o.selectSpriteById(t,e),a=n.$sprite,r=n.$canvas;window.$ec===r.$id&&window.$es===a.$id||(console.warn("window.$ec = [Easycanvas "+r.$id+"], window.$es = [Easycanvas "+a.$id+"]"),window.$ec=r,window.$es=a)},pause:function(t,e){var n=window[s.default.devFlag].$canvas[t].$canvas;n.$pausing=void 0!==e?e:!n.$pausing}};window[s.default.devFlag]=window[s.default.devFlag]||{isPaintRecording:!1,selectMode:!1,peformance:{area:0,times:0},$plugin:o,$canvas:{},current:{}}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(6),i=a(r);t.exports={sprite:i.default}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(37),i=a(r),s=n(5),o=a(s),l=n(13),c=a(l),u=n(1),f=a(u),d=n(41),h=a(d),p=n(12),v=a(p),g=n(3),y=a(g),$=n(40),x=a($),m=n(39),w=a(m),_=n(15),b=a(_),k=n(14),F=(a(k),{painter:i.default,imgLoader:v.default,sequenceDiagram:x.default,multlineText:w.default,posCompare:y.default,transition:h.default,tick:o.default,utils:f.default,mirror:c.default,class:b.default,$version:"0.2.0"});window.Easycanvas=F,t.exports=F},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(21),i=a(r),s=n(19),o=a(s),l=n(23),c=a(l),u=n(18),f=a(u),d=n(4),h=a(d),p=n(22),v=a(p),g=n(36),y=a(g),$=n(1),x=(a($),{$paint:o.default,$eventHandler:f.default,$write:c.default,$perPaint:i.default,$bindDrag:h.default,$rAFer:v.default});x.$plugin=(0,y.default)(),t.exports=x},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(1),i=a(r),s=n(2),o=a(s),l=n(3),c=a(l),u=n(7),f=a(u),d=function(t){return t.sort(function(t,e){return window[o.default.devFlag]&&window[o.default.devFlag].selectMode?i.default.funcOrValue(t.style.zIndex,t)<i.default.funcOrValue(e.style.zIndex,e)?1:-1:i.default.funcOrValue(t.events.eIndex,t)<i.default.funcOrValue(e.events.eIndex,e)?1:-1})},h=function(t,e){if(i.default.funcOrValue(t.style.visible,t)===!1)return!1;if(t.$cache){var n=t.$cache.tx,a=t.$cache.ty,r=t.$cache.tw,s=t.$cache.th;return void 0!==n&&c.default.pointInRect(e.canvasX,e.canvasY,n,n+r,a,a+s)}},p=function t(e,n,a){if(e&&e.length)for(var r=0;e.length>r;r++){var s=e[r];s.children.length&&t(d(s.children.filter(function(t){return window[o.default.devFlag]&&window[o.default.devFlag].selectMode?i.default.funcOrValue(t.style.zIndex,t)>=0:i.default.funcOrValue(t.events.eIndex,t)>=0})),n,a),h(s,n)&&a.push(s),s.children.length&&t(d(s.children.filter(function(t){return window[o.default.devFlag]&&window[o.default.devFlag].selectMode?i.default.funcOrValue(t.style.zIndex,t)<0:i.default.funcOrValue(t.events.eIndex,t)<0})),n,a)}};t.exports=function(t){!t.layerX&&t.touches&&t.touches[0]&&(t.layerX=t.targetTouches[0].pageX-t.currentTarget.offsetLeft,t.layerY=t.targetTouches[0].pageY-t.currentTarget.offsetTop),!t.layerX&&t.changedTouches&&t.changedTouches[0]&&(t.layerX=t.changedTouches[0].pageX-t.currentTarget.offsetLeft,t.layerY=t.changedTouches[0].pageY-t.currentTarget.offsetTop);var e=parseInt(this.$dom.style.width)/this.contextWidth,n=parseInt(this.$dom.style.height)/this.contextHeight;e=e||1,n=n||1;var a={type:t.type,canvasX:t.layerX/e,canvasY:t.layerY/n,event:t},r=this,i=[];if(p(d(r.paintList),a,i),window[o.default.devFlag]&&window[o.default.devFlag].selectMode&&i.length){var s=i[0];if(s.name===o.default.devFlag&&(s=i[1]),s&&r.$plugin.hook.selectSprite("click"===t.type,r,s))return}r.eHoldingFlag||"mousedown"!==t.type&&"touchstart"!==t.type?!r.eHoldingFlag||"mouseup"!==t.type&&"touchend"!==t.type?!r.eHoldingFlag||"mousemove"!==t.type&&"touchmove"!==t.type||(r.eHoldingFlag=t):(r.eHoldingFlag=!1,f.default.stop()):r.eHoldingFlag=t;for(var l=0;i.length>l;l++){if(("mousemove"===t.type||"touchmove"===t.type)&&r.eLastMouseHover&&r.eLastMouseHover!==i[l]&&i.indexOf(r.eLastMouseHover)===-1){var c=r.eLastMouseHover.events.mouseout||r.eLastMouseHover.events.touchout;c&&c.call(r.eLastMouseHover,a)}if("mousewheel"===a.type)f.default.wheel(i[l],t);else if(r.eHoldingFlag&&"touchmove"===t.type&&f.default.touch(i[l],a))return;if(i[l].events){var u=i[l].events[t.type];if(u){r.eLastMouseHover=i[l];var h=u.call(i[l],a);if(h===!0)return r.eHoldingFlag=!1,h;if("drag"===h)return r.eHoldingFlag=!1,h}if(i[l].through===!1)return}}if(!i.length&&r.eLastMouseHover){var v=r.eLastMouseHover.events.mouseout;v&&v.call(r.eLastMouseHover,a),r.eLastMouseHover=null}var g=r.events[t.type];if(g&&g(a))return r.eHoldingFlag=!1,!0}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(1),i=(a(r),n(3)),s=a(i),o=function(t,e){var n=this,a=!1,r=t.props,i=t.settings;if("img"===t.type&&(200>n.$paintList.length||r[7]*r[8]>4e4))for(var o=e+1,l=n.$paintList.length;l>o;o++){var c=n.$paintList[o];if("img"===c.type&&"*"===c.imgType&&1===c.settings.globalAlpha&&!c.settings.rotate){var u=c.props;if(s.default.pointInRect(r[5],r[6],u[5],u[5]+u[7],u[6],u[6]+u[8])&&s.default.pointInRect(r[5]+r[7],r[6]+r[8],u[5],u[5]+u[7],u[6],u[6]+u[8]))return void(a=!0)}}var f=!1;1===i.globalAlpha||isNaN(i.globalAlpha)||(f||(n.$paintContext.save(),f=!0),n.$paintContext.globalAlpha=i.globalAlpha),i.translate&&(f||(n.$paintContext.save(),f=!0),n.$paintContext.translate(i.translate[0]||0,i.translate[1]||0)),i.rotate&&(f||(n.$paintContext.save(),f=!0),n.$paintContext.translate(i.translateBeforeRotate[0]||0,i.translateBeforeRotate[1]||0),n.$paintContext.rotate(i.rotate||0),n.$paintContext.translate(i.translateAfterRotate[0]||0,i.translateAfterRotate[1]||0)),i.scale&&(f||(n.$paintContext.save(),f=!0),n.$paintContext.scale(i.scale[0]||1,i.scale[1]||1)),i.transform&&(f||(n.$paintContext.save(),f=!0),n.$paintContext.transform(1,i.transform.fh,i.transform.fv,1,i.transform.fx,i.transform.fy)),"img"===t.type?(n.$paintContext.drawImage(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8]),n.$plugin.hook.drawImage(n,{img:r[0],tx:r[1],ty:r[2],tw:r[3],th:r[4]})):"text"===t.type&&r.content&&n.$write.call(n,r),f&&n.$paintContext.restore()};t.exports=function(){var t=this;t.$paintList.forEach(o.bind(t))}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(1),i=a(r),s=n(2);a(s);t.exports=function(t,e){var n={};for(var a in t.content)n[a]=i.default.funcOrValue(t.content[a],t);for(var r in t.style)n[r]=i.default.funcOrValue(t.style[r],t);if(n.img=t.content.img,n.img&&"sequence-diagram"===n.img.type){var s=n.img.config,o=n.img.index,l=void 0,c=void 0;l=0>s.w?n.img.img.width/(0-s.w):s.w>0?s.w:n.img.img.width,c=0>s.h?n.img.img.height/(0-s.h):s.h>0?s.h:n.img.img.height;var u=parseInt(n.img.img.width/l),f=parseInt(n.img.img.height/c);s.h&&(n.sx=o%u*l,n.sy=parseInt(o/u)%f*c),!s.loop&&o>0&&0===n.sx&&0===n.sy&&(n.img.img={}),n.img.lastTickTime=n.img.lastTickTime||0,e.$nextTickTime-n.img.lastTickTime<i.default.funcOrValue(s.interval,t)||(s.lastTickTime=e.$nextTickTime,n.img.index++,n.img.lastTickTime=e.$nextTickTime),n.sw=l||n.sw,n.sh=c||n.sh,n.tw=n.tw||l,n.th=n.th||c,n.img=n.img.img}return t.$tmp=n,n}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(1),i=a(r),s=n(38),o=a(s),l=n(2),c=a(l),u=n(20),f=a(u);t.exports=function(t,e){if(i.default.funcOrValue(t.style.visible,t)===!1)return void i.default.execFuncs(t.hooks.ticked,t);var n=this,a={},r=(0,f.default)(t,n),s=r.text,l=r.img;t.$parent&&(t.inherit.forEach(function(e){c.default.xywh.indexOf(e)<0&&["rotate"].indexOf(e)<0?["opacity","scale"].indexOf(e)<0||(r[e]=i.default.firstValuable(r[e],1),isNaN(t.$parent.$cache[e])||(r[e]*=t.$parent.$cache[e])):(r[e]=r[e]||0,r[e]+=i.default.funcOrValue(t.$parent.style[e]||0,t.$parent)||0)}),r.ty-=t.$parent.scroll.scrollY,r.tx-=t.$parent.scroll.scrollX);var u=i.default.funcOrValue(t.children,t),d=l?l.$width||l.width||0:0,h=l?l.$height||l.height||0:0;if(l&&!l.$width&&(l.$width=d,l.$height=h),r.tw=r.tw||r.sw||d,r.th=r.th||r.sh||h,r.sw=r.sw||d,r.sh=r.sh||h,"center"===r.locate?(r.tx=r.tx-.5*r.tw,r.ty=r.ty-.5*r.th):"rd"===r.locate&&(r.tx=r.tx-1*r.tw,r.ty=r.ty-1*r.th),(r.fh||r.fv)&&(a.transform={fh:r.fh,fv:r.fv,fx:(r.ty+r.th/2)*r.fv*-1+r.fx,fy:(r.tx+r.tw/2)*r.fh*-1+r.fy}),r.rotate){var p=void 0!==r.rx?r.rx:r.tx+.5*r.tw,v=void 0!==r.ry?r.ry:r.ty+.5*r.th;a.translateBeforeRotate=[p,v],a.rotate=-r.rotate*Math.PI/180,a.rotate=+a.rotate.toFixed(4),a.translateAfterRotate=[-p,-v]}if(1!==r.scale&&(r.tx-=.5*(r.scale-1)*r.tw,r.ty-=.5*(r.scale-1)*r.th,r.tw*=r.scale,r.th*=r.scale),r.mirrX?(a.translate=[n.contextWidth,0],a.scale=[-1,1],r.tx=n.contextWidth-r.tx-r.tw,r.mirrY&&(a.translate=[n.contextWidth,n.contextHeight],a.scale=[-1,-1],r.ty=n.contextHeight-r.ty-r.th)):r.mirrY&&(a.translate=[0,n.contextHeight],a.scale=[1,-1],r.ty=n.contextHeight-r.ty-r.th),!r.rotate&&!s){if(0>r.sx&&r.sw){var g=-r.sx/r.sw;r.tx+=r.tw*g,r.sx=0}if(0>r.sy&&r.sh){var y=-r.sy/r.sh;r.ty+=r.th*y,r.sy=0}if(d&&r.sx+r.sw>d){var $=(r.sx+r.sw-d)/r.sw;r.sw-=r.sw*$,r.tw-=r.tw*$}if(h&&r.sy+r.sh>h){var x=(r.sy+r.sh-h)/r.sh;r.sh-=r.sh*x,r.th-=r.th*x}if(0>r.tx&&r.tw){var m=-r.tx/r.tw;r.sx+=r.sw*m,r.sw-=r.sw*m,r.tw=r.tw+r.tx,r.tx=0}if(0>r.ty&&r.th){var w=-r.ty/r.th;r.sy+=r.sh*w,r.sh-=r.sh*w,r.th=r.th+r.ty,r.ty=0}if(r.tx+r.tw>n.contextWidth&&r.tw){var _=(r.tx+r.tw-n.contextWidth)/r.tw;r.tw-=r.tw*_,r.sw-=r.sw*_}if(r.ty+r.th>n.contextHeight&&r.th){var b=(r.ty+r.th-n.contextHeight)/r.th;r.th-=r.th*b,r.sh-=r.sh*b}}c.default.xywh.forEach(void 0!==t.$cache.tx?function(e){Math.abs(t.$cache[e]-r[e])>1&&(r[e]=parseInt(r[e]))}:function(t){r[t]=parseInt(r[t])});for(var k in r)t.$cache[k]=r[k];if(delete t.$cache.textBottom,l&&void 0===t.$cache.imgType&&(t.$cache.imgType=l.src?"png"===l.src.substr(-3)?"png":"*":"canvas"),!t.$cache.base64&&l&&l.src&&(t.$cache.base64="processing",(0,o.default)(l.src,function(e){t.$cache.base64=e})),u&&u.filter(function(t){return 0>t.style.zIndex}).sort(function(t,e){return t.style.zIndex===e.style.zIndex?0:t.style.zIndex>e.style.zIndex?1:-1}).forEach(function(t,e){n.$perPaint.call(n,t,e)}),a.globalAlpha=void 0!==r.opacity?r.opacity:1,l&&d&&0!==r.opacity&&r.sw&&r.sh&&n.contextWidth>r.tx&&n.contextHeight>r.ty&&n.$paintList.push({$id:t.$id,type:"img",settings:a,imgType:t.$cache.imgType,props:[l,r.sx,r.sy,r.sw,r.sh,r.tx,r.ty,r.tw,r.th]}),s){var F=r.tx,T=r.ty,A=t.style.align,M=i.default.funcOrValue(t.style.font,t)||"14px Arial",O=parseInt(M),I=t.style.lineHeight||O;if("center"===A?F+=r.tw/2:"right"===A&&(F+=r.tw),T+="top"===t.style.textVerticalAlign?O+(I-O)/2:"bottom"===t.style.textVerticalAlign?r.th-(I-O)/2:r.th/2+O/2,"string"==typeof s)n.$paintList.push({$id:t.$id,type:"text",settings:a,props:{tx:F,ty:T,content:s,align:A||"left",font:M,color:t.style.color||"white",type:t.style.textType||"fillText"}});else if("multline-text"===s.type){var S=s.text.split(/\t|\n/),E=function(t){var e=/[^\u4e00-\u9fa5]/;return!e.test(t)},H=[];S.forEach(function(t,e){t=String.prototype.trim.apply(t),s.config.start&&(t=t.replace(s.config.start,""));for(var n=0,a=r.tw;t.length&&t.length>n;)a>0||(a=r.tw,H.push(t.substr(0,n)),t=t.substr(n),n=0),n++,a-=O*(E(t[n])?1.05:.6);(t||e)&&H.push(t)}),H.forEach(function(e){n.$paintList.push({$id:t.$id,type:"text",settings:a,props:{tx:F,ty:T,content:e,align:A||"left",font:M,color:t.style.color||"white",type:t.style.textType||"fillText"}}),T+=I||O}),t.$cache.textBottom=T}}u&&u.filter(function(t){return!(0>t.style.zIndex)}).sort(function(t,e){return t.style.zIndex===e.style.zIndex?0:t.style.zIndex>e.style.zIndex?1:-1}).forEach(function(t,e){n.$perPaint.call(n,t,e)}),i.default.execFuncs(t.hooks.ticked,t)}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(5),i=a(r);t.exports=function(t){var e=(new Date).getTime();this.$nextTickTime=e,1e3>e-this.fpsCalculateTime||(this.fpsCalculateTime=e,this.fpsHandler&&this.fpsHandler.call(this,this.fps),this.lastFps=this.fps,this.fps=0),(0,i.default)(function(n){if(this.$rafTime=n,this.$rAFer(t),this.maxFps>0&&60>this.maxFps){if(1e3/this.maxFps>=e-this.$lastPaintTime)return;this.$lastPaintTime=e-(e-this.$lastPaintTime)%(1e3/this.maxFps)}t()}.bind(this))}},function(t,e){"use strict";t.exports=function(t){this.$paintContext.font=t.font,this.$paintContext.strokeStyle=t.color,this.$paintContext.fillStyle=t.color,this.$paintContext.textAlign=t.align,this.$paintContext[t.type||"fillText"](t.content,parseInt(t.tx),parseInt(t.ty))}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(25),i=a(r),s=n(32),o=a(s),l=n(35),c=a(l),u=n(28),f=a(u),d=n(26),h=a(d),p=n(29),v=a(p),g=n(10),y=a(g),$=n(9),x=a($),m=n(11),w=a(m),_=n(8),b=a(_),k=n(27),F=a(k),T=n(30),A=a(T),M=n(33),O=a(M),I=n(34),S=a(I),E={start:c.default,paint:f.default,add:i.default,remove:o.default,register:A.default,clear:h.default,setFpsHandler:O.default,setMaxFps:S.default,pause:v.default,on:y.default,off:x.default,trigger:w.default,broadcast:b.default,nextTick:F.default};t.exports=E},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(1),i=(a(r),n(6)),s=a(i),o=n(4),l=a(o),c=function(t){if(t){var e=this,n=t;return n.$canvas=e,n.$id||(n=new s.default(n)),l.default.bind(n),n.children.forEach(function(t,a){n.children[a]=new s.default(t),n.children[a].$canvas=e,n.children[a].$parent=n}),e.paintList.push(n),e.$plugin.hook.updateTree(e),n}};t.exports=c},function(t,e){"use strict";t.exports=function(){this.paintList=[]}},function(t,e){"use strict";t.exports=function(t){var e=function e(){t.apply(this,arguments),this.off("nextTick",e)};this.on("nextTick",e.bind(this))}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(1),i=a(r);t.exports=function(){if(!this.$pausing&&!document.hidden){var t=this;i.default.execFuncs(t.hooks.ticked,t,[t.$rafTime]),t.$paintContext.clearRect(0,0,this.contextWidth,this.contextHeight),t.$freezing||(t.$paintList=[],this.paintList.sort(function(t,e){var n=i.default.funcOrValue(t.style.zIndex,t),a=i.default.funcOrValue(e.style.zIndex,e);return n===a?0:n>a?1:-1}).forEach(function(e,n){t.$perPaint(e,n)})),t.$paint(),this.fps++,t.hooks.nextTick&&(i.default.execFuncs(t.hooks.nextTick,t,[t.$rafTime]),delete t.hooks.nextTick)}}},function(t,e){"use strict";t.exports=function(t){this.$pausing=void 0===t||t}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(31),i=a(r),s=n(7),o=a(s);t.exports=function(t,e){var n=this;for(var a in i.default)this[a]=i.default[a];var r=e||{};this.$dom=t,this.$paintContext=t.getContext("2d"),this.width=this.contextWidth=r.width||t.width,this.height=this.contextHeight=r.height||t.height,this.$plugin.hook.register(this),this.events=r.events||{},this.hooks=r.hooks||{};var s=["contextmenu","mousewheel","click","dblclick","mousedown","mouseup","mousemove","touchstart","touchend","touchmove"];s.forEach(function(e){t.addEventListener(e,n.$eventHandler.bind(n))}),o.default.tick(),setInterval(function(){if(n.eHoldingFlag){var t=n.eHoldingFlag;n.$eventHandler.call(n,{layerX:t.layerX,layerY:t.layerY,screenX:t.screenX||t.layerX,screenY:t.screenY||t.layerY,type:"hold"})}},40)}},function(t,e,n){"use strict";var a={$dom:null,$paintContext:null,$nextTickTime:0,$lastPaintTime:0,$pausing:!1,$freezing:!1,fps:0,lastFps:0,fpsCalculateTime:0,fpsHandler:null,contextWidth:0,contextHeight:0,events:{click:null},paintList:[],eHoldingFlag:!1,eLastMouseHover:null,maxFps:-1,scroll:{scrollable:!1,scrollY:0,minScrollY:void 0,maxScrollY:void 0},$flags:{dragging:!1}};a.fpsHandler=function(t){this.maxFps>0&&.5*this.maxFps>t&&console.warn("Low FPS detected("+t+"), max FPS in settings is "+this.maxFps+".")},t.exports=a},function(t,e,n){"use strict";t.exports=function(t,e){t.style.visible=!1,t.removing=!0,setTimeout(function(){t.$parent?t.$parent.children=t.$parent.children.filter(function(t){return t.removing!==!0}):this.paintList=this.paintList.filter(function(t){return t.removing!==!0})}.bind(this)),e&&this.paintList.splice(this.paintList.indexOf(t),1);var n=this;n.$plugin.hook.updateTree(n)}},function(t,e){"use strict";t.exports=function(t){this.fpsHandler=t}},function(t,e){"use strict";t.exports=function(t){this.maxFps=t||-1}},function(t,e){"use strict";t.exports=function(){this.fpsCalculateTime=(new Date).getTime(),this.$rAFer(this.paint.bind(this))}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var _utils=__webpack_require__(1),_utils2=_interopRequireDefault(_utils),_constants=__webpack_require__(2),_constants2=_interopRequireDefault(_constants);module.exports=function(){var TO_PANEL_EVENT_NAME="__EASYCANVAS_BRIDGE_TOPANEL__";window.document.addEventListener("__EASYCANVAS_BRIDGE_TODOC__",function(recieveData){var data=recieveData.detail;(data.action="code")&&(console.log(data.content),eval(data.content))});var $emit=function(t){t.tabId=window[_constants2.default.devFlag].tabId,window.document.dispatchEvent(new CustomEvent(TO_PANEL_EVENT_NAME,{detail:JSON.parse(JSON.stringify(t))}))};setTimeout(function(){$emit({name:"init"})});var $selectMask=null,maskCanvas=document.createElement("img");return maskCanvas.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQYV2OYePb/fwAHrQNdl+exzgAAAABJRU5ErkJggg==",{hook:{drawImage:function(t,e){window[_constants2.default.devFlag].isPaintRecording&&(window[_constants2.default.devFlag].peformance.area+=e.tw*e.th,window[_constants2.default.devFlag].peformance.times++)},updateTree:function(t){window[_constants2.default.devFlag].isPaintRecording&&$emit({name:"updateTree",id:t.$id})},register:function(t){t.$id=Math.random().toString(36).substr(2),t.$flags.devtoolHanged||window[_constants2.default.devFlag].$canvas[t.$id]||(window[_constants2.default.devFlag].$canvas[t.$id]={$canvas:t},t.$flags.devtoolHanged=!0)},selectSprite:function(t,e,n){if(!n||!window[_constants2.default.devFlag].selectMode)return!1;$selectMask||($selectMask=e.add({name:_constants2.default.devFlag,content:{img:maskCanvas},style:{}}));var a=function(t){!function(e){_constants2.default.sxywh.indexOf(t)<0&&($selectMask.style[e]=function(){return n.$cache[e]||0})}(t)};for(var r in n.$cache)a(r);return $selectMask.style.scale=1,$selectMask.style.locate="lt",$selectMask.style.zIndex=Number.MAX_SAFE_INTEGER,$selectMask.style.visible=function(){return window[_constants2.default.devFlag].selectMode},$selectMask.style.opacity=.8,t&&(e.remove($selectMask),$selectMask=null,$emit({name:"selectSprite",id:e.$id,value:{sprite:n.$id,canvas:e.$id}}),window[_constants2.default.devFlag].current={$sprite:n,$canvas:e},window[_constants2.default.devFlag].selectMode=!1),!0},cancelSelectSprite:function(t){t.remove($selectMask),$selectMask=null}}}}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(24),i=a(r),s=n(17),o=a(s),l=function(){};for(var c in o.default)Object.prototype.hasOwnProperty.call(o.default,c)&&(l.prototype[c]=o.default[c]);for(var u in i.default)Object.prototype.hasOwnProperty.call(i.default,u)&&(l.prototype[u]=i.default[u]);t.exports=l},function(t,e){"use strict";function n(t,e){if(t&&t.match(/^data:/))return void(e&&e(t));if(r[t])return void(r[t]!==a?e(r[t]):setTimeout(function(){n(t,e)},100));r[t]=a;var i=new XMLHttpRequest;i.onload=function(){var n=new FileReader;n.onloadend=function(){r[t]=n.result,e&&e(n.result)},n.readAsDataURL(i.response)},i.open("GET",t),i.responseType="blob",i.send()}var a="processing",r={};t.exports=n},function(t,e){"use strict";t.exports=function(t,e){return{type:"multline-text",text:t,config:e}}},function(t,e){"use strict";t.exports=function(t,e){return{type:"sequence-diagram",index:0,img:t,config:e}}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(1),s=a(i),o=[],l=3.141593,c=function(t){return t/1e3*60},u={linear:function(t,e,n){var a=o.length;o.push(t);var r=!1,i=function(){var i=o[a];return i>=t&&e>i||i>e&&t>=i?(o[a]+=(e-t)/c(n),{$$value:i,$$over:!1}):(r&&(o[a]=t),{$$value:e,$$over:!0,$$loop:function(){o[a]=t}})};return i.loop=function(){return r=!0,i},i},pendulum:function(t,e,n,a){var r=a||{};r.start=s.default.firstValuable(r.start,-l),r.end=s.default.firstValuable(r.end,l),r.cycle=s.default.firstValuable(r.cycle,2*l);var i=o.length;o.push(r.start);var u=!1,f=!1,d=function(){var a=Math.cos(o[i])+1;return o[i]+=l/c(n),o[i]>r.end&&(u?o[i]-=r.cycle:o[i]=r.end),{$$value:s.default.funcOrValue(t)+(s.default.funcOrValue(e)-s.default.funcOrValue(t))*a/2,$$over:!f&&o[i]>=r.end,
$$loop:function(){o[i]=-l}}};return d.loop=function(){return u=!0,d},d.stay=function(){return f=!0,d},d},halfPendulum:function(t,e,n){return u.pendulum(t,e,n,{start:-l,end:0,cycle:l})},oneByOne:function(t){var e=t,n=!1,a=function(){for(var t=0;e.length>t;t++){var a=e[t]();if("object"===(void 0===a?"undefined":r(a))){if(!a.$$over)return a.$$value}else if(a!==!1)return a}if(n){for(var i=void 0,s=0;e.length>s;s++){var o=e[s]();o&&o.$$loop&&(o.$$loop(),i=i||e[s]())}return i}};return a.loop=function(){return n=!0,a},a}};t.exports=u}])});