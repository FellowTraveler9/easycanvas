!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var a in n)("object"==typeof exports?exports:t)[a]=n[a]}}(this,function(){return function(t){function e(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return t[a].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(9)},function(t,e){"use strict";t.exports={funcOrValue:function(t,e){if("function"==typeof t){var n=t.call(e);return n&&n.$$value?n.$$value:n}return t},cent2value:function(t,e){return"string"==typeof t&&t&&e&&"%"===t[t.length-1]?e*+t.substr(0,t.length-1)/100:t},getMinFromArray:function(t){var e=t[0];return t.forEach(function(t){e>t&&(e=t)}),e},getCharFromKey:function(t){return t.key||String.fromCharCode(t.keyCode)},noop:function(){},firstValuable:function(t,e){return void 0===t?e:t}}},function(t,e){"use strict";var n=function(t,e,n,a,r){var i=r||1;return i>t-n?t-n>-i?i>e-a?e-a>-i?5:8:2:i>e-a?e-a>-i?4:7:1:i>e-a?e-a>-i?6:9:3},a={1:{x:-1,y:1},2:{x:0,y:1},3:{x:1,y:1},4:{x:-1,y:0},5:{x:0,y:0},6:{x:1,y:0},7:{x:-1,y:-1},8:{x:0,y:-1},9:{x:1,y:-1}};t.exports={num:n,xy:function(){var t=n.apply(this,arguments);return JSON.parse(JSON.stringify(a[t]||{}))},NUM2XAY:function(t){return JSON.parse(JSON.stringify(a[t]))},pointInRect:function(t,e,n,a,r,i){return!(n>t||t>a||r>e||e>i)},getDistanceSq:function(t,e,n,a){return(t-n)*(t-n)+(e-a)*(e-a)},enoughNear:function(t,e,n,a,r){return r*r>=(t-n)*(t-n)+(e-a)*(e-a)}}},function(t,e){"use strict";var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};t.exports=n},function(t,e){"use strict";var n={};t.exports=function(t,e,a){var r=t;if(a&&(r+=JSON.stringify(a)),n[r]&&"processing"!==n[r])return setTimeout(function(){e&&e(n[r])}),n[r];var i=new Image;return i.src=t,n[r]="processing",i.onload=function(){var t=a||{};if(t.alphaColor){var o=document.createElement("canvas"),u=o.getContext("2d");o.width=i.width,o.height=i.height,u.drawImage(i,0,0);for(var l=u.getImageData(0,0,i.width,i.height),s=0;l.data.length>s;s+=4){var c=l.data[s]+l.data[s+1]+l.data[s+2],f=1;f>l.data[s]&&f>l.data[s+1]&&f>l.data[s+2]&&(l.data[s+3]=parseInt(c/255))}u.putImageData(l,0,0),i=o}n[r]=i,e&&e(i)},i.onerror=function(){n[r]=i},i}},function(t,e){"use strict";t.exports=function(t){var e=t.width,n=t.height,a=document.createElement("canvas");a.width=e,a.height=n;var r=a.getContext("2d");r.scale(1,-1),r.translate(0,-n),r.drawImage(t,0,0);var i=r.getImageData(0,0,e,n);return{canvas:r,img:i}}},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(3),o=a(i),u=n(1),l=a(u),s=n(2),c=a(s),f=function(){},d={canvasDom:null,paintContext:null,nextTickTime:0,pausing:!1,fps:0,fpsCalculateTime:0,fpsHandler:null,contextWidth:0,contextHeight:0,missingEvents:{click:null},paintList:[],eHoldingFlag:!1,eLastMouseHover:null,maxFps:-1,lastPaintTime:0},h={clear:function(){this.paintList.splice(0)},setFpsHandler:function(t){this.fpsHandler=t},setMaxFps:function(t){this.maxFps=t||-1},pause:function(t){this.pausing=void 0===t||t},preAdd:function(t){var e=l.default.funcOrValue(t.img);return t.zIndex=t.zIndex||0,t.sx=l.default.cent2value(t.sx||0,e.width),t.sy=l.default.cent2value(t.sy||0,e.height),t.tx=l.default.cent2value(t.tx||0,this.contextWidth),t.ty=l.default.cent2value(t.ty||0,this.contextHeight),t.sw=l.default.cent2value(t.sw||e.width,e.width),t.sh=l.default.cent2value(t.sh||e.height,e.height),t.tw=l.default.cent2value(t.tw||0,this.contextWidth),t.th=l.default.cent2value(t.th||0,this.contextHeight),t.mirrX=t.mirrX||0,t.opacity=void 0===t.opacity?1:t.opacity,t.marginX=t.marginX||0,t.marginY=t.marginY||0,t.events=t.events||{},t.eIndex=t.eIndex||0,t.locate=t.locate||"center",t.visible=t.visible,t.passEvent=t.passEvent,t.perTickHandler=t.perTickHandler,t},preChildren:function(t,e){var n=this.preAdd(t);return"relative"===t.position&&(n.$marginX=n.tx+e.tx,n.$marginY=n.ty+e.ty),t},add:function(t){if(t){var e=t,n=l.default.funcOrValue(e.img);if(this.preAdd(e),e.$cache={},e.dragable){var a={x:0,y:0},i=!1,o=e.events.mousedown||e.events.touchstart;e.events.touchstart=e.events.mousedown=function(t){if(i=!0,"object"===r(e.dragable)){var n=t.layerX-this.tx,u=t.layerY-this.ty;if(!c.default.pointInRect(n,u,l.default.funcOrValue(e.dragable.x1,e),l.default.funcOrValue(e.dragable.x2,e),l.default.funcOrValue(e.dragable.y1,e),l.default.funcOrValue(e.dragable.y2,e)))return i=!1,o?o.call(e,t):void 0}return a.x=t.screenX||t.layerX,a.y=t.screenY||t.layerY,o?o.call(e,t):"drag"}.bind(e);var u=e.events.mousehold;e.events.touchmove=e.events.mousemove=function(t){return i&&(this.tx+=(t.screenX||t.layerX)-a.x,this.ty+=(t.screenY||t.layerY)-a.y,a.x=t.screenX||t.layerX,a.y=t.screenY||t.layerY),u?u.call(e,t):"drag"}.bind(e);var s=e.events.mouseup||e.events.touchend;e.events.touchend=e.events.mouseup=function(t){return i=!1,s?s.call(e,t):"drag"};var f=e.events.mouseout;e.events.mouseout=function(t){return i=!1,f?f.call(e,t):"drag"};var d=e.events.click;e.events.click=function(t){var n=t.layerX-this.tx,a=t.layerY-this.ty;return c.default.pointInRect(n,a,l.default.funcOrValue(e.dragable.x1,e),l.default.funcOrValue(e.dragable.x2,e),l.default.funcOrValue(e.dragable.y1,e),l.default.funcOrValue(e.dragable.y2,e))?(t.preventDefault(),!d||d.call(e,t)):!!d&&d.call(e,t)}}if(e.loop){e.loop.x>0&&(e.loop.x=0-n.width/e.loop.x),e.loop.y>0&&(e.loop.y=0-n.height/e.loop.y);var h=n.width/(0-e.loop.x),p=n.height/(0-e.loop.y);e.tw=e.tw||h,e.th=e.th||p,e.loop.px=h,e.loop.py=p,e.loop.index=e.loop.index||0,e.loop.interval=e.loop.interval||16,e.loop.lastTickTime=0,void 0===e.loop.circle&&(e.loop.circle=!0)}return this.paintList.push(e),e}},remove:function(t,e){t.visible=!1,t.removing=!0,setTimeout(function(){this.paintList=this.paintList.filter(function(t){return t.removing!==!0})}.bind(this)),e&&this.paintList.splice(this.paintList.indexOf(t),1)},register:function(t,e){for(var n in d)this[n]=JSON.parse(JSON.stringify(d[n]));this.canvasDom=t,this.paintContext=t.getContext("2d"),this.contextWidth=t.width,this.contextHeight=t.height;var a=e||{};this.missingEvents=a.events||{};var r=this,i=["contextmenu","click","dblclick","mousedown","mouseup","mousemove","touchstart","touchend","touchmove"];i.forEach(function(e){t.addEventListener(e,r.$handler.bind(r))}),setInterval(function(){if(this.eHoldingFlag){var t=this.eHoldingFlag;this.$handler.call(this,{layerX:t.layerX,layerY:t.layerY,screenX:t.screenX||t.layerX,screenY:t.screenY||t.layerY,type:"mousehold"})}}.bind(r),40)},$visibles:function(){return this.paintList.filter(function(t){return l.default.funcOrValue(t.visible,t)!==!1})},$handler:function(t){!t.layerX&&t.touches&&t.touches[0]&&(t.layerX=t.targetTouches[0].pageX-t.currentTarget.offsetLeft,t.layerY=t.targetTouches[0].pageY-t.currentTarget.offsetTop);var e=this,n=e.paintList.filter(function(e){if(l.default.funcOrValue(e.visible,e)===!1)return!1;e.$cache||(e.$cache={});var n=e.$cache.tx||l.default.funcOrValue(e.tx,e),a=e.$cache.ty||l.default.funcOrValue(e.ty,e),r=e.$cache.tw||l.default.funcOrValue(e.tw,e),i=e.$cache.th||l.default.funcOrValue(e.th,e);return void 0===e.$cache.tx&&"center"===e.locate&&(n-=.5*r,a-=.5*i),c.default.pointInRect(t.layerX,t.layerY,n,n+r,a,a+i)}).sort(function(t,e){return l.default.funcOrValue(t.eIndex,t)<l.default.funcOrValue(e.eIndex,e)?1:-1});e.eHoldingFlag||"mousedown"!==t.type&&"touchstart"!==t.type?!e.eHoldingFlag||"mouseup"!==t.type&&"touchend"!==t.type?!e.eHoldingFlag||"mousemove"!==t.type&&"touchmove"!==t.type||(e.eHoldingFlag=t):e.eHoldingFlag=!1:e.eHoldingFlag=t;for(var a=0;n.length>a;a++){var r=n[a].events[t.type];if(("mousemove"===t.type||"touchmove"===t.type)&&e.eLastMouseHover&&e.eLastMouseHover!==n[a]&&n.indexOf(e.eLastMouseHover)===-1){var i=e.eLastMouseHover.events.mouseout;i&&i.call(e.eLastMouseHover,t)}if(r){e.eLastMouseHover=n[a];var o=r.call(n[a],t);if(o===!0)return e.eHoldingFlag=!1,o;if("drag"===o)return e.eHoldingFlag=!1,o}if(n[a].passEvent===!1)return}if(!n.length&&e.eLastMouseHover){var i=e.eLastMouseHover.events.mouseout;i&&i.call(e.eLastMouseHover,t),e.eLastMouseHover=null}var r=e.missingEvents[t.type];if(r&&r(t))return e.eHoldingFlag=!1,!0},start:function(){this.$rAFer(this.paint.bind(this))},write:function(t){this.paintContext.font=t.font,this.paintContext.strokeStyle=t.style,this.paintContext.fillStyle=t.style,this.paintContext.textAlign=t.align||"left",this.paintContext[t.type||"fillText"](t.content,parseInt(t.tx),parseInt(t.ty))},paint:function(){if(!this.pausing){this.paintContext.clearRect(0,0,this.contextWidth,this.contextHeight);var t=this;this.paintList.sort(function(t,e){return l.default.funcOrValue(t.zIndex,t)>l.default.funcOrValue(e.zIndex,e)?1:-1}).forEach(function(e,n){t.$perPaint(e,n)}),this.fps++}},$perPaint:function(t,e){if(t.perTickHandler&&t.perTickHandler.call(t),l.default.funcOrValue(t.visible,t)!==!1){var n=this,a=l.default.funcOrValue(t.img),r=l.default.cent2value(l.default.funcOrValue(t.sx,t),a.width),i=l.default.cent2value(l.default.funcOrValue(t.sy,t),a.height),o=l.default.cent2value(l.default.funcOrValue(t.tx,t),n.contextWidth)+t.marginY,u=l.default.cent2value(l.default.funcOrValue(t.ty,t),n.contextHeight)+t.marginY,s=l.default.cent2value(l.default.funcOrValue(t.sw,t)||a.width,a.width),c=l.default.cent2value(l.default.funcOrValue(t.sh,t)||a.height,a.height),f=l.default.cent2value(l.default.funcOrValue(t.tw,t),n.contextWidth),d=l.default.cent2value(l.default.funcOrValue(t.th,t),n.contextHeight),h=l.default.funcOrValue(t.opacity,t),p=l.default.funcOrValue(t.rotate,t),v=l.default.funcOrValue(t.rx,t),y=l.default.funcOrValue(t.ry,t),x=l.default.funcOrValue(t.mirrX,t),g=l.default.funcOrValue(t.locate,t),m=l.default.funcOrValue(t.children,t);if(0!==a.width){if(t.loop){var w=t.loop.px,O=t.loop.py,$=t.loop.index;if(0>$&&($=0),t.loop.x&&(r=$%(0-t.loop.x)*w,i=parseInt($/(0-t.loop.x))%(0-t.loop.y)*O),!t.loop.circle&&$>0&&0===r&&0===i)return void this.remove(t);this.nextTickTime-t.loop.lastTickTime<l.default.funcOrValue(t.loop.interval,t)||(t.loop.lastTickTime=this.nextTickTime,t.loop.index++),s=w||s,c=O||c,f=f||w,d=d||O}if(f=f||s||a.width,d=d||c||a.height,"center"===g&&(o-=.5*f,u-=.5*d),p){this.paintContext.save();var b=void 0!==v?v:o+.5*f,V=void 0!==y?y:u+.5*d;this.paintContext.translate(b,V),this.paintContext.rotate(-p*Math.PI/180),this.paintContext.translate(-b,-V)}if(x&&(this.paintContext.save(),this.paintContext.translate(this.contextWidth,0),this.paintContext.scale(-1,1),o=this.contextWidth-o-f),1!==t.opacity&&(this.paintContext.globalAlpha=h),0>r&&s){var H=-r/s;o+=f*H,r=0}if(0>i&&c){var H=-i/c;u+=d*H,i=0}if(r+s>a.width){var H=(r+s-a.width)/s;s-=s*H,f-=f*H}if(i+c>a.height){var H=(i+c-a.height)/c;c-=c*H,d-=d*H}o=parseInt(o)+(t.$marginX||0),u=parseInt(u)+(t.$marginY||0),f=parseInt(f),d=parseInt(d),c=parseInt(c),s=parseInt(s),r=parseInt(r),i=parseInt(i),t.$cache={tx:o,ty:u,tw:f,th:d,$inherit:{tx:o+("center"===g?.5*f:0),ty:u+("center"===g?.5*d:0)}},m&&m.filter(function(t){return 0>t.zIndex}).sort(function(t,e){return t.zIndex>e.zIndex?1:-1}).forEach(function(e,a){n.$perPaint.call(n,n.preChildren(e,t.$cache.$inherit),a)}),s&&c&&this.canvasDom.width>o&&this.canvasDom.height>u&&this.paintContext.drawImage(a,r,i,s,c,o,u,f,d),m&&m.filter(function(t){return t.zIndex>0}).sort(function(t,e){return t.zIndex>e.zIndex?1:-1}).forEach(function(e,a){n.$perPaint.call(n,n.preChildren(e,t.$cache.$inherit),a)}),1!==t.opacity&&(this.paintContext.globalAlpha=1);var I=l.default.funcOrValue(t.text,t);I&&I.forEach(function(e){var a=l.default.funcOrValue(e);a&&n.write({tx:o+l.default.funcOrValue(a.tx,t),ty:u+l.default.funcOrValue(a.ty,t),content:l.default.funcOrValue(a.content,t)||"",align:a.align,font:a.font||"14px Courier New",style:a.style||"white",type:a.type||"fillText"})}),t.tw=t.tw||f,t.th=t.th||d,p&&this.paintContext.restore(),x&&this.paintContext.restore()}}},$rAFer:function(t){var e=(new Date).getTime();this.nextTickTime=e,e-this.fpsCalculateTime>1e3&&(this.fpsCalculateTime=e,this.fpsHandler&&this.fpsHandler(this.fps),this.fps=0),(0,o.default)(function(){if(this.$rAFer(t),this.maxFps>0){if(1e3/this.maxFps>e-this.lastPaintTime)return;this.lastPaintTime=e}t()}.bind(this))}};for(var p in h)Object.prototype.hasOwnProperty.call(h,p)&&(f.prototype[p]=h[p]);t.exports=f},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(1),o=a(i),u=[],l=3.141593,s=function(t){return t/1e3*60},c={linear:function(t,e,n){var a=u.length;u.push(t);var r=!1,i=function(){var i=u[a];return i>=t&&e>i||i>e&&t>=i?(u[a]+=(e-t)/s(n),{$$value:i,$$over:!1}):(r&&(u[a]=t),{$$value:e,$$over:!0,$$loop:function(){u[a]=t}})};return i.loop=function(){return r=!0,i},i},pendulum:function(t,e,n,a){var r=a||{};r.start=o.default.firstValuable(r.start,-l),r.end=o.default.firstValuable(r.end,l),r.cycle=o.default.firstValuable(r.cycle,2*l);var i=u.length;u.push(r.start);var c=!1,f=!1,d=function(){var a=Math.cos(u[i])+1;return u[i]+=l/s(n),u[i]>r.end&&(c?u[i]-=r.cycle:u[i]=r.end),{$$value:o.default.funcOrValue(t)+(o.default.funcOrValue(e)-o.default.funcOrValue(t))*a/2,$$over:!f&&u[i]>=r.end,$$loop:function(){u[i]=-l}}};return d.loop=function(){return c=!0,d},d.stay=function(){return f=!0,d},d},halfPendulum:function(t,e,n){return c.pendulum(t,e,n,{start:-l,end:0,cycle:l})},oneByOne:function(t){var e=t,n=!1,a=function(){for(var t=0;e.length>t;t++){var a=e[t]();if("object"===(void 0===a?"undefined":r(a))){if(!a.$$over)return a.$$value}else if(a!==!1)return a}if(n){for(var a,t=0;e.length>t;t++){var i=e[t]();i&&i.$$loop&&(i.$$loop(),a=a||e[t]())}return a}};return a.loop=function(){return n=!0,a},a}};t.exports=c},,function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var r=n(6),i=a(r),o=n(3),u=a(o),l=n(5),s=a(l),c=n(1),f=a(c),d=n(7),h=a(d),p=n(4),v=a(p),y=n(2),x=a(y),g={painter:i.default,imgLoader:v.default,posCompare:x.default,transition:h.default,tick:u.default,utils:f.default,mirror:s.default};window.EasyCanvas=g,t.exports=g}])});